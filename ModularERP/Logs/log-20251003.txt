2025-10-03 11:40:36.924 +03:00 [INF] Starting web host...
2025-10-03 11:40:40.646 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:40:40.711 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 11:40:40.815 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:40:40.821 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 11:40:40.828 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 11:40:40.893 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 11:40:40.910 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:40:40.914 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 11:40:40.927 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 11:40:40.938 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 11:40:40.943 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 11:40:41.120 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 11:40:41.127 +03:00 [INF] Master database initialized successfully
2025-10-03 11:40:43.274 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 11:40:43.562 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 11:40:43.566 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 11:40:43.689 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 11:40:43.692 +03:00 [INF] Hosting environment: Development
2025-10-03 11:40:43.697 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 11:40:44.101 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 11:40:44.286 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 185.4668ms
2025-10-03 11:40:44.294 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 11:40:44.294 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 11:40:44.320 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 26.0542ms
2025-10-03 11:40:44.347 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.7762ms
2025-10-03 11:40:44.420 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 11:40:44.593 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 172.1425ms
2025-10-03 11:43:24.045 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 735
2025-10-03 11:43:24.060 +03:00 [INF] Request started
2025-10-03 11:43:24.066 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:43:24.069 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:43:24.083 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:43:24.089 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:43:24.135 +03:00 [INF] Creating new product with SKU string for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 11:43:24.200 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:43:24.439 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:43:24.515 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 426.0914ms
2025-10-03 11:43:24.522 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:43:24.526 +03:00 [ERR] Unexpected error occurred
AutoMapper.AutoMapperMappingException: Error mapping types.

Mapping types:
CreateProductDto -> Product
ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto -> Product

Type Map configuration:
CreateProductDto -> Product
ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto -> Product

Destination Member:
DiscountType

 ---> System.ArgumentException: Requested value 'string' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at lambda_method155(Closure, Object, Product, ResolutionContext)
   --- End of inner exception stack trace ---
   at lambda_method155(Closure, Object, Product, ResolutionContext)
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 36
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 65
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:43:24.634 +03:00 [INF] Error response sent with status code 500
2025-10-03 11:43:24.641 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 596.5496ms
2025-10-03 11:44:46.365 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 873
2025-10-03 11:44:46.371 +03:00 [INF] Request started
2025-10-03 11:44:46.374 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:44:46.376 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:44:46.377 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:44:46.382 +03:00 [INF] Creating new product with SKU SKU-12345 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 11:44:46.648 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 267.1281ms
2025-10-03 11:44:46.650 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:44:46.652 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_Suppliers_SupplierId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.Suppliers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4f61895d-bfd3-45d3-855f-3106a0ff61b4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 41
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 65
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:44:46.686 +03:00 [INF] Error response sent with status code 500
2025-10-03 11:44:46.688 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 322.5121ms
2025-10-03 11:45:01.085 +03:00 [INF] Starting web host...
2025-10-03 11:45:01.892 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:45:01.932 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 11:45:01.998 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:45:02.004 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 11:45:02.009 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 11:45:02.065 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 11:45:02.080 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:45:02.084 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 11:45:02.090 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 11:45:02.102 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 11:45:02.106 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 11:45:02.258 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 11:45:02.265 +03:00 [INF] Master database initialized successfully
2025-10-03 11:45:03.562 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 11:45:03.663 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 11:45:03.665 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 11:45:03.730 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 11:45:03.732 +03:00 [INF] Hosting environment: Development
2025-10-03 11:45:03.734 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 11:45:04.185 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 11:45:04.302 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 117.7372ms
2025-10-03 11:45:04.314 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 11:45:04.314 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 11:45:04.325 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.8265ms
2025-10-03 11:45:04.346 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.2121ms
2025-10-03 11:45:04.396 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 11:45:04.505 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 109.084ms
2025-10-03 11:45:06.841 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 873
2025-10-03 11:45:06.857 +03:00 [INF] Request started
2025-10-03 11:45:06.862 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:45:06.865 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:45:06.885 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:45:06.892 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:45:06.933 +03:00 [INF] Creating new product with SKU SKU-12345 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 11:45:06.989 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:45:07.234 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:45:07.468 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 576.5562ms
2025-10-03 11:45:07.471 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:45:07.474 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_Suppliers_SupplierId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.Suppliers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a7b816e1-7c0d-482c-8a20-543d7f61cce3
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 41
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 65
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:45:07.540 +03:00 [INF] Error response sent with status code 500
2025-10-03 11:45:07.546 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 705.6032ms
2025-10-03 11:48:46.621 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 873
2025-10-03 11:48:46.628 +03:00 [INF] Request started
2025-10-03 11:48:46.631 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:48:46.633 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:48:46.636 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:48:46.640 +03:00 [INF] Creating new product with SKU SKU-12345 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 11:48:46.783 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Guid, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-03 11:48:46.790 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 151.8766ms
2025-10-03 11:48:46.794 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 11:48:46.796 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 11:48:46.798 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 176.5391ms
2025-10-03 11:49:03.320 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 11:49:03.325 +03:00 [INF] Request started
2025-10-03 11:49:03.327 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:49:03.329 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:49:03.338 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:49:03.347 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 11:49:03.458 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 11:49:03.466 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 123.631ms
2025-10-03 11:49:03.469 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:49:03.472 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 11:49:03.473 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 153.4014ms
2025-10-03 11:49:54.640 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 11:49:54.645 +03:00 [INF] Request started
2025-10-03 11:49:54.649 +03:00 [INF] Request completed successfully with status code 400
2025-10-03 11:49:54.652 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 400 null application/json 11.5875ms
2025-10-03 11:50:08.565 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 11:50:08.569 +03:00 [INF] Request started
2025-10-03 11:50:08.570 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:50:08.572 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:50:08.577 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:50:08.583 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 11:50:08.611 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 29.2406ms
2025-10-03 11:50:08.614 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:50:08.616 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 40
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:50:08.637 +03:00 [INF] Error response sent with status code 404
2025-10-03 11:50:08.639 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 73.2927ms
2025-10-03 11:50:33.143 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 11:50:33.147 +03:00 [INF] Request started
2025-10-03 11:50:33.149 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:50:33.150 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:50:33.152 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:50:33.157 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 11:50:33.160 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 3.3072ms
2025-10-03 11:50:33.162 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:50:33.166 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 40
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:50:33.184 +03:00 [INF] Error response sent with status code 404
2025-10-03 11:50:33.188 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 44.5369ms
2025-10-03 11:51:42.078 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 11:51:42.081 +03:00 [INF] Request started
2025-10-03 11:51:42.082 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:51:42.084 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:51:42.086 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:51:42.091 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 11:51:42.101 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 11:51:42.103 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 12.6945ms
2025-10-03 11:51:42.105 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:51:42.109 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 11:51:42.112 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 34.0524ms
2025-10-03 11:51:49.900 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 11:51:49.903 +03:00 [INF] Request started
2025-10-03 11:51:49.905 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 11:51:49.907 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:51:49.911 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:51:49.914 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 11:51:49.920 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 6.5486ms
2025-10-03 11:51:49.924 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:51:49.926 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 40
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:51:49.944 +03:00 [INF] Error response sent with status code 404
2025-10-03 11:51:49.945 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 45.4678ms
2025-10-03 11:56:52.376 +03:00 [INF] Starting web host...
2025-10-03 11:56:53.207 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:56:53.246 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 11:56:53.312 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:56:53.317 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 11:56:53.322 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 11:56:53.390 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 11:56:53.404 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:56:53.408 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 11:56:53.414 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 11:56:53.425 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 11:56:53.430 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 11:56:53.585 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 11:56:53.592 +03:00 [INF] Master database initialized successfully
2025-10-03 11:56:54.940 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 11:56:55.046 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 11:56:55.047 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 11:56:55.110 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 11:56:55.111 +03:00 [INF] Hosting environment: Development
2025-10-03 11:56:55.113 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 11:56:55.440 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 11:56:55.568 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 132.382ms
2025-10-03 11:56:55.715 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 11:56:55.715 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 11:56:55.721 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.4757ms
2025-10-03 11:56:55.742 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.1024ms
2025-10-03 11:56:55.813 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 11:56:55.900 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 87.4029ms
2025-10-03 11:56:59.928 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 11:56:59.949 +03:00 [INF] Request started
2025-10-03 11:56:59.955 +03:00 [INF] Processing request for tenant: 82b0fb02-1282-483c-ae26-c8466423707e
2025-10-03 11:56:59.958 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:56:59.977 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:56:59.982 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:57:00.010 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 11:57:00.076 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:57:00.094 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:57:00.361 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 11:57:00.463 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 11:57:00.487 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 504.8879ms
2025-10-03 11:57:00.491 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 11:57:00.493 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 11:57:00.500 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 571.2652ms
2025-10-03 11:57:37.083 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 11:57:37.089 +03:00 [INF] Request started
2025-10-03 11:57:37.092 +03:00 [INF] Processing request for tenant: 82b0fb02-1282-483c-ae26-c8466423707e
2025-10-03 11:57:37.093 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:57:37.098 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 11:57:37.102 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 11:57:37.150 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:57:37.156 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 11:57:37.175 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 74.2702ms
2025-10-03 11:57:37.178 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 11:57:37.181 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 40
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 11:57:37.212 +03:00 [INF] Error response sent with status code 404
2025-10-03 11:57:37.215 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 131.9434ms
2025-10-03 11:59:55.093 +03:00 [INF] Starting web host...
2025-10-03 11:59:56.083 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:59:56.133 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 11:59:56.234 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:59:56.239 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 11:59:56.245 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 11:59:56.311 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 11:59:56.333 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 11:59:56.337 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 11:59:56.346 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 11:59:56.358 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 11:59:56.363 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 11:59:56.554 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 11:59:56.560 +03:00 [INF] Master database initialized successfully
2025-10-03 11:59:58.050 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 11:59:58.168 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 11:59:58.169 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 11:59:58.239 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 11:59:58.241 +03:00 [INF] Hosting environment: Development
2025-10-03 11:59:58.243 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 11:59:58.428 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 11:59:58.548 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 120.7611ms
2025-10-03 11:59:58.623 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 11:59:58.623 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 11:59:58.632 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.852ms
2025-10-03 11:59:58.654 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.077ms
2025-10-03 11:59:58.691 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 11:59:58.823 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 131.8327ms
2025-10-03 12:00:36.835 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 12:00:36.853 +03:00 [INF] Request started
2025-10-03 12:00:36.858 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:00:36.860 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:00:36.881 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:00:36.889 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:00:36.910 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 12:00:37.045 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 12:00:37.527 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:00:37.614 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 12:00:37.638 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 749.9262ms
2025-10-03 12:00:37.641 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:00:37.643 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 12:00:37.648 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 812.5122ms
2025-10-03 12:00:42.676 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 12:00:42.684 +03:00 [INF] Request started
2025-10-03 12:00:42.686 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:00:42.688 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 12:00:42.693 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:00:42.700 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 12:00:42.721 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 25.0514ms
2025-10-03 12:00:42.724 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 12:00:42.726 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 40
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:00:42.777 +03:00 [INF] Error response sent with status code 404
2025-10-03 12:00:42.779 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 102.9007ms
2025-10-03 12:00:46.433 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 12:00:46.438 +03:00 [INF] Request started
2025-10-03 12:00:46.439 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:00:46.440 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:00:46.441 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:00:46.444 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 12:00:46.457 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 12:00:46.460 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 16.4379ms
2025-10-03 12:00:46.462 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:00:46.463 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 12:00:46.465 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 31.5682ms
2025-10-03 12:06:03.056 +03:00 [INF] Starting web host...
2025-10-03 12:06:03.959 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:06:03.998 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 12:06:04.092 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:06:04.100 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 12:06:04.106 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 12:06:04.170 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 12:06:04.189 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:06:04.193 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 12:06:04.199 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 12:06:04.209 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 12:06:04.214 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 12:06:04.372 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 12:06:04.379 +03:00 [INF] Master database initialized successfully
2025-10-03 12:06:05.917 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 12:06:06.026 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 12:06:06.028 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 12:06:06.090 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 12:06:06.092 +03:00 [INF] Hosting environment: Development
2025-10-03 12:06:06.094 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 12:06:06.405 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 12:06:06.535 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 131.4884ms
2025-10-03 12:06:06.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 12:06:06.703 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 12:06:06.712 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.8049ms
2025-10-03 12:06:06.725 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.3238ms
2025-10-03 12:06:06.775 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 12:06:06.884 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 109.0786ms
2025-10-03 12:06:18.746 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 12:06:18.762 +03:00 [INF] Request started
2025-10-03 12:06:18.767 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:06:18.770 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:06:18.806 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:06:18.812 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:06:18.830 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 12:06:18.888 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 12:06:19.182 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:06:19.341 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 12:06:19.365 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 552.5549ms
2025-10-03 12:06:19.368 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 12:06:19.371 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 12:06:19.376 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 629.714ms
2025-10-03 12:06:24.793 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - null null
2025-10-03 12:06:24.798 +03:00 [INF] Request started
2025-10-03 12:06:24.803 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:06:24.804 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 12:06:24.812 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:06:24.819 +03:00 [INF] Getting product details for ID "78d414f7-2297-4bad-b75b-a68bfcedff1b"
2025-10-03 12:06:24.919 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 101.2388ms
2025-10-03 12:06:24.922 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 12:06:24.924 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 54
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 224
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:06:24.965 +03:00 [INF] Error response sent with status code 404
2025-10-03 12:06:24.968 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/{78d414f7-2297-4bad-b75b-a68bfcedff1b} - 404 null application/json; charset=utf-8 175.0845ms
2025-10-03 12:32:24.133 +03:00 [INF] Starting web host...
2025-10-03 12:32:25.713 +03:00 [FTL] Host terminated unexpectedly
System.AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.Products.Commends.Commends_Product.CreateProductCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductDetailsDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.Products.Models.ProductTaxProfile]' while attempting to activate 'ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler'.)
 ---> System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.Products.Commends.Commends_Product.CreateProductCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductDetailsDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.Products.Models.ProductTaxProfile]' while attempting to activate 'ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.Products.Models.ProductTaxProfile]' while attempting to activate 'ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services, ServiceProviderOptions options)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 151
2025-10-03 12:33:26.689 +03:00 [INF] Starting web host...
2025-10-03 12:33:28.315 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:33:28.358 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 12:33:28.487 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:33:28.493 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 12:33:28.498 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 12:33:28.562 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 12:33:28.578 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:33:28.585 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 12:33:28.592 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 12:33:28.605 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 12:33:28.609 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 12:33:28.764 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 12:33:28.772 +03:00 [INF] Master database initialized successfully
2025-10-03 12:33:30.483 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 12:33:30.642 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 12:33:30.644 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 12:33:30.709 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 12:33:30.711 +03:00 [INF] Hosting environment: Development
2025-10-03 12:33:30.713 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 12:33:31.170 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 12:33:31.294 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 124.4714ms
2025-10-03 12:33:31.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 12:33:31.298 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 12:33:31.306 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.7945ms
2025-10-03 12:33:31.329 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.6617ms
2025-10-03 12:33:31.483 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 12:33:31.608 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 124.7501ms
2025-10-03 12:33:43.982 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 869
2025-10-03 12:33:44.007 +03:00 [INF] Request started
2025-10-03 12:33:44.013 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:33:44.016 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:33:44.040 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:33:44.047 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:33:44.106 +03:00 [INF] Creating new product with SKU SKU-12345 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 12:33:44.161 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 12:33:44.523 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:33:44.593 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 545.5512ms
2025-10-03 12:33:44.596 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:33:44.598 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"SKU":["SKU already exists for this company"],"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.ValidateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 205
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:33:44.672 +03:00 [INF] Error response sent with status code 400
2025-10-03 12:33:44.680 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 400 null application/json; charset=utf-8 698.7065ms
2025-10-03 12:34:01.067 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 12:34:01.073 +03:00 [INF] Request started
2025-10-03 12:34:01.075 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:34:01.077 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:34:01.078 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:34:01.082 +03:00 [INF] Creating new product with SKU SKU-100 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 12:34:01.099 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 18.0321ms
2025-10-03 12:34:01.102 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:34:01.105 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.ValidateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 205
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:34:01.129 +03:00 [INF] Error response sent with status code 400
2025-10-03 12:34:01.131 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 400 null application/json; charset=utf-8 64.458ms
2025-10-03 12:34:20.437 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 866
2025-10-03 12:34:20.447 +03:00 [INF] Request started
2025-10-03 12:34:20.449 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:34:20.450 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:34:20.452 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:34:20.457 +03:00 [INF] Creating new product with SKU SKU-100 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 12:34:20.765 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 308.5835ms
2025-10-03 12:34:20.767 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:34:20.769 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ItemGroupItems_ItemGroups_GroupId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.ItemGroups", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c43182ca-4f7a-44d3-83e5-18ed0c038cdf
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 94
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:34:20.823 +03:00 [INF] Error response sent with status code 500
2025-10-03 12:34:20.826 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 389.4391ms
2025-10-03 12:36:29.749 +03:00 [INF] Starting web host...
2025-10-03 12:36:30.594 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:36:30.639 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 12:36:30.729 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:36:30.736 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 12:36:30.743 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 12:36:30.807 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 12:36:30.823 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 12:36:30.828 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 12:36:30.836 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 12:36:30.847 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 12:36:30.851 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 12:36:31.016 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 12:36:31.025 +03:00 [INF] Master database initialized successfully
2025-10-03 12:36:32.319 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 12:36:32.416 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 12:36:32.419 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 12:36:32.482 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 12:36:32.485 +03:00 [INF] Hosting environment: Development
2025-10-03 12:36:32.486 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 12:36:32.679 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 12:36:32.797 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 118.6205ms
2025-10-03 12:36:32.863 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 12:36:32.863 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 12:36:32.871 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.3663ms
2025-10-03 12:36:32.892 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.736ms
2025-10-03 12:36:32.926 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 12:36:33.015 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 88.5661ms
2025-10-03 12:36:46.077 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 866
2025-10-03 12:36:46.096 +03:00 [INF] Request started
2025-10-03 12:36:46.104 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:36:46.140 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:36:46.169 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:36:46.192 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:36:46.302 +03:00 [INF] Creating new product with SKU SKU-100 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 12:36:46.391 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 12:36:46.733 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 12:36:46.783 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 592.727ms
2025-10-03 12:36:46.787 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:36:46.789 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"SKU":["SKU already exists for this company"],"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.ValidateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 206
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 12:36:46.856 +03:00 [INF] Error response sent with status code 400
2025-10-03 12:36:46.863 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 400 null application/json; charset=utf-8 786.0487ms
2025-10-03 12:37:03.369 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 865
2025-10-03 12:37:03.375 +03:00 [INF] Request started
2025-10-03 12:37:03.379 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 12:37:03.380 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:37:03.382 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 12:37:03.386 +03:00 [INF] Creating new product with SKU SKU-101 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 12:37:03.943 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 12:37:03.974 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 590.3057ms
2025-10-03 12:37:03.979 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 12:37:03.981 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 12:37:03.982 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 613.4294ms
2025-10-03 13:24:19.547 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 866
2025-10-03 13:24:19.553 +03:00 [INF] Request started
2025-10-03 13:24:19.555 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:24:19.556 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:24:19.559 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:24:19.562 +03:00 [INF] Creating new product with SKU SKU-102 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:24:19.599 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 37.6535ms
2025-10-03 13:24:19.602 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:24:19.603 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.ValidateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 206
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:24:19.619 +03:00 [INF] Error response sent with status code 400
2025-10-03 13:24:19.621 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 400 null application/json; charset=utf-8 73.0563ms
2025-10-03 13:24:30.330 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:24:30.334 +03:00 [INF] Request started
2025-10-03 13:24:30.335 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:24:30.336 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:24:30.338 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:24:30.342 +03:00 [INF] Creating new product with SKU SKU-102 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:24:30.403 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 61.6538ms
2025-10-03 13:24:30.406 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:24:30.408 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_ItemGroupItems'. Cannot insert duplicate key in object 'dbo.ItemGroupItems'. The duplicate key value is (f86965cd-0f27-42ae-9800-35f8c9007465).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:650dae5b-6c83-499d-be18-b8421467fd83
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 95
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:24:30.443 +03:00 [INF] Error response sent with status code 500
2025-10-03 13:24:30.445 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 115.0189ms
2025-10-03 13:24:47.365 +03:00 [INF] Starting web host...
2025-10-03 13:24:50.044 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:24:50.155 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 13:24:50.224 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:24:50.230 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 13:24:50.254 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 13:24:50.313 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 13:24:50.328 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:24:50.332 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 13:24:50.340 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 13:24:50.351 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 13:24:50.358 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 13:24:50.526 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 13:24:50.536 +03:00 [INF] Master database initialized successfully
2025-10-03 13:24:52.065 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 13:24:52.198 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 13:24:52.199 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 13:24:52.264 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 13:24:52.266 +03:00 [INF] Hosting environment: Development
2025-10-03 13:24:52.267 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 13:24:52.820 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 13:24:52.966 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 147.7514ms
2025-10-03 13:24:52.969 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 13:24:52.980 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 13:24:52.983 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 13.9975ms
2025-10-03 13:24:53.018 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.6512ms
2025-10-03 13:24:53.125 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 13:24:53.285 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 160.0611ms
2025-10-03 13:25:01.379 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:25:01.394 +03:00 [INF] Request started
2025-10-03 13:25:01.399 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:25:01.402 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:25:01.416 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:25:01.421 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:25:01.457 +03:00 [INF] Creating new product with SKU SKU-103 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:25:01.518 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:25:01.774 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:25:02.094 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 672.8062ms
2025-10-03 13:25:02.097 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:25:02.099 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_ItemGroupItems'. Cannot insert duplicate key in object 'dbo.ItemGroupItems'. The duplicate key value is (f86965cd-0f27-42ae-9800-35f8c9007465).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:0437b687-bc5d-4580-951d-d3ed180f0433
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 95
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:25:02.159 +03:00 [INF] Error response sent with status code 500
2025-10-03 13:25:02.166 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 500 null application/json; charset=utf-8 786.5689ms
2025-10-03 13:26:41.123 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:26:41.130 +03:00 [INF] Request started
2025-10-03 13:26:41.133 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:26:41.134 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:26:41.135 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:26:41.138 +03:00 [INF] Creating new product with SKU SKU-103 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:26:41.155 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 17.7413ms
2025-10-03 13:26:41.157 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:26:41.160 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"SKU":["SKU already exists for this company"],"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.ValidateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 206
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CreateProductCommandHandler.Handle(CreateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CreateProductCommandHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct(CreateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 66
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:26:41.181 +03:00 [INF] Error response sent with status code 400
2025-10-03 13:26:41.183 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 400 null application/json; charset=utf-8 59.3262ms
2025-10-03 13:26:59.382 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:26:59.386 +03:00 [INF] Request started
2025-10-03 13:26:59.388 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:26:59.389 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:26:59.391 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:26:59.394 +03:00 [INF] Creating new product with SKU SKU-104 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:26:59.576 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:26:59.592 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 198.1738ms
2025-10-03 13:26:59.594 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:26:59.596 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:26:59.597 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 214.9014ms
2025-10-03 13:30:05.063 +03:00 [INF] Starting web host...
2025-10-03 13:30:05.907 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:30:05.975 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 13:30:06.052 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:30:06.060 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 13:30:06.069 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 13:30:06.131 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 13:30:06.147 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:30:06.151 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 13:30:06.158 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 13:30:06.169 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 13:30:06.175 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 13:30:06.355 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 13:30:06.364 +03:00 [INF] Master database initialized successfully
2025-10-03 13:30:07.823 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 13:30:07.930 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 13:30:07.932 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 13:30:08.000 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 13:30:08.002 +03:00 [INF] Hosting environment: Development
2025-10-03 13:30:08.004 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 13:30:08.376 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 13:30:08.510 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 135.4645ms
2025-10-03 13:30:08.513 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 13:30:08.513 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 13:30:08.529 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 16.1999ms
2025-10-03 13:30:08.546 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.5139ms
2025-10-03 13:30:08.578 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 13:30:08.709 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 131.3712ms
2025-10-03 13:30:22.949 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:30:22.965 +03:00 [INF] Request started
2025-10-03 13:30:22.970 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:30:22.974 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:30:22.994 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:30:23.000 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:30:23.040 +03:00 [INF] Creating new product with SKU SKU-106 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:30:23.100 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:30:23.427 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:30:23.945 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:30:23.972 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 971.4704ms
2025-10-03 13:30:23.974 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:30:23.977 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:30:23.981 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 1032.4756ms
2025-10-03 13:30:31.333 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products - null null
2025-10-03 13:30:31.339 +03:00 [INF] Request started
2025-10-03 13:30:31.342 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:30:31.343 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:30:31.348 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:30:31.357 +03:00 [INF] Getting products list for company "00000000-0000-0000-0000-000000000000"
2025-10-03 13:30:31.461 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:30:31.467 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 115.3498ms
2025-10-03 13:30:31.470 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:30:31.471 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:30:31.473 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 139.994ms
2025-10-03 13:30:55.253 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - null null
2025-10-03 13:30:55.259 +03:00 [INF] Request started
2025-10-03 13:30:55.261 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:30:55.262 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:30:55.269 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:30:55.272 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:30:55.288 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 17.2274ms
2025-10-03 13:30:55.293 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:30:55.297 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 50
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:30:55.351 +03:00 [INF] Error response sent with status code 404
2025-10-03 13:30:55.353 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - 404 null application/json; charset=utf-8 100.8241ms
2025-10-03 13:31:44.947 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - null null
2025-10-03 13:31:44.952 +03:00 [INF] Request started
2025-10-03 13:31:44.953 +03:00 [INF] Processing request for tenant: 82b0fb02-1282-483c-ae26-c8466423707e
2025-10-03 13:31:44.954 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:31:44.955 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:31:44.958 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:31:45.014 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.025 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.030 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.034 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.038 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.042 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.046 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:31:45.063 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 105.3034ms
2025-10-03 13:31:45.066 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:31:45.067 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 50
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:31:45.077 +03:00 [INF] Error response sent with status code 404
2025-10-03 13:31:45.079 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - 404 null application/json; charset=utf-8 131.1185ms
2025-10-03 13:31:50.127 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - null null
2025-10-03 13:31:50.131 +03:00 [INF] Request started
2025-10-03 13:31:50.132 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:31:50.133 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:31:50.135 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:31:50.137 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:31:50.149 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 11.656ms
2025-10-03 13:31:50.152 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:31:50.153 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 50
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:31:50.163 +03:00 [INF] Error response sent with status code 404
2025-10-03 13:31:50.165 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - 404 null application/json; charset=utf-8 38.0723ms
2025-10-03 13:32:00.252 +03:00 [INF] Starting web host...
2025-10-03 13:32:01.090 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:32:01.155 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 13:32:01.235 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:32:01.241 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 13:32:01.260 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 13:32:01.317 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 13:32:01.341 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:32:01.346 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 13:32:01.358 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 13:32:01.377 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 13:32:01.386 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 13:32:01.595 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 13:32:01.609 +03:00 [INF] Master database initialized successfully
2025-10-03 13:32:03.137 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 13:32:03.243 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 13:32:03.245 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 13:32:03.315 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 13:32:03.318 +03:00 [INF] Hosting environment: Development
2025-10-03 13:32:03.320 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 13:32:03.345 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 13:32:03.493 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 149.5413ms
2025-10-03 13:32:03.537 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 13:32:03.537 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 13:32:03.546 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.834ms
2025-10-03 13:32:03.568 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.3982ms
2025-10-03 13:32:03.595 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 13:32:03.691 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.6535ms
2025-10-03 13:32:07.003 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - null null
2025-10-03 13:32:07.018 +03:00 [INF] Request started
2025-10-03 13:32:07.024 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:32:07.027 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:32:07.042 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:32:07.047 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:32:07.056 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:32:07.118 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:32:07.398 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:32:07.516 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 468.7534ms
2025-10-03 13:32:07.519 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:32:07.523 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.GetProductDetailsQueryHandler.Handle(GetProductDetailsQuery request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\GetProductDetailsQueryHandler.cs:line 55
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 50
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 13:32:07.564 +03:00 [INF] Error response sent with status code 404
2025-10-03 13:32:07.570 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa - 404 null application/json; charset=utf-8 567.8289ms
2025-10-03 13:34:09.966 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 13:34:09.974 +03:00 [INF] Request started
2025-10-03 13:34:09.978 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:34:09.980 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:34:09.984 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:34:09.990 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:34:10.169 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:34:10.195 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 208.3655ms
2025-10-03 13:34:10.198 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:34:10.199 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:34:10.201 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 234.7203ms
2025-10-03 13:35:36.236 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 13:35:36.242 +03:00 [INF] Request started
2025-10-03 13:35:36.243 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:35:36.244 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:35:36.252 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:35:36.263 +03:00 [INF] Getting products list for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:35:36.380 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:35:36.388 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 131.075ms
2025-10-03 13:35:36.392 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:35:36.394 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:35:36.395 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 159.0728ms
2025-10-03 13:45:10.338 +03:00 [INF] Starting web host...
2025-10-03 13:45:11.207 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:45:11.260 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 13:45:11.332 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:45:11.339 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 13:45:11.356 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 13:45:11.435 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 13:45:11.452 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 13:45:11.456 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 13:45:11.468 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 13:45:11.481 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 13:45:11.489 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 13:45:11.677 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 13:45:11.685 +03:00 [INF] Master database initialized successfully
2025-10-03 13:45:13.320 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 13:45:13.435 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 13:45:13.437 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 13:45:13.501 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 13:45:13.504 +03:00 [INF] Hosting environment: Development
2025-10-03 13:45:13.506 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 13:45:13.772 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 13:45:13.903 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 131.707ms
2025-10-03 13:45:13.905 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 13:45:13.905 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 13:45:13.920 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 15.209ms
2025-10-03 13:45:13.940 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 35.2873ms
2025-10-03 13:45:14.125 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 13:45:14.244 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 119.0659ms
2025-10-03 13:45:45.225 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 13:45:45.246 +03:00 [INF] Request started
2025-10-03 13:45:45.257 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:45:45.260 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:45:45.284 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:45:45.289 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:45:45.304 +03:00 [INF] Getting product details for ID "72f2d590-1162-4350-a519-fc28e61693fa"
2025-10-03 13:45:45.358 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 13:45:45.757 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 13:45:46.019 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:45:46.053 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 763.6365ms
2025-10-03 13:45:46.056 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:45:46.059 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:45:46.066 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/72f2d590-1162-4350-a519-fc28e61693fa?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 840.8145ms
2025-10-03 13:46:08.817 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 13:46:08.823 +03:00 [INF] Request started
2025-10-03 13:46:08.825 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:46:08.827 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:46:08.833 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:46:08.844 +03:00 [INF] Getting products list for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:46:08.959 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:46:08.966 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 128.8862ms
2025-10-03 13:46:08.970 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 13:46:08.972 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:46:08.973 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 156.3213ms
2025-10-03 13:47:51.008 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 13:47:51.013 +03:00 [INF] Request started
2025-10-03 13:47:51.014 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:47:51.015 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:47:51.019 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:47:51.042 +03:00 [INF] Creating new product with SKU SKU-107 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 13:47:51.341 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:47:51.344 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 319.8429ms
2025-10-03 13:47:51.346 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 13:47:51.348 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:47:51.349 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 340.703ms
2025-10-03 13:48:15.956 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products/c1671cee-3175-478c-85ba-d084d556ef0f?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 13:48:15.960 +03:00 [INF] Request started
2025-10-03 13:48:15.961 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 13:48:15.962 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:48:15.964 +03:00 [INF] Route matched with {action = "GetProductById", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProductById(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 13:48:15.970 +03:00 [INF] Getting product details for ID "c1671cee-3175-478c-85ba-d084d556ef0f"
2025-10-03 13:48:15.983 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 13:48:15.987 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP) in 17.7343ms
2025-10-03 13:48:15.989 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProductById (ModularERP)'
2025-10-03 13:48:15.992 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 13:48:15.994 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products/c1671cee-3175-478c-85ba-d084d556ef0f?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 37.3167ms
2025-10-03 18:29:44.844 +03:00 [INF] Starting web host...
2025-10-03 18:29:49.629 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 18:29:49.730 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 18:29:49.844 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 18:29:49.851 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 18:29:49.861 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 18:29:49.942 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 18:29:49.960 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 18:29:49.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 18:29:49.975 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 18:29:49.988 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 18:29:49.996 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 18:29:50.262 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 18:29:50.274 +03:00 [INF] Master database initialized successfully
2025-10-03 18:29:52.517 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 18:29:52.791 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 18:29:52.794 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 18:29:52.912 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 18:29:52.926 +03:00 [INF] Hosting environment: Development
2025-10-03 18:29:52.927 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 18:29:53.003 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 18:29:53.224 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 223.4399ms
2025-10-03 18:29:53.231 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 18:29:53.231 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 18:29:53.244 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 13.2424ms
2025-10-03 18:29:53.283 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.0186ms
2025-10-03 18:29:53.438 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 18:29:53.545 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 106.7929ms
2025-10-03 20:46:42.139 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 20:46:42.194 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 54.4417ms
2025-10-03 20:46:42.199 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 20:46:42.205 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 20:46:42.220 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 20.4823ms
2025-10-03 20:46:42.230 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.4721ms
2025-10-03 20:46:42.381 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 20:46:42.530 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 148.3713ms
2025-10-03 21:07:41.083 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - application/json 890
2025-10-03 21:07:41.106 +03:00 [INF] Request started
2025-10-03 21:07:41.111 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:07:41.115 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:07:41.145 +03:00 [INF] Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateProduct(System.Guid, ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.UpdateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:07:41.152 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:07:41.204 +03:00 [INF] Updating product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:07:41.300 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 21:07:41.654 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:07:41.853 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP) in 700.9749ms
2025-10-03 21:07:41.857 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:07:41.859 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"SKU":["SKU already exists for this company"],"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.UpdateProductCommandHandler.ValidateProductUpdate(UpdateProductDto dto, Guid productId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\UpdateProductCommandHandler.cs:line 261
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.UpdateProductCommandHandler.Handle(UpdateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\UpdateProductCommandHandler.cs:line 63
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct(Guid id, UpdateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 21:07:41.950 +03:00 [INF] Error response sent with status code 400
2025-10-03 21:07:41.956 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - 400 null application/json; charset=utf-8 872.6224ms
2025-10-03 21:08:16.217 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - application/json 838
2025-10-03 21:08:16.223 +03:00 [INF] Request started
2025-10-03 21:08:16.226 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:08:16.227 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:08:16.228 +03:00 [INF] Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateProduct(System.Guid, ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.UpdateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:08:16.242 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-03 21:08:16.259 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP) in 28.1794ms
2025-10-03 21:08:16.262 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:08:16.263 +03:00 [INF] Request completed successfully with status code 400
2025-10-03 21:08:16.265 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - 400 null application/problem+json; charset=utf-8 47.961ms
2025-10-03 21:09:27.251 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - application/json 890
2025-10-03 21:09:27.257 +03:00 [INF] Request started
2025-10-03 21:09:27.258 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:09:27.259 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:27.260 +03:00 [INF] Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateProduct(System.Guid, ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.UpdateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:09:27.264 +03:00 [INF] Updating product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:09:27.290 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP) in 26.3829ms
2025-10-03 21:09:27.292 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:27.293 +03:00 [WRN] Validation exception occurred: Product validation failed. Validation errors: {"Barcode":["Barcode already exists for this company"]}
ModularERP.Common.Exceptions.ValidationException: Product validation failed
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.UpdateProductCommandHandler.ValidateProductUpdate(UpdateProductDto dto, Guid productId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\UpdateProductCommandHandler.cs:line 261
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.UpdateProductCommandHandler.Handle(UpdateProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\UpdateProductCommandHandler.cs:line 63
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct(Guid id, UpdateProductDto dto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 21:09:27.305 +03:00 [INF] Error response sent with status code 400
2025-10-03 21:09:27.307 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - 400 null application/json; charset=utf-8 55.6093ms
2025-10-03 21:09:34.304 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - application/json 890
2025-10-03 21:09:34.307 +03:00 [INF] Request started
2025-10-03 21:09:34.308 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:09:34.309 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:34.311 +03:00 [INF] Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateProduct(System.Guid, ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.UpdateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:09:34.314 +03:00 [INF] Updating product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:09:34.808 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:09:34.825 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP) in 511.4754ms
2025-10-03 21:09:34.829 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:34.831 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:09:34.833 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - 200 null application/json; charset=utf-8 528.6272ms
2025-10-03 21:09:59.109 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - application/json 897
2025-10-03 21:09:59.113 +03:00 [INF] Request started
2025-10-03 21:09:59.114 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:09:59.115 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:59.118 +03:00 [INF] Route matched with {action = "UpdateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateProduct(System.Guid, ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.UpdateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:09:59.121 +03:00 [INF] Updating product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:09:59.197 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:09:59.202 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP) in 81.4192ms
2025-10-03 21:09:59.203 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.UpdateProduct (ModularERP)'
2025-10-03 21:09:59.205 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:09:59.206 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa} - 200 null application/json; charset=utf-8 97.1523ms
2025-10-03 21:12:23.127 +03:00 [INF] Starting web host...
2025-10-03 21:12:23.985 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:12:24.080 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 21:12:24.154 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:12:24.160 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 21:12:24.176 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 21:12:24.230 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 21:12:24.245 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:12:24.250 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 21:12:24.257 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 21:12:24.268 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 21:12:24.275 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 21:12:24.456 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 21:12:24.462 +03:00 [INF] Master database initialized successfully
2025-10-03 21:12:25.772 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 21:12:25.889 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 21:12:25.891 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 21:12:25.955 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 21:12:25.957 +03:00 [INF] Hosting environment: Development
2025-10-03 21:12:25.958 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 21:12:26.210 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 21:12:26.326 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 116.9971ms
2025-10-03 21:12:26.330 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 21:12:26.330 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 21:12:26.338 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.9124ms
2025-10-03 21:12:26.358 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.4702ms
2025-10-03 21:12:26.506 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 21:12:26.597 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 91.4424ms
2025-10-03 21:19:50.561 +03:00 [INF] Starting web host...
2025-10-03 21:20:09.530 +03:00 [ERR] Failed to initialize master database
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)
 ---> System.ComponentModel.Win32Exception (2): The system cannot find the file specified.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabaseCreator.EnsureCreatedAsync(CancellationToken cancellationToken)
   at ModularERP.Program.EnsureMasterDatabaseAsync(IServiceProvider services) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 254
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:2,State:0,Class:20
2025-10-03 21:20:09.604 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)
 ---> System.ComponentModel.Win32Exception (2): The system cannot find the file specified.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabaseCreator.EnsureCreatedAsync(CancellationToken cancellationToken)
   at ModularERP.Program.EnsureMasterDatabaseAsync(IServiceProvider services) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 254
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 157
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:2,State:0,Class:20
2025-10-03 21:21:25.666 +03:00 [INF] Starting web host...
2025-10-03 21:21:26.489 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:21:26.534 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 21:21:26.615 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:21:26.620 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 21:21:26.627 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 21:21:26.685 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 21:21:26.701 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:21:26.705 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 21:21:26.711 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 21:21:26.723 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 21:21:26.727 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 21:21:26.905 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 21:21:26.911 +03:00 [INF] Master database initialized successfully
2025-10-03 21:21:28.415 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 21:21:28.649 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 21:21:28.651 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 21:21:28.740 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 21:21:28.741 +03:00 [INF] Hosting environment: Development
2025-10-03 21:21:28.742 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 21:21:29.521 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 21:21:29.758 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 239.5556ms
2025-10-03 21:21:29.761 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 21:21:29.761 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 21:21:29.781 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 18.8175ms
2025-10-03 21:21:29.821 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 59.1226ms
2025-10-03 21:21:29.975 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 21:21:30.097 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 122.1208ms
2025-10-03 21:27:37.138 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone??companyId=82b0fb02-1282-483c-ae26-c8466423707e - null 0
2025-10-03 21:27:37.158 +03:00 [INF] Request started
2025-10-03 21:27:37.162 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:27:37.165 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:27:37.198 +03:00 [INF] Route matched with {action = "CloneProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CloneProduct(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:27:37.204 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:27:37.222 +03:00 [INF] Cloning product "72f2d590-1162-4350-a519-fc28e61693fa" for company "00000000-0000-0000-0000-000000000000"
2025-10-03 21:27:37.277 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 21:27:37.668 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:27:37.793 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP) in 590.4068ms
2025-10-03 21:27:37.796 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:27:37.800 +03:00 [ERR] Application exception occurred: Product not found or does not belong to this company
ModularERP.Common.Exceptions.NotFoundException: Product not found or does not belong to this company
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CloneProductCommandHandler.Handle(CloneProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CloneProductCommandHandler.cs:line 56
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 142
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 21:27:37.839 +03:00 [INF] Error response sent with status code 404
2025-10-03 21:27:37.844 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone??companyId=82b0fb02-1282-483c-ae26-c8466423707e - 404 null application/json; charset=utf-8 705.929ms
2025-10-03 21:29:44.058 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null 0
2025-10-03 21:29:44.065 +03:00 [INF] Request started
2025-10-03 21:29:44.069 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:29:44.070 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:29:44.073 +03:00 [INF] Route matched with {action = "CloneProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CloneProduct(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:29:44.078 +03:00 [INF] Cloning product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:29:44.546 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:29:44.586 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP) in 510.0627ms
2025-10-03 21:29:44.592 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:29:44.593 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:29:44.595 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 536.3608ms
2025-10-03 21:40:24.593 +03:00 [INF] Starting web host...
2025-10-03 21:40:27.511 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:40:27.547 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 21:40:27.623 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:40:27.630 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 21:40:27.634 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 21:40:27.687 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 21:40:27.703 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:40:27.708 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 21:40:27.723 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 21:40:27.735 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 21:40:27.740 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 21:40:27.898 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 21:40:27.906 +03:00 [INF] Master database initialized successfully
2025-10-03 21:40:29.501 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 21:40:29.723 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 21:40:29.725 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 21:40:29.789 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 21:40:29.790 +03:00 [INF] Hosting environment: Development
2025-10-03 21:40:29.792 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 21:40:30.214 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 21:40:30.335 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 121.8191ms
2025-10-03 21:40:30.341 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 21:40:30.341 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 21:40:30.355 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 13.9778ms
2025-10-03 21:40:30.370 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.1141ms
2025-10-03 21:40:30.523 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 21:40:30.622 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 98.987ms
2025-10-03 21:40:32.325 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null 0
2025-10-03 21:40:32.340 +03:00 [INF] Request started
2025-10-03 21:40:32.345 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:40:32.349 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:40:32.368 +03:00 [INF] Route matched with {action = "CloneProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CloneProduct(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:40:32.374 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:40:32.389 +03:00 [INF] Cloning product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:40:32.441 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 21:40:32.743 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:40:32.971 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP) in 597.7181ms
2025-10-03 21:40:32.974 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:40:32.977 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Products' with unique index 'IX_Product_Tenant_Barcode'. The duplicate key value is (8bed874f-cf2a-4ffa-a188-4cfef779774a, 1234567890108).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:24719982-106d-4b0e-9191-3465764d6190
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Inventory.Features.Products.Handlers.Handlers_Product.CloneProductCommandHandler.Handle(CloneProductCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Handlers\Handlers_Product\CloneProductCommandHandler.cs:line 92
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct(Guid id, Guid companyId) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\Products\Controllers\ProductsController.cs:line 142
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-03 21:40:33.081 +03:00 [INF] Error response sent with status code 500
2025-10-03 21:40:33.088 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 500 null application/json; charset=utf-8 762.9309ms
2025-10-03 21:42:59.696 +03:00 [INF] Starting web host...
2025-10-03 21:43:00.531 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:43:00.580 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 21:43:00.670 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:43:00.676 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 21:43:00.680 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 21:43:00.746 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 21:43:00.764 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:43:00.768 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 21:43:00.774 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 21:43:00.790 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 21:43:00.796 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 21:43:00.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 21:43:00.972 +03:00 [INF] Master database initialized successfully
2025-10-03 21:43:02.254 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 21:43:02.351 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 21:43:02.353 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 21:43:02.471 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 21:43:02.473 +03:00 [INF] Hosting environment: Development
2025-10-03 21:43:02.476 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 21:43:02.634 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 21:43:02.750 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 117.3411ms
2025-10-03 21:43:02.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 21:43:02.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 21:43:02.762 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.3568ms
2025-10-03 21:43:02.783 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.6338ms
2025-10-03 21:43:02.939 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 21:43:03.009 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 70.5129ms
2025-10-03 21:47:44.150 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 21:47:44.175 +03:00 [INF] Request started
2025-10-03 21:47:44.181 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:47:44.184 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:47:44.206 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:47:44.213 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:47:44.264 +03:00 [INF] Creating new product with SKU SKU-109 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:47:44.318 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 21:47:44.650 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:47:45.173 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:47:45.199 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 985.104ms
2025-10-03 21:47:45.202 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:47:45.205 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:47:45.210 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 1059.7549ms
2025-10-03 21:48:17.627 +03:00 [INF] Starting web host...
2025-10-03 21:48:18.432 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:48:18.466 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-03 21:48:18.533 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:48:18.539 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 21:48:18.543 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-03 21:48:18.594 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-03 21:48:18.611 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-03 21:48:18.614 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-03 21:48:18.621 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-03 21:48:18.636 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 21:48:18.640 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-03 21:48:18.788 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-03 21:48:18.795 +03:00 [INF] Master database initialized successfully
2025-10-03 21:48:20.086 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 21:48:20.186 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-03 21:48:20.188 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-03 21:48:20.250 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 21:48:20.252 +03:00 [INF] Hosting environment: Development
2025-10-03 21:48:20.253 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-03 21:48:20.565 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-03 21:48:20.678 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 114.3789ms
2025-10-03 21:48:20.811 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-03 21:48:20.811 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-03 21:48:20.821 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.4851ms
2025-10-03 21:48:20.834 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 23.3036ms
2025-10-03 21:48:20.895 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-03 21:48:20.965 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 69.9705ms
2025-10-03 21:48:39.583 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 21:48:39.604 +03:00 [INF] Request started
2025-10-03 21:48:39.608 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:48:39.611 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:48:39.631 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:48:39.639 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:48:39.688 +03:00 [INF] Creating new product with SKU SKU-110 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:48:39.743 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-03 21:48:40.072 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-03 21:48:40.589 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:48:40.616 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 978.1869ms
2025-10-03 21:48:40.619 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:48:40.622 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:48:40.627 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 1043.4946ms
2025-10-03 21:49:02.970 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products - application/json 867
2025-10-03 21:49:02.976 +03:00 [INF] Request started
2025-10-03 21:49:02.980 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:49:02.981 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:49:02.983 +03:00 [INF] Route matched with {action = "CreateProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProduct(ModularERP.Modules.Inventory.Features.Products.DTO.CreateProductDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:49:02.987 +03:00 [INF] Creating new product with SKU SKU-111 for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:49:03.025 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:49:03.028 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP) in 41.531ms
2025-10-03 21:49:03.030 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CreateProduct (ModularERP)'
2025-10-03 21:49:03.031 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:49:03.033 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products - 200 null application/json; charset=utf-8 63.1621ms
2025-10-03 21:50:19.459 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null null
2025-10-03 21:50:19.471 +03:00 [INF] Request started
2025-10-03 21:50:19.472 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:50:19.474 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 21:50:19.480 +03:00 [INF] Route matched with {action = "GetProducts", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetProducts(ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.ProductListRequestDto) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:50:19.491 +03:00 [INF] Getting products list for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:50:19.611 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.DTO_Product.PaginatedProductListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:50:19.619 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP) in 134.4227ms
2025-10-03 21:50:19.622 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.GetProducts (ModularERP)'
2025-10-03 21:50:19.625 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:50:19.626 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Products?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 167.037ms
2025-10-03 21:50:37.490 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - null 0
2025-10-03 21:50:37.495 +03:00 [INF] Request started
2025-10-03 21:50:37.497 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-03 21:50:37.498 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:50:37.503 +03:00 [INF] Route matched with {action = "CloneProduct", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CloneProduct(System.Guid, System.Guid) on controller ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController (ModularERP).
2025-10-03 21:50:37.508 +03:00 [INF] Cloning product "72f2d590-1162-4350-a519-fc28e61693fa" for company "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-03 21:50:37.572 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.Products.DTO.ProductDetailsDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 21:50:37.575 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP) in 68.9013ms
2025-10-03 21:50:37.577 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.Products.Controllers.ProductsController.CloneProduct (ModularERP)'
2025-10-03 21:50:37.579 +03:00 [INF] Request completed successfully with status code 200
2025-10-03 21:50:37.580 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Products/{72f2d590-1162-4350-a519-fc28e61693fa}/clone?companyId=82b0fb02-1282-483c-ae26-c8466423707e - 200 null application/json; charset=utf-8 89.7097ms
