2025-10-02 11:36:31.191 +03:00 [INF] Starting web host...
2025-10-02 11:36:33.141 +03:00 [FTL] Host terminated unexpectedly
System.AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.AddTaxComponentToProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.AddTaxComponentToProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.AddTaxComponentToProfileHandler'.) (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler'.) (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.DeleteTaxComponentCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxComponentHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxComponentHandler'.) (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.DeleteTaxProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxProfileHandler'.) (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Qeuries.GetTaxProfileByIdQuery,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDetailDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.GetTaxProfileByIdHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.GetTaxProfileByIdHandler'.) (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.RemoveTaxComponentFromProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.RemoveTaxComponentFromProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.RemoveTaxComponentFromProfileHandler'.)
 ---> System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.AddTaxComponentToProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.AddTaxComponentToProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.AddTaxComponentToProfileHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.AddTaxComponentToProfileHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services, ServiceProviderOptions options)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 166
 ---> (Inner Exception #1) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

 ---> (Inner Exception #2) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.DeleteTaxComponentCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxComponentHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxComponentHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxComponentHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

 ---> (Inner Exception #3) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.DeleteTaxProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxProfileHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.DeleteTaxProfileHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

 ---> (Inner Exception #4) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Qeuries.GetTaxProfileByIdQuery,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDetailDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.GetTaxProfileByIdHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.GetTaxProfileByIdHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.GetTaxProfileByIdHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

 ---> (Inner Exception #5) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.TaxManagement.Commends.RemoveTaxComponentFromProfileCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.RemoveTaxComponentFromProfileHandler': Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.RemoveTaxComponentFromProfileHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'ModularERP.Shared.Interfaces.IJoinTableRepository`1[ModularERP.Modules.Inventory.Features.TaxManagement.Models.TaxProfileComponent]' while attempting to activate 'ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.RemoveTaxComponentFromProfileHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

2025-10-02 11:37:34.871 +03:00 [INF] Starting web host...
2025-10-02 11:37:37.460 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:37:37.560 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 11:37:37.644 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:37:37.650 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 11:37:37.661 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 11:37:37.757 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 11:37:37.772 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:37:37.776 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 11:37:37.786 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 11:37:37.798 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 11:37:37.805 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 11:37:38.054 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 11:37:38.066 +03:00 [INF] Master database initialized successfully
2025-10-02 11:37:40.297 +03:00 [FTL] Host terminated unexpectedly
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'FinanceDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 181
2025-10-02 11:39:39.877 +03:00 [INF] Starting web host...
2025-10-02 11:39:40.140 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 170
2025-10-02 11:40:16.923 +03:00 [INF] Starting web host...
2025-10-02 11:40:17.156 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 170
2025-10-02 11:40:23.444 +03:00 [INF] Starting web host...
2025-10-02 11:40:24.252 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:40:24.316 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 11:40:24.382 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:40:24.389 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 11:40:24.403 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 11:40:24.460 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 11:40:24.474 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:40:24.478 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 11:40:24.485 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 11:40:24.495 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 11:40:24.499 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 11:40:24.658 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 11:40:24.665 +03:00 [INF] Master database initialized successfully
2025-10-02 11:40:26.210 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 11:40:26.413 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 11:40:26.415 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 11:40:26.515 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 11:40:26.518 +03:00 [INF] Hosting environment: Development
2025-10-02 11:40:26.519 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 11:40:27.639 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 11:40:28.116 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 483.3312ms
2025-10-02 11:40:28.147 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:40:28.150 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 11:40:28.174 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 27.0578ms
2025-10-02 11:40:28.283 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 132.2199ms
2025-10-02 11:40:28.361 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 11:40:28.587 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 226.7374ms
2025-10-02 11:42:30.673 +03:00 [INF] Starting web host...
2025-10-02 11:42:31.477 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:42:31.545 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 11:42:31.613 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:42:31.618 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 11:42:31.626 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 11:42:31.680 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 11:42:31.695 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:42:31.699 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 11:42:31.707 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 11:42:31.718 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 11:42:31.726 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 11:42:31.883 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 11:42:31.890 +03:00 [INF] Master database initialized successfully
2025-10-02 11:42:33.264 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 11:42:33.387 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 11:42:33.389 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 11:42:33.455 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 11:42:33.458 +03:00 [INF] Hosting environment: Development
2025-10-02 11:42:33.459 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 11:42:33.600 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 11:42:33.724 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 125.3675ms
2025-10-02 11:42:33.737 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:42:33.737 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 11:42:33.744 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.3904ms
2025-10-02 11:42:33.768 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.2485ms
2025-10-02 11:42:33.813 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 11:42:33.886 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 72.9338ms
2025-10-02 11:45:19.445 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168//api/TaxProfile - null null
2025-10-02 11:45:19.463 +03:00 [INF] Request started
2025-10-02 11:45:19.468 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:45:19.470 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 11:45:19.478 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168//api/TaxProfile - 404 0 null 32.4283ms
2025-10-02 11:45:19.485 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7168//api/TaxProfile, Response status code: 404
2025-10-02 11:48:08.501 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/TaxComponent - null null
2025-10-02 11:48:08.516 +03:00 [INF] Request started
2025-10-02 11:48:08.519 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:48:08.521 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP)'
2025-10-02 11:48:08.544 +03:00 [INF] Route matched with {action = "GetAll", controller = "TaxComponent"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto]]]] GetAll() on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController (ModularERP).
2025-10-02 11:48:08.550 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 11:48:08.646 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 11:48:08.994 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 11:48:09.098 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:48:09.124 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP) in 574.227ms
2025-10-02 11:48:09.128 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP)'
2025-10-02 11:48:09.130 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 11:48:09.133 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/TaxComponent - 200 null application/json; charset=utf-8 632.1888ms
2025-10-02 11:49:13.158 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxComponent - application/json 133
2025-10-02 11:49:13.171 +03:00 [INF] Request started
2025-10-02 11:49:13.174 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:49:13.175 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.Create (ModularERP)'
2025-10-02 11:49:13.183 +03:00 [INF] Route matched with {action = "Create", controller = "TaxComponent"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxComponentCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController (ModularERP).
2025-10-02 11:49:13.486 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 11:49:13.493 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.Create (ModularERP) in 305.5159ms
2025-10-02 11:49:13.496 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.Create (ModularERP)'
2025-10-02 11:49:13.498 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 11:49:13.499 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxComponent - 200 null application/json; charset=utf-8 340.6468ms
2025-10-02 11:49:31.294 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxProfile - application/json 354
2025-10-02 11:49:31.298 +03:00 [INF] Request started
2025-10-02 11:49:31.299 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:49:31.301 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:31.306 +03:00 [INF] Route matched with {action = "Create", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 11:49:31.423 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP) in 114.7882ms
2025-10-02 11:49:31.427 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:31.429 +03:00 [WRN] Business logic exception occurred: One or more tax components not found
ModularERP.Common.Exceptions.BusinessLogicException: One or more tax components not found
   at ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler.Handle(CreateTaxProfileCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Handlers\CreateTaxProfileHandler.cs:line 51
   at ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create(CreateTaxProfileCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Controllers\TaxProfileController.cs:line 39
   at lambda_method330(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 233
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 11:49:31.482 +03:00 [INF] Error response sent with status code 400
2025-10-02 11:49:31.485 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxProfile - 400 null application/json; charset=utf-8 191.0043ms
2025-10-02 11:49:51.768 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxProfile - application/json 253
2025-10-02 11:49:51.771 +03:00 [INF] Request started
2025-10-02 11:49:51.773 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:49:51.774 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:51.776 +03:00 [INF] Route matched with {action = "Create", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 11:49:51.852 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP) in 74.0476ms
2025-10-02 11:49:51.854 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:51.858 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TenantId'.
Invalid column name 'IsDeleted'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1f9f7f9b-56b8-46f1-bb1b-4e091cd303ab
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1828
   at ModularERP.Shared.Repository.JoinTableRepository`1.SaveChangesAsync() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\JoinTableRepository.cs:line 131
   at ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler.Handle(CreateTaxProfileCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Handlers\CreateTaxProfileHandler.cs:line 70
   at ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create(CreateTaxProfileCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Controllers\TaxProfileController.cs:line 39
   at lambda_method330(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 233
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 11:49:51.904 +03:00 [INF] Error response sent with status code 500
2025-10-02 11:49:51.906 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxProfile - 500 null application/json; charset=utf-8 138.0822ms
2025-10-02 11:49:57.699 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxProfile - application/json 253
2025-10-02 11:49:57.702 +03:00 [INF] Request started
2025-10-02 11:49:57.702 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:49:57.704 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:57.706 +03:00 [INF] Route matched with {action = "Create", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 11:49:57.713 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP) in 4.3081ms
2025-10-02 11:49:57.715 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:49:57.717 +03:00 [WRN] Business logic exception occurred: Tax profile with this name already exists
ModularERP.Common.Exceptions.BusinessLogicException: Tax profile with this name already exists
   at ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler.Handle(CreateTaxProfileCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Handlers\CreateTaxProfileHandler.cs:line 38
   at ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create(CreateTaxProfileCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Controllers\TaxProfileController.cs:line 39
   at lambda_method330(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 233
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 11:49:57.727 +03:00 [INF] Error response sent with status code 400
2025-10-02 11:49:57.728 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxProfile - 400 null application/json; charset=utf-8 28.8451ms
2025-10-02 11:50:21.857 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxProfile - application/json 254
2025-10-02 11:50:21.860 +03:00 [INF] Request started
2025-10-02 11:50:21.861 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:50:21.862 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:50:21.864 +03:00 [INF] Route matched with {action = "Create", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 11:50:21.883 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP) in 14.7593ms
2025-10-02 11:50:21.886 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:50:21.887 +03:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'TenantId'.
Invalid column name 'IsDeleted'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:1f9f7f9b-56b8-46f1-bb1b-4e091cd303ab
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1828
   at ModularERP.Shared.Repository.JoinTableRepository`1.SaveChangesAsync() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\JoinTableRepository.cs:line 131
   at ModularERP.Modules.Inventory.Features.TaxManagement.Handlers.CreateTaxProfileHandler.Handle(CreateTaxProfileCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Handlers\CreateTaxProfileHandler.cs:line 70
   at ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create(CreateTaxProfileCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\TaxManagement\Controllers\TaxProfileController.cs:line 39
   at lambda_method330(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 233
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 11:50:21.911 +03:00 [INF] Error response sent with status code 500
2025-10-02 11:50:21.913 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxProfile - 500 null application/json; charset=utf-8 55.7335ms
2025-10-02 11:56:42.263 +03:00 [INF] Starting web host...
2025-10-02 11:56:42.528 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 151
2025-10-02 11:56:42.538 +03:00 [INF] Starting web host...
2025-10-02 11:56:43.517 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:56:43.581 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 11:56:43.688 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:56:43.695 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 11:56:43.708 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 11:56:43.794 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 11:56:43.809 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 11:56:43.811 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 11:56:43.818 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 11:56:43.828 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 11:56:43.832 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 11:56:44.013 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 11:56:44.021 +03:00 [INF] Master database initialized successfully
2025-10-02 11:56:45.410 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 11:56:45.518 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 11:56:45.521 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 11:56:45.582 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 11:56:45.584 +03:00 [INF] Hosting environment: Development
2025-10-02 11:56:45.586 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 11:56:45.828 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 11:56:45.938 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 110.9938ms
2025-10-02 11:56:45.947 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:56:45.947 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 11:56:45.954 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.9446ms
2025-10-02 11:56:45.972 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.6243ms
2025-10-02 11:56:46.122 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 11:56:46.205 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 83.7203ms
2025-10-02 11:56:53.172 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 11:56:53.184 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 11.8941ms
2025-10-02 11:56:53.195 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 11:56:53.195 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:56:53.204 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.1605ms
2025-10-02 11:56:53.208 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 13.7521ms
2025-10-02 11:56:53.303 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 11:56:53.417 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 114.1046ms
2025-10-02 11:57:14.864 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/TaxProfile - application/json 254
2025-10-02 11:57:14.878 +03:00 [INF] Request started
2025-10-02 11:57:14.884 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 11:57:14.887 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:57:14.910 +03:00 [INF] Route matched with {action = "Create", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Create(ModularERP.Modules.Inventory.Features.TaxManagement.Commends.CreateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 11:57:14.917 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 11:57:15.016 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 11:57:15.345 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 11:57:15.620 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 11:57:15.639 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP) in 722.498ms
2025-10-02 11:57:15.643 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Create (ModularERP)'
2025-10-02 11:57:15.645 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 11:57:15.650 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/TaxProfile - 200 null application/json; charset=utf-8 786.2386ms
2025-10-02 12:44:27.914 +03:00 [INF] Starting web host...
2025-10-02 12:44:29.353 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 148
2025-10-02 12:44:56.713 +03:00 [INF] Starting web host...
2025-10-02 12:44:57.036 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 148
2025-10-02 12:46:38.796 +03:00 [INF] Starting web host...
2025-10-02 12:46:39.046 +03:00 [FTL] Host terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 148
2025-10-02 14:11:23.498 +03:00 [INF] Starting web host...
2025-10-02 14:11:25.909 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:26.030 +03:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 14:11:26.181 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:26.189 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 14:11:26.210 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 14:11:26.311 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 14:11:26.337 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:26.342 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 14:11:26.355 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 14:11:26.376 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 14:11:26.383 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 14:11:26.667 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 14:11:26.674 +03:00 [INF] Master database initialized successfully
2025-10-02 14:11:31.020 +03:00 [INF] Starting web host...
2025-10-02 14:11:31.930 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:31.962 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 14:11:32.035 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:32.041 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 14:11:32.045 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 14:11:32.101 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 14:11:32.117 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:11:32.120 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 14:11:32.128 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 14:11:32.139 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 14:11:32.143 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 14:11:32.295 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 14:11:32.302 +03:00 [INF] Master database initialized successfully
2025-10-02 14:11:33.810 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 14:11:33.973 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 14:11:33.975 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 14:11:34.056 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 14:11:34.058 +03:00 [INF] Hosting environment: Development
2025-10-02 14:11:34.060 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 14:11:34.435 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 14:11:34.619 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 184.9654ms
2025-10-02 14:11:34.623 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 14:11:34.623 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 14:11:34.638 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.6703ms
2025-10-02 14:11:34.688 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 65.0371ms
2025-10-02 14:11:34.727 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 14:11:34.798 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.0585ms
2025-10-02 14:12:03.163 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168//api/TaxProfile - null null
2025-10-02 14:12:03.190 +03:00 [INF] Request started
2025-10-02 14:12:03.194 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:12:03.197 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 14:12:03.204 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168//api/TaxProfile - 404 0 null 41.3903ms
2025-10-02 14:12:03.209 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7168//api/TaxProfile, Response status code: 404
2025-10-02 14:15:15.909 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - null null
2025-10-02 14:15:15.919 +03:00 [INF] Request started
2025-10-02 14:15:15.924 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:15:15.926 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetById (ModularERP)'
2025-10-02 14:15:15.954 +03:00 [INF] Route matched with {action = "GetById", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDetailDto]]] GetById(System.Guid) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 14:15:15.960 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 14:15:16.028 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:15:16.398 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 14:15:16.617 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDetailDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:15:16.649 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetById (ModularERP) in 688.2281ms
2025-10-02 14:15:16.652 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetById (ModularERP)'
2025-10-02 14:15:16.654 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:15:16.659 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - 200 null application/json; charset=utf-8 749.5338ms
2025-10-02 14:15:26.555 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168//api/TaxProfile - null null
2025-10-02 14:15:26.559 +03:00 [INF] Request started
2025-10-02 14:15:26.561 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:15:26.562 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 14:15:26.566 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168//api/TaxProfile - 404 0 null 10.8456ms
2025-10-02 14:15:26.570 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7168//api/TaxProfile, Response status code: 404
2025-10-02 14:18:00.376 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - application/json 192
2025-10-02 14:18:00.382 +03:00 [INF] Request started
2025-10-02 14:18:00.383 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:18:00.384 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Update (ModularERP)'
2025-10-02 14:18:00.397 +03:00 [INF] Route matched with {action = "Update", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]] Update(System.Guid, ModularERP.Modules.Inventory.Features.TaxManagement.Commends.UpdateTaxProfileCommand) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 14:18:00.524 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:18:00.530 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Update (ModularERP) in 129.9912ms
2025-10-02 14:18:00.532 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Update (ModularERP)'
2025-10-02 14:18:00.535 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:18:00.537 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - 200 null application/json; charset=utf-8 160.9974ms
2025-10-02 14:19:14.050 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38 - null null
2025-10-02 14:19:14.054 +03:00 [INF] Request started
2025-10-02 14:19:14.056 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:19:14.058 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP)'
2025-10-02 14:19:14.064 +03:00 [INF] Route matched with {action = "Delete", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]]] Delete(System.Guid) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 14:19:14.074 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-02 14:19:14.090 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP) in 20.6789ms
2025-10-02 14:19:14.094 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP)'
2025-10-02 14:19:14.096 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:19:14.097 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38 - 400 null application/problem+json; charset=utf-8 47.871ms
2025-10-02 14:19:37.638 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - null null
2025-10-02 14:19:37.642 +03:00 [INF] Request started
2025-10-02 14:19:37.643 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:19:37.645 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP)'
2025-10-02 14:19:37.646 +03:00 [INF] Route matched with {action = "Delete", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Boolean]]] Delete(System.Guid) on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 14:19:37.773 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 14:19:37.778 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP) in 126.9039ms
2025-10-02 14:19:37.781 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.Delete (ModularERP)'
2025-10-02 14:19:37.785 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:19:37.788 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7168/api/TaxProfile/{87a405a7-4547-4ec3-d2c5-08de0191af38} - 200 null application/json; charset=utf-8 150.1226ms
2025-10-02 14:20:42.552 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/36fe66f2-0900-4010-3652-08ddfe0a8e14 - null null
2025-10-02 14:20:42.556 +03:00 [INF] Request started
2025-10-02 14:20:42.559 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:20:42.561 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:20:42.570 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:20:42.594 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "36fe66f2-0900-4010-3652-08ddfe0a8e14"
2025-10-02 14:20:42.621 +03:00 [WRN]  Voucher with ID "36fe66f2-0900-4010-3652-08ddfe0a8e14" not found
2025-10-02 14:20:42.625 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:20:42.632 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 56.1178ms
2025-10-02 14:20:42.635 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:20:42.637 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 14:20:42.639 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/36fe66f2-0900-4010-3652-08ddfe0a8e14 - 404 null application/json; charset=utf-8 87.0457ms
2025-10-02 14:23:10.539 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Companies - application/json 58
2025-10-02 14:23:10.543 +03:00 [INF] Request started
2025-10-02 14:23:10.545 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:23:10.546 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.CreateCompany (ModularERP)'
2025-10-02 14:23:10.551 +03:00 [INF] Route matched with {action = "CreateCompany", controller = "Companies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto]]] CreateCompany(ModularERP.Modules.Finance.Features.Companys.DTO.CreateCompanyDto) on controller ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController (ModularERP).
2025-10-02 14:23:10.632 +03:00 [INF] Creating new company with name: ITechProMaxFax
2025-10-02 14:23:10.699 +03:00 [WRN] Company with name ITechProMaxFax already exists
2025-10-02 14:23:10.703 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.CreateCompany (ModularERP) in 146.7801ms
2025-10-02 14:23:10.717 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.CreateCompany (ModularERP)'
2025-10-02 14:23:10.723 +03:00 [WRN] Business logic exception occurred: Company with name 'ITechProMaxFax' already exists
ModularERP.Common.Exceptions.BusinessLogicException: Company with name 'ITechProMaxFax' already exists
   at ModularERP.Modules.Finance.Features.Companys.Handlers.CreateCompanyHandler.Handle(CreateCompanyCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\Companys\Handlers\CreateCompanyHandler.cs:line 57
   at ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.CreateCompany(CreateCompanyDto createCompanyDto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\Companys\Controllers\CompaniesController.cs:line 46
   at lambda_method510(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 221
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 14:23:10.776 +03:00 [INF] Error response sent with status code 400
2025-10-02 14:23:10.779 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Companies - 400 null application/json; charset=utf-8 239.5997ms
2025-10-02 14:23:20.041 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - null null
2025-10-02 14:23:20.046 +03:00 [INF] Request started
2025-10-02 14:23:20.047 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 14:23:20.048 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:23:20.054 +03:00 [INF] Route matched with {action = "GetAllCompanies", controller = "Companies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto]]]] GetAllCompanies() on controller ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController (ModularERP).
2025-10-02 14:23:20.109 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:23:20.115 +03:00 [INF] Retrieving all companies
2025-10-02 14:23:20.143 +03:00 [INF] Successfully retrieved 0 companies
2025-10-02 14:23:20.146 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 14:23:20.149 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP) in 92.03ms
2025-10-02 14:23:20.152 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:23:20.155 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:23:20.157 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - 200 null application/json; charset=utf-8 115.9279ms
2025-10-02 14:23:26.300 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - null null
2025-10-02 14:23:26.304 +03:00 [INF] Request started
2025-10-02 14:23:26.305 +03:00 [INF] Processing request for tenant: 87a405a7-4547-4ec3-d2c5-08de0191af38
2025-10-02 14:23:26.306 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:23:26.308 +03:00 [INF] Route matched with {action = "GetAllCompanies", controller = "Companies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto]]]] GetAllCompanies() on controller ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController (ModularERP).
2025-10-02 14:23:26.314 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:23:26.318 +03:00 [INF] Retrieving all companies
2025-10-02 14:23:26.321 +03:00 [INF] Successfully retrieved 0 companies
2025-10-02 14:23:26.323 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 14:23:26.325 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP) in 12.707ms
2025-10-02 14:23:26.328 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:23:26.331 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:23:26.334 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - 200 null application/json; charset=utf-8 33.898ms
2025-10-02 14:24:00.964 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - null null
2025-10-02 14:24:00.968 +03:00 [INF] Request started
2025-10-02 14:24:00.969 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:24:00.970 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:24:00.972 +03:00 [INF] Route matched with {action = "GetAllCompanies", controller = "Companies"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto]]]] GetAllCompanies() on controller ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController (ModularERP).
2025-10-02 14:24:00.979 +03:00 [INF] Retrieving all companies
2025-10-02 14:24:01.019 +03:00 [INF] Successfully retrieved 1 companies
2025-10-02 14:24:01.021 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Finance.Features.Companys.DTO.CompanyResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 14:24:01.027 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP) in 48.8447ms
2025-10-02 14:24:01.030 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Companys.Controllers.CompaniesController.GetAllCompanies (ModularERP)'
2025-10-02 14:24:01.031 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:24:01.033 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/Companies?X-Tenant-ID=0794b76b-6560-41a1-a146-7e059ed3c64f - 200 null application/json; charset=utf-8 68.7241ms
2025-10-02 14:24:39.149 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Treasury - application/json 277
2025-10-02 14:24:39.154 +03:00 [INF] Request started
2025-10-02 14:24:39.155 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:24:39.156 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:24:39.163 +03:00 [INF] Route matched with {action = "CreateTreasury", controller = "Treasury"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto]]] CreateTreasury(ModularERP.Modules.Finance.Features.Treasuries.DTO.CreateTreasuryDto) on controller ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController (ModularERP).
2025-10-02 14:24:39.281 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:24:39.284 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP) in 116.9548ms
2025-10-02 14:24:39.287 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:24:39.289 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:24:39.290 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Treasury - 500 null application/json; charset=utf-8 140.6728ms
2025-10-02 14:24:51.102 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Treasury - application/json 277
2025-10-02 14:24:51.105 +03:00 [INF] Request started
2025-10-02 14:24:51.106 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:24:51.108 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:24:51.109 +03:00 [INF] Route matched with {action = "CreateTreasury", controller = "Treasury"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto]]] CreateTreasury(ModularERP.Modules.Finance.Features.Treasuries.DTO.CreateTreasuryDto) on controller ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController (ModularERP).
2025-10-02 14:24:51.120 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:24:51.125 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP) in 10.2944ms
2025-10-02 14:24:51.128 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:24:51.129 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:24:51.131 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Treasury - 500 null application/json; charset=utf-8 28.7371ms
2025-10-02 14:27:08.614 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GlAccount - application/json 140
2025-10-02 14:27:08.618 +03:00 [INF] Request started
2025-10-02 14:27:08.620 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 14:27:08.621 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 14:27:08.626 +03:00 [INF] Route matched with {action = "CreateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] CreateGlAccount(ModularERP.Modules.Finance.Features.GlAccounts.DTO.CreateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 14:27:08.640 +03:00 [INF] Received request to create GLAccount with Code: GlAccount_102
2025-10-02 14:27:08.645 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:27:08.658 +03:00 [INF] Starting GLAccount creation process for Code: GlAccount_102, Company: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:27:08.720 +03:00 [ERR] Error occurred while creating GLAccount for Code: GlAccount_102
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_GlAccounts_Companies_CompanyId". The conflict occurred in database "ModularERP_Default", table "dbo.Companies", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7d62224f-8af2-44cd-b57f-a38ea6e16b5e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Finance.Features.GlAccounts.Handlers.CreateGlAccountHandler.Handle(CreateGlAccountCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\GlAccounts\Handlers\CreateGlAccountHandler.cs:line 51
2025-10-02 14:27:08.764 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP) in 134.6907ms
2025-10-02 14:27:08.766 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 14:27:08.768 +03:00 [WRN] Business logic exception occurred: An error occurred while creating the GLAccount
ModularERP.Common.Exceptions.BusinessLogicException: An error occurred while creating the GLAccount
   at ModularERP.Modules.Finance.Features.GlAccounts.Handlers.CreateGlAccountHandler.Handle(CreateGlAccountCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\GlAccounts\Handlers\CreateGlAccountHandler.cs:line 87
   at ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount(CreateGlAccountDto createDto) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\GlAccounts\Controllers\GlAccountController.cs:line 31
   at lambda_method868(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 221
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-02 14:27:08.786 +03:00 [INF] Error response sent with status code 400
2025-10-02 14:27:08.788 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GlAccount - 400 null application/json; charset=utf-8 173.5967ms
2025-10-02 14:27:38.929 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GlAccount - application/json 138
2025-10-02 14:27:38.932 +03:00 [INF] Request started
2025-10-02 14:27:38.933 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:27:38.935 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 14:27:38.937 +03:00 [INF] Route matched with {action = "CreateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] CreateGlAccount(ModularERP.Modules.Finance.Features.GlAccounts.DTO.CreateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 14:27:38.944 +03:00 [INF] Received request to create GLAccount with Code: GlAccount_102
2025-10-02 14:27:38.946 +03:00 [INF] Starting GLAccount creation process for Code: GlAccount_102, Company: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:27:38.962 +03:00 [INF] GLAccount created successfully with ID: "e44a75fd-e023-4485-b7ed-08de01a69f95", Code: GlAccount_102
2025-10-02 14:27:39.003 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:27:39.023 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP) in 79.409ms
2025-10-02 14:27:39.027 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 14:27:39.028 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 14:27:39.030 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GlAccount - 201 null application/json; charset=utf-8 101.1886ms
2025-10-02 14:27:55.672 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Treasury - application/json 277
2025-10-02 14:27:55.675 +03:00 [INF] Request started
2025-10-02 14:27:55.676 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:27:55.677 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:27:55.680 +03:00 [INF] Route matched with {action = "CreateTreasury", controller = "Treasury"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto]]] CreateTreasury(ModularERP.Modules.Finance.Features.Treasuries.DTO.CreateTreasuryDto) on controller ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController (ModularERP).
2025-10-02 14:27:55.695 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:27:55.697 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP) in 11.2333ms
2025-10-02 14:27:55.702 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:27:55.704 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:27:55.705 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Treasury - 500 null application/json; charset=utf-8 33.6496ms
2025-10-02 14:29:49.159 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/Treasury - application/json 277
2025-10-02 14:29:49.162 +03:00 [INF] Request started
2025-10-02 14:29:49.163 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:29:49.164 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:29:49.166 +03:00 [INF] Route matched with {action = "CreateTreasury", controller = "Treasury"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto]]] CreateTreasury(ModularERP.Modules.Finance.Features.Treasuries.DTO.CreateTreasuryDto) on controller ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController (ModularERP).
2025-10-02 14:29:49.185 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.Treasuries.DTO.TreasuryCreatedDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:29:49.189 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP) in 19.4207ms
2025-10-02 14:29:49.192 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.Treasuries.Controllers.TreasuryController.CreateTreasury (ModularERP)'
2025-10-02 14:29:49.195 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 14:29:49.198 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/Treasury - 201 null application/json; charset=utf-8 38.95ms
2025-10-02 14:31:04.490 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------438095903998949423237304 48408
2025-10-02 14:31:04.495 +03:00 [INF] Request started
2025-10-02 14:31:04.496 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 14:31:04.498 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:31:04.508 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:31:04.617 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.621 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.625 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.633 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.640 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.644 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.676 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:31:04.712 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:31:04.761 +03:00 [INF]  Tenant verified: "9df6fad9-79f1-4722-bec3-fc20bb0d5c14"
2025-10-02 14:31:04.783 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:31:04.786 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 271.7762ms
2025-10-02 14:31:04.788 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:31:04.790 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:31:04.792 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 301.4397ms
2025-10-02 14:35:19.629 +03:00 [INF] Starting web host...
2025-10-02 14:35:20.760 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:35:20.822 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 14:35:20.905 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:35:20.911 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 14:35:20.923 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 14:35:20.994 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 14:35:21.013 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 14:35:21.018 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 14:35:21.025 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 14:35:21.038 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 14:35:21.043 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 14:35:21.234 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 14:35:21.242 +03:00 [INF] Master database initialized successfully
2025-10-02 14:35:22.689 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 14:35:22.796 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 14:35:22.798 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 14:35:22.866 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 14:35:22.867 +03:00 [INF] Hosting environment: Development
2025-10-02 14:35:22.869 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 14:35:22.964 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 14:35:23.094 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 132.3047ms
2025-10-02 14:35:23.102 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 14:35:23.102 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 14:35:23.117 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.9862ms
2025-10-02 14:35:23.133 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.5731ms
2025-10-02 14:35:23.316 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 14:35:23.382 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 65.833ms
2025-10-02 14:35:34.952 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------840696484603815434857278 48408
2025-10-02 14:35:34.973 +03:00 [INF] Request started
2025-10-02 14:35:34.979 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 14:35:34.983 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:35:35.007 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:35:35.015 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 14:35:35.111 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.128 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.172 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.179 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.186 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.191 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.430 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 14:35:35.471 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:35.504 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:35:35.553 +03:00 [INF]  Tenant verified: "9df6fad9-79f1-4722-bec3-fc20bb0d5c14"
2025-10-02 14:35:35.570 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:35:35.589 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 573.9527ms
2025-10-02 14:35:35.593 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:35:35.596 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:35:35.602 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 650.1189ms
2025-10-02 14:35:55.370 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------180512982073241107551297 48408
2025-10-02 14:35:55.378 +03:00 [INF] Request started
2025-10-02 14:35:55.382 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:35:55.383 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:35:55.386 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:35:55.438 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 14:35:55.489 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:35:55.534 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:35:55.597 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:35:55.634 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:35:55.670 +03:00 [INF]  DTO validation passed
2025-10-02 14:35:55.775 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:35:55.778 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 385.6313ms
2025-10-02 14:35:55.781 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:35:55.782 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:35:55.784 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 414.1856ms
2025-10-02 14:37:17.883 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GlAccount/3C8CD441-A748-44A9-8419-08DDFB5479F3 - application/json 181
2025-10-02 14:37:17.888 +03:00 [INF] Request started
2025-10-02 14:37:17.890 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:37:17.892 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:37:17.898 +03:00 [INF] Route matched with {action = "UpdateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] UpdateGlAccount(System.Guid, ModularERP.Modules.Finance.Features.GlAccounts.DTO.UpdateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 14:37:17.915 +03:00 [INF] Received request to update GLAccount with ID: "3c8cd441-a748-44a9-8419-08ddfb5479f3"
2025-10-02 14:37:17.917 +03:00 [WRN] GLAccount ID mismatch - URL ID: "3c8cd441-a748-44a9-8419-08ddfb5479f3", Body ID: "e44a75fd-e023-4485-b7ed-08de01a69f95"
2025-10-02 14:37:17.918 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:37:17.926 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP) in 22.3737ms
2025-10-02 14:37:17.928 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:37:17.932 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:37:17.933 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GlAccount/3C8CD441-A748-44A9-8419-08DDFB5479F3 - 400 null application/json; charset=utf-8 49.6194ms
2025-10-02 14:37:37.544 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GlAccount/e44a75fd-e023-4485-b7ed-08de01a69f95 - application/json 181
2025-10-02 14:37:37.547 +03:00 [INF] Request started
2025-10-02 14:37:37.548 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:37:37.549 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:37:37.552 +03:00 [INF] Route matched with {action = "UpdateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] UpdateGlAccount(System.Guid, ModularERP.Modules.Finance.Features.GlAccounts.DTO.UpdateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 14:37:37.558 +03:00 [INF] Received request to update GLAccount with ID: "e44a75fd-e023-4485-b7ed-08de01a69f95"
2025-10-02 14:37:37.562 +03:00 [INF] ==> Starting GLAccount update process
2025-10-02 14:37:37.675 +03:00 [INF] Changes saved successfully for GLAccount ID: "e44a75fd-e023-4485-b7ed-08de01a69f95"
2025-10-02 14:37:37.712 +03:00 [INF] GLAccount updated successfully with ID: "e44a75fd-e023-4485-b7ed-08de01a69f95", Code: anyyy
2025-10-02 14:37:37.714 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:37:37.719 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP) in 161.4823ms
2025-10-02 14:37:37.722 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:37:37.725 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:37:37.726 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GlAccount/e44a75fd-e023-4485-b7ed-08de01a69f95 - 200 null application/json; charset=utf-8 182.3927ms
2025-10-02 14:37:44.947 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------306478476192736705087762 48408
2025-10-02 14:37:44.951 +03:00 [INF] Request started
2025-10-02 14:37:44.952 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:37:44.953 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:37:44.956 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:37:45.001 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:37:45.047 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:37:45.053 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:37:45.056 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:37:45.059 +03:00 [INF]  DTO validation passed
2025-10-02 14:37:45.069 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:37:45.072 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 111.5855ms
2025-10-02 14:37:45.075 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:37:45.079 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:37:45.081 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 134.466ms
2025-10-02 14:38:13.616 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GlAccount/e44a75fd-e023-4485-b7ed-08de01a69f95 - application/json 181
2025-10-02 14:38:13.620 +03:00 [INF] Request started
2025-10-02 14:38:13.621 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:38:13.622 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:38:13.624 +03:00 [INF] Route matched with {action = "UpdateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] UpdateGlAccount(System.Guid, ModularERP.Modules.Finance.Features.GlAccounts.DTO.UpdateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 14:38:13.632 +03:00 [INF] Received request to update GLAccount with ID: "e44a75fd-e023-4485-b7ed-08de01a69f95"
2025-10-02 14:38:13.634 +03:00 [INF] ==> Starting GLAccount update process
2025-10-02 14:38:13.648 +03:00 [INF] Changes saved successfully for GLAccount ID: "e44a75fd-e023-4485-b7ed-08de01a69f95"
2025-10-02 14:38:13.652 +03:00 [INF] GLAccount updated successfully with ID: "e44a75fd-e023-4485-b7ed-08de01a69f95", Code: anyyy
2025-10-02 14:38:13.653 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:38:13.655 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP) in 23.7244ms
2025-10-02 14:38:13.659 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.UpdateGlAccount (ModularERP)'
2025-10-02 14:38:13.661 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:38:13.663 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GlAccount/e44a75fd-e023-4485-b7ed-08de01a69f95 - 200 null application/json; charset=utf-8 47.0168ms
2025-10-02 14:38:23.635 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------282300382908113154168142 48408
2025-10-02 14:38:23.640 +03:00 [INF] Request started
2025-10-02 14:38:23.641 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:38:23.643 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:38:23.646 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:38:23.654 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:38:23.700 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:38:23.705 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:38:23.710 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:38:23.711 +03:00 [INF]  DTO validation passed
2025-10-02 14:38:23.717 +03:00 [INF]  Business validations passed
2025-10-02 14:38:24.098 +03:00 [INF]  Voucher saved with ID: "4610ef1e-9986-4027-c0cd-08de01a831f5"
2025-10-02 14:38:24.161 +03:00 [ERR]  Error processing tax lines
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Finance.Features.ExpensesVoucher.Handlers.CreateExpenseVoucherHandler.Handle(CreateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\CreateExpenseVoucherHandler.cs:line 225
2025-10-02 14:38:24.230 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:38:24.234 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 583.0457ms
2025-10-02 14:38:24.237 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:38:24.239 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:38:24.240 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 605.0859ms
2025-10-02 14:38:38.336 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 14:38:38.345 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 8.6681ms
2025-10-02 14:38:38.355 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 14:38:38.355 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 14:38:38.362 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.2308ms
2025-10-02 14:38:38.367 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 11.3287ms
2025-10-02 14:38:38.547 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 14:38:38.607 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 59.9398ms
2025-10-02 14:40:24.816 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------459437373333129743905185 48408
2025-10-02 14:40:24.822 +03:00 [INF] Request started
2025-10-02 14:40:24.823 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:40:24.824 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:40:24.825 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:40:24.833 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-102","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:40:24.878 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:40:24.884 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:40:24.888 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:40:24.889 +03:00 [INF]  DTO validation passed
2025-10-02 14:40:24.895 +03:00 [INF]  Business validations passed
2025-10-02 14:40:24.909 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:40:24.911 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 80.6264ms
2025-10-02 14:40:24.916 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:40:24.918 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:40:24.919 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 102.9209ms
2025-10-02 14:41:43.526 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------223209519597058965007774 48408
2025-10-02 14:41:43.530 +03:00 [INF] Request started
2025-10-02 14:41:43.531 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:41:43.533 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:41:43.534 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:41:43.544 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-101","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[{\"TaxProfileId\":\"87a405a7-4547-4ec3-d2c5-08de0191af38\",\"BaseAmount\":100,\"TaxAmount\":14.0,\"IsWithholding\":true}]","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"00000000-0000-0000-0000-000000000000","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":0,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:41:43.585 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:41:43.591 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:41:43.594 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:41:43.595 +03:00 [INF]  DTO validation passed
2025-10-02 14:41:43.599 +03:00 [INF]  Business validations passed
2025-10-02 14:41:43.618 +03:00 [INF]  Voucher saved with ID: "7313b76c-b13d-4e16-c0ce-08de01a831f5"
2025-10-02 14:41:43.625 +03:00 [ERR]  Error processing tax lines
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at ModularERP.Modules.Finance.Features.ExpensesVoucher.Handlers.CreateExpenseVoucherHandler.Handle(CreateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\CreateExpenseVoucherHandler.cs:line 225
2025-10-02 14:41:43.664 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:41:43.705 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 163.1393ms
2025-10-02 14:41:43.819 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:41:43.821 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 14:41:43.822 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 400 null application/json; charset=utf-8 296.2981ms
2025-10-02 14:43:58.314 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------326965986580484003212333 48525
2025-10-02 14:43:58.321 +03:00 [INF] Request started
2025-10-02 14:43:58.323 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:43:58.323 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:43:58.325 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:43:58.335 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-100","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[\n  {\n    \"TaxProfileId\": \"87a405a7-4547-4ec3-d2c5-08de0191af38\",\n    \"TaxComponentId\": \"d14418b8-daa9-442d-a436-08de01908fd2\",\n    \"BaseAmount\": 100,\n    \"TaxAmount\": 14.0,\n    \"AppliedRate\": 14,\n    \"IsWithholding\": true\n  }\n]\n","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"d14418b8-daa9-442d-a436-08de01908fd2","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":14,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 14:43:58.519 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 14:43:58.538 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 14:43:58.551 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 14:43:58.553 +03:00 [INF]  DTO validation passed
2025-10-02 14:43:58.560 +03:00 [INF]  Business validations passed
2025-10-02 14:43:58.578 +03:00 [INF]  Voucher saved with ID: "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:43:58.583 +03:00 [INF]  Saved 1 tax lines
2025-10-02 14:43:58.590 +03:00 [INF]  Processed attachment: Hossam-Reda-Tohamy-BackEnd Laravel.pdf, Size: 46529 bytes, MimeType: application/pdf
2025-10-02 14:43:58.623 +03:00 [INF]  Saved 1 attachments to database
2025-10-02 14:43:58.670 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:43:58.691 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 358.9078ms
2025-10-02 14:43:58.693 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 14:43:58.695 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 14:43:58.696 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 201 null application/json; charset=utf-8 382.282ms
2025-10-02 14:44:39.808 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/36fe66f2-0900-4010-3652-08ddfe0a8e14 - null null
2025-10-02 14:44:39.812 +03:00 [INF] Request started
2025-10-02 14:44:39.813 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:44:39.814 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:44:39.819 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:44:39.828 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "36fe66f2-0900-4010-3652-08ddfe0a8e14"
2025-10-02 14:44:39.849 +03:00 [WRN]  Voucher with ID "36fe66f2-0900-4010-3652-08ddfe0a8e14" not found
2025-10-02 14:44:39.852 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:44:39.853 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 29.9613ms
2025-10-02 14:44:39.856 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:44:39.857 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 14:44:39.859 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/36fe66f2-0900-4010-3652-08ddfe0a8e14 - 404 null application/json; charset=utf-8 50.79ms
2025-10-02 14:45:02.979 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - null null
2025-10-02 14:45:02.983 +03:00 [INF] Request started
2025-10-02 14:45:02.984 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:45:02.985 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:45:02.987 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:45:02.994 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:45:03.001 +03:00 [INF]  Voucher retrieved: EXP-100
2025-10-02 14:45:03.022 +03:00 [INF]  Retrieved 1 tax lines for voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:45:03.036 +03:00 [INF]  Retrieved 1 attachments for voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:45:03.041 +03:00 [INF]  Successfully built response for voucher EXP-100 with 1 tax lines and 1 attachments
2025-10-02 14:45:03.043 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:45:03.045 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 52.2057ms
2025-10-02 14:45:03.047 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 14:45:03.048 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 14:45:03.050 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 200 null application/json; charset=utf-8 70.5757ms
2025-10-02 14:49:46.451 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/112a1863-4f40-47bd-2b8a-08ddfe0b9135 - multipart/form-data; boundary=--------------------------105291389598445912519463 85656
2025-10-02 14:49:46.456 +03:00 [INF] Request started
2025-10-02 14:49:46.457 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:49:46.458 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:49:46.468 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:49:46.518 +03:00 [INF] Start updating expense voucher "112a1863-4f40-47bd-2b8a-08ddfe0b9135"
2025-10-02 14:49:46.533 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:49:46.536 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 61.349ms
2025-10-02 14:49:46.540 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:49:46.542 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 14:49:46.546 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/112a1863-4f40-47bd-2b8a-08ddfe0b9135 - 404 null application/json; charset=utf-8 95.197ms
2025-10-02 14:50:19.217 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------081438742414322864716208 85656
2025-10-02 14:50:19.221 +03:00 [INF] Request started
2025-10-02 14:50:19.222 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:50:19.224 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:50:19.230 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:50:19.244 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:50:19.304 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:50:19.338 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:50:19.340 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 103.7712ms
2025-10-02 14:50:19.342 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:50:19.346 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:50:19.348 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 131.1359ms
2025-10-02 14:52:42.989 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------167838572180297151172328 85656
2025-10-02 14:52:42.997 +03:00 [INF] Request started
2025-10-02 14:52:42.998 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:52:42.999 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:52:43.002 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:52:43.014 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:52:43.044 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:52:43.080 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:52:43.082 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 72.515ms
2025-10-02 14:52:43.086 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:52:43.088 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:52:43.090 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 101.4984ms
2025-10-02 14:54:11.392 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------064878677043275960538483 85656
2025-10-02 14:54:11.397 +03:00 [INF] Request started
2025-10-02 14:54:11.398 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:54:11.399 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:54:11.401 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:54:11.410 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:54:11.430 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:54:11.464 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:54:11.466 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 59.0817ms
2025-10-02 14:54:11.468 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:54:11.471 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:54:11.475 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 82.204ms
2025-10-02 14:54:39.704 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------621957873143490046177543 85656
2025-10-02 14:54:39.708 +03:00 [INF] Request started
2025-10-02 14:54:39.709 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:54:39.710 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:54:39.713 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:54:39.727 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:54:39.742 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:54:39.777 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:54:39.780 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 56.6407ms
2025-10-02 14:54:39.783 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:54:39.787 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:54:39.789 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 84.8173ms
2025-10-02 14:57:08.361 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------070303077468732446522493 85656
2025-10-02 14:57:08.365 +03:00 [INF] Request started
2025-10-02 14:57:08.366 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:57:08.368 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:57:08.371 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:57:08.378 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:57:08.398 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:57:08.432 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:57:08.434 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 59.0486ms
2025-10-02 14:57:08.436 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:57:08.439 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:57:08.442 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 80.8194ms
2025-10-02 14:57:31.001 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - multipart/form-data; boundary=--------------------------705808573930592267835470 85656
2025-10-02 14:57:31.005 +03:00 [INF] Request started
2025-10-02 14:57:31.007 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 14:57:31.008 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:57:31.012 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 14:57:31.018 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 14:57:31.031 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 14:57:31.067 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 14:57:31.069 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 52.754ms
2025-10-02 14:57:31.073 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 14:57:31.075 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 14:57:31.077 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 500 null application/json; charset=utf-8 75.5337ms
2025-10-02 15:00:48.692 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{3fa157f9-837c-4f82-c0cf-08de01a831f5} - multipart/form-data; boundary=--------------------------835182756220559393458391 85656
2025-10-02 15:00:48.696 +03:00 [INF] Request started
2025-10-02 15:00:48.697 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:00:48.698 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:00:48.699 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:00:48.707 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 15:00:48.732 +03:00 [ERR] Error updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_VoucherTaxes_TaxComponents_TaxComponentId". The conflict occurred in database "ModularERP_Tenant_0ff3e71b0c6347979413d900ac5cda78", table "dbo.TaxComponents", column 'Id'.
The statement has been terminated.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8f1092b1-19bc-4b73-ad5f-8599b17e51fc
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 1816
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 176
   at UpdateExpenseVoucherHandler.Handle(UpdateExpenseVoucherCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Features\ExpensesVoucher\Handlers\UpdateExpenseVoucherHandler.cs:line 154
2025-10-02 15:00:48.761 +03:00 [INF] Executing ObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:00:48.765 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 60.5714ms
2025-10-02 15:00:48.768 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:00:48.769 +03:00 [INF] Request completed successfully with status code 500
2025-10-02 15:00:48.771 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{3fa157f9-837c-4f82-c0cf-08de01a831f5} - 500 null application/json; charset=utf-8 79.2992ms
2025-10-02 15:08:24.127 +03:00 [INF] Starting web host...
2025-10-02 15:08:24.979 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:08:25.052 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 15:08:25.121 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:08:25.127 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 15:08:25.131 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 15:08:25.206 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 15:08:25.229 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:08:25.233 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 15:08:25.243 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 15:08:25.257 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 15:08:25.263 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 15:08:25.527 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 15:08:25.535 +03:00 [INF] Master database initialized successfully
2025-10-02 15:08:26.964 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 15:08:27.064 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 15:08:27.066 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 15:08:27.131 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 15:08:27.133 +03:00 [INF] Hosting environment: Development
2025-10-02 15:08:27.134 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 15:08:27.577 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:08:27.692 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 115.6324ms
2025-10-02 15:08:27.694 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:08:27.694 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:08:27.704 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.452ms
2025-10-02 15:08:27.727 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.1484ms
2025-10-02 15:08:27.879 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:08:27.936 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 56.992ms
2025-10-02 15:08:31.131 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{3fa157f9-837c-4f82-c0cf-08de01a831f5} - multipart/form-data; boundary=--------------------------469301390380310912091984 85656
2025-10-02 15:08:31.148 +03:00 [INF] Request started
2025-10-02 15:08:31.153 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:08:31.156 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:08:31.174 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:08:31.181 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:08:31.273 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:08:31.542 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:08:31.576 +03:00 [INF] Start updating expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 15:08:32.057 +03:00 [INF]  Deleted file: /uploads/2aae5773-9b0f-4ca0-9f02-2ac5adff2b9c_Hossam-Reda-Tohamy-BackEnd Laravel.pdf
2025-10-02 15:08:32.150 +03:00 [INF]  Processed new attachment: Back End .NET.pdf, Size: 83767 bytes, MimeType: application/pdf
2025-10-02 15:08:32.196 +03:00 [INF] Successfully updated expense voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5" with 1 attachments
2025-10-02 15:08:32.203 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:08:32.231 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 1050.1996ms
2025-10-02 15:08:32.235 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:08:32.238 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:08:32.247 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{3fa157f9-837c-4f82-c0cf-08de01a831f5} - 200 null application/json; charset=utf-8 1116.0359ms
2025-10-02 15:24:05.192 +03:00 [INF] Starting web host...
2025-10-02 15:24:06.079 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:06.124 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 15:24:06.229 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:06.234 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 15:24:06.239 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 15:24:06.308 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 15:24:06.324 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:06.331 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 15:24:06.341 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 15:24:06.355 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 15:24:06.359 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 15:24:06.569 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 15:24:06.579 +03:00 [INF] Master database initialized successfully
2025-10-02 15:24:08.087 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 15:24:08.186 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 15:24:08.188 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 15:24:08.253 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 15:24:08.254 +03:00 [INF] Hosting environment: Development
2025-10-02 15:24:08.256 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 15:24:08.651 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:24:08.774 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 123.4919ms
2025-10-02 15:24:08.917 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:24:08.917 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:24:08.923 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.5225ms
2025-10-02 15:24:08.945 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.3207ms
2025-10-02 15:24:08.999 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:24:09.083 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 83.7759ms
2025-10-02 15:24:18.566 +03:00 [INF] Starting web host...
2025-10-02 15:24:19.468 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:19.500 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 15:24:19.573 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:19.579 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 15:24:19.583 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 15:24:19.639 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 15:24:19.658 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:24:19.662 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 15:24:19.670 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 15:24:19.685 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 15:24:19.690 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 15:24:19.858 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 15:24:19.866 +03:00 [INF] Master database initialized successfully
2025-10-02 15:24:21.348 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 15:24:21.444 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 15:24:21.446 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 15:24:21.510 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 15:24:21.513 +03:00 [INF] Hosting environment: Development
2025-10-02 15:24:21.514 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 15:24:21.971 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:24:22.088 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 117.4498ms
2025-10-02 15:24:22.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:24:22.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:24:22.157 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.3648ms
2025-10-02 15:24:22.177 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.7002ms
2025-10-02 15:24:22.205 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:24:22.281 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 76.3023ms
2025-10-02 15:24:31.904 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - null null
2025-10-02 15:24:31.927 +03:00 [INF] Request started
2025-10-02 15:24:31.933 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:24:31.936 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:24:31.960 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:24:31.966 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:24:32.042 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:24:32.419 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:24:32.429 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 15:24:32.572 +03:00 [INF]  Voucher retrieved: EXP-100
2025-10-02 15:24:32.739 +03:00 [INF]  Retrieved 1 tax lines for voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 15:24:32.778 +03:00 [INF]  Retrieved 1 attachments for voucher "3fa157f9-837c-4f82-c0cf-08de01a831f5"
2025-10-02 15:24:32.801 +03:00 [INF]  Successfully built response for voucher EXP-100 with 1 tax lines and 1 attachments
2025-10-02 15:24:32.810 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:24:32.846 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 879.8416ms
2025-10-02 15:24:32.850 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:24:32.853 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:24:32.859 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/3fa157f9-837c-4f82-c0cf-08de01a831f5 - 200 null application/json; charset=utf-8 955.8296ms
2025-10-02 15:25:05.494 +03:00 [INF] Starting web host...
2025-10-02 15:25:06.331 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:25:06.371 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 15:25:06.441 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:25:06.447 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 15:25:06.452 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 15:25:06.509 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 15:25:06.525 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:25:06.530 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 15:25:06.536 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 15:25:06.548 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 15:25:06.553 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 15:25:06.718 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 15:25:06.726 +03:00 [INF] Master database initialized successfully
2025-10-02 15:25:08.051 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 15:25:08.148 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 15:25:08.149 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 15:25:08.212 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 15:25:08.214 +03:00 [INF] Hosting environment: Development
2025-10-02 15:25:08.216 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 15:25:08.601 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:25:08.714 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 113.7897ms
2025-10-02 15:25:08.714 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:25:08.714 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:25:08.726 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 11.6321ms
2025-10-02 15:25:08.749 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.2475ms
2025-10-02 15:25:08.788 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:25:08.848 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 59.9894ms
2025-10-02 15:26:35.362 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - multipart/form-data; boundary=--------------------------154357724247060048327260 48525
2025-10-02 15:26:35.378 +03:00 [INF] Request started
2025-10-02 15:26:35.383 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:26:35.386 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 15:26:35.405 +03:00 [INF] Route matched with {action = "CreateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] CreateExpenseVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:26:35.414 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:26:35.508 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:26:35.781 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:26:35.845 +03:00 [INF]  Start Handle CreateExpenseVoucher with Request: {"Code":"EXP-103","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"e44a75fd-e023-4485-b7ed-08de01a69f95","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[\n  {\n    \"TaxProfileId\": \"87a405a7-4547-4ec3-d2c5-08de0191af38\",\n    \"TaxComponentId\": \"d14418b8-daa9-442d-a436-08de01908fd2\",\n    \"BaseAmount\": 100,\n    \"TaxAmount\": 14.0,\n    \"AppliedRate\": 14,\n    \"IsWithholding\": true\n  }\n]\n","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-BackEnd Laravel.pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":46529,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-BackEnd Laravel.pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"TaxLines":[{"TaxProfileId":"87a405a7-4547-4ec3-d2c5-08de0191af38","TaxComponentId":"d14418b8-daa9-442d-a436-08de01908fd2","BaseAmount":100,"TaxAmount":14.0,"AppliedRate":14,"IsWithholding":true,"$type":"TaxLineDto"}],"$type":"CreateExpenseVoucherDto"}
2025-10-02 15:26:35.892 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 15:26:35.967 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 15:26:36.007 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 15:26:36.041 +03:00 [INF]  DTO validation passed
2025-10-02 15:26:36.130 +03:00 [INF]  Business validations passed
2025-10-02 15:26:36.371 +03:00 [INF]  Voucher saved with ID: "e619ae16-27e6-4a0b-f67a-08de01aeedfa"
2025-10-02 15:26:36.420 +03:00 [INF]  Saved 1 tax lines
2025-10-02 15:26:36.427 +03:00 [INF]  Processed attachment: Hossam-Reda-Tohamy-BackEnd Laravel.pdf, Size: 46529 bytes, MimeType: application/pdf
2025-10-02 15:26:36.492 +03:00 [INF]  Saved 1 attachments to database
2025-10-02 15:26:36.565 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:26:36.600 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP) in 1188.0163ms
2025-10-02 15:26:36.604 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.CreateExpenseVoucher (ModularERP)'
2025-10-02 15:26:36.606 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 15:26:36.614 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/ExpenseVouchers - 201 null application/json; charset=utf-8 1251.8537ms
2025-10-02 15:27:04.064 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{e619ae16-27e6-4a0b-f67a-08de01aeedfa} - multipart/form-data; boundary=--------------------------521887460623070153810251 85656
2025-10-02 15:27:04.072 +03:00 [INF] Request started
2025-10-02 15:27:04.077 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:27:04.079 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:27:04.089 +03:00 [INF] Route matched with {action = "UpdateExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto]]] UpdateExpenseVoucher(System.Guid, System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.Collections.Generic.List`1[System.Guid]) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:27:04.131 +03:00 [INF] Start updating expense voucher "e619ae16-27e6-4a0b-f67a-08de01aeedfa"
2025-10-02 15:27:04.227 +03:00 [INF]  Deleted file: /uploads/93a0b661-eb09-409d-a3d3-6dcaba5992f4_Hossam-Reda-Tohamy-BackEnd Laravel.pdf
2025-10-02 15:27:04.286 +03:00 [INF]  Processed new attachment: Back End .NET.pdf, Size: 83767 bytes, MimeType: application/pdf
2025-10-02 15:27:04.371 +03:00 [INF] Successfully updated expense voucher "e619ae16-27e6-4a0b-f67a-08de01aeedfa" with 1 attachments
2025-10-02 15:27:04.373 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:27:04.376 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP) in 282.1002ms
2025-10-02 15:27:04.378 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.UpdateExpenseVoucher (ModularERP)'
2025-10-02 15:27:04.382 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:27:04.386 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/ExpenseVouchers/{e619ae16-27e6-4a0b-f67a-08de01aeedfa} - 200 null application/json; charset=utf-8 322.5172ms
2025-10-02 15:27:25.267 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7168/api/ExpenseVouchers/e619ae16-27e6-4a0b-f67a-08de01aeedfa - null null
2025-10-02 15:27:25.272 +03:00 [INF] Request started
2025-10-02 15:27:25.273 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:27:25.274 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.DeleteExpenseVoucher (ModularERP)'
2025-10-02 15:27:25.278 +03:00 [INF] Route matched with {action = "DeleteExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.String]]] DeleteExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:27:25.286 +03:00 [INF] Start deleting expense voucher "e619ae16-27e6-4a0b-f67a-08de01aeedfa"
2025-10-02 15:27:25.316 +03:00 [INF] Deleted physical file: E:\ModelerERP\ModularERP\ModularERP\wwwroot\uploads/bbb37b7b-6c83-4fa2-9db0-1fb82faacdc3_Back End .NET.pdf
2025-10-02 15:27:25.324 +03:00 [INF] Successfully deleted expense voucher "e619ae16-27e6-4a0b-f67a-08de01aeedfa" with 1 tax lines and 1 attachments
2025-10-02 15:27:25.328 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 15:27:25.331 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.DeleteExpenseVoucher (ModularERP) in 49.4714ms
2025-10-02 15:27:25.333 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.DeleteExpenseVoucher (ModularERP)'
2025-10-02 15:27:25.336 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:27:25.338 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7168/api/ExpenseVouchers/e619ae16-27e6-4a0b-f67a-08de01aeedfa - 200 null application/json; charset=utf-8 70.9086ms
2025-10-02 15:28:35.480 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GlAccount - application/json 138
2025-10-02 15:28:35.484 +03:00 [INF] Request started
2025-10-02 15:28:35.485 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:28:35.486 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 15:28:35.490 +03:00 [INF] Route matched with {action = "CreateGlAccount", controller = "GlAccount"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto]]] CreateGlAccount(ModularERP.Modules.Finance.Features.GlAccounts.DTO.CreateGlAccountDto) on controller ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController (ModularERP).
2025-10-02 15:28:35.505 +03:00 [INF] Received request to create GLAccount with Code: GlAccount_103
2025-10-02 15:28:35.517 +03:00 [INF] Starting GLAccount creation process for Code: GlAccount_103, Company: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 15:28:35.547 +03:00 [INF] GLAccount created successfully with ID: "7602a6e7-6608-4277-6dca-08de01af351e", Code: GlAccount_103
2025-10-02 15:28:35.559 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.GlAccounts.DTO.GlAccountResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:28:35.568 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP) in 72.4864ms
2025-10-02 15:28:35.571 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.GlAccounts.Controllers.GlAccountController.CreateGlAccount (ModularERP)'
2025-10-02 15:28:35.573 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 15:28:35.575 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GlAccount - 201 null application/json; charset=utf-8 95.0418ms
2025-10-02 15:29:40.165 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - multipart/form-data; boundary=--------------------------899216658903953676169819 57996
2025-10-02 15:29:40.170 +03:00 [INF] Request started
2025-10-02 15:29:40.172 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 15:29:40.173 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:29:40.179 +03:00 [INF] Route matched with {action = "CreateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] CreateIncomeVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:29:40.244 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.251 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.258 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.263 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.280 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.289 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:29:40.308 +03:00 [INF]  Start Handle CreateIncomeVoucher with Request: {"Code":"INC-100","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"7602a6e7-6608-4277-6dca-08de01af351e","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[\n  {\n    \"TaxProfileId\": \"87a405a7-4547-4ec3-d2c5-08de0191af38\",\n    \"TaxComponentId\": \"d14418b8-daa9-442d-a436-08de01908fd2\",\n    \"BaseAmount\": 100,\n    \"TaxAmount\": 14.0,\n    \"AppliedRate\": 14,\n    \"IsWithholding\": true\n  }\n]\n","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":56007,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-Node Js .pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"$type":"CreateIncomeVoucherDto"}
2025-10-02 15:29:40.352 +03:00 [INF]  Tenant verified: "9df6fad9-79f1-4722-bec3-fc20bb0d5c14"
2025-10-02 15:29:40.358 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:29:40.365 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP) in 179.599ms
2025-10-02 15:29:40.370 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:29:40.374 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 15:29:40.378 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - 400 null application/json; charset=utf-8 212.9546ms
2025-10-02 15:30:26.048 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - multipart/form-data; boundary=--------------------------616658282569381695337770 57996
2025-10-02 15:30:26.053 +03:00 [INF] Request started
2025-10-02 15:30:26.055 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:30:26.056 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:30:26.060 +03:00 [INF] Route matched with {action = "CreateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] CreateIncomeVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:30:26.068 +03:00 [INF]  Start Handle CreateIncomeVoucher with Request: {"Code":"INC-100","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"7602a6e7-6608-4277-6dca-08de01af351e","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[\n  {\n    \"TaxProfileId\": \"87a405a7-4547-4ec3-d2c5-08de0191af38\",\n    \"TaxComponentId\": \"d14418b8-daa9-442d-a436-08de01908fd2\",\n    \"BaseAmount\": 100,\n    \"TaxAmount\": 14.0,\n    \"AppliedRate\": 14,\n    \"IsWithholding\": true\n  }\n]\n","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":56007,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-Node Js .pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"$type":"CreateIncomeVoucherDto"}
2025-10-02 15:30:26.107 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 15:30:26.112 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 15:30:26.115 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:30:26.118 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP) in 55.0259ms
2025-10-02 15:30:26.121 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:30:26.123 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 15:30:26.125 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - 400 null application/json; charset=utf-8 77.4521ms
2025-10-02 15:30:57.847 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:30:57.855 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 8.4206ms
2025-10-02 15:30:57.870 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:30:57.870 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:30:57.874 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 4.5414ms
2025-10-02 15:30:57.888 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 18.3798ms
2025-10-02 15:30:58.315 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:30:58.438 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 123.4125ms
2025-10-02 15:30:59.617 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - multipart/form-data; boundary=--------------------------326577586700495868923092 57996
2025-10-02 15:30:59.622 +03:00 [INF] Request started
2025-10-02 15:30:59.625 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:30:59.626 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:30:59.640 +03:00 [INF] Route matched with {action = "CreateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] CreateIncomeVoucher(System.String, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:30:59.660 +03:00 [INF]  Start Handle CreateIncomeVoucher with Request: {"Code":"INC-100","Date":"2025-09-18T19:22:40.3180000Z","CurrencyCode":"USD","FxRate":1.0,"Amount":500,"Description":"ant","CategoryId":"7602a6e7-6608-4277-6dca-08de01af351e","RecurrenceId":"7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe","SourceJson":"{\"Type\":\"Treasury\",\"Id\":\"1b4004a5-5b15-438b-bfc1-5fd06d9553ec\"}","CounterpartyJson":"{\"Type\":\"Vendor\",\"Id\":\"3fa85f64-5717-4562-b3fc-2c963f66afa6\"}","TaxLinesJson":"[\n  {\n    \"TaxProfileId\": \"87a405a7-4547-4ec3-d2c5-08de0191af38\",\n    \"TaxComponentId\": \"d14418b8-daa9-442d-a436-08de01908fd2\",\n    \"BaseAmount\": 100,\n    \"TaxAmount\": 14.0,\n    \"AppliedRate\": 14,\n    \"IsWithholding\": true\n  }\n]\n","Attachments":[{"ContentDisposition":"form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\"","ContentType":"application/pdf","Headers":[{"Key":"Content-Disposition","Value":["form-data; name=\"Attachments\"; filename=\"Hossam-Reda-Tohamy-Node Js .pdf\""],"$type":"KeyValuePair`2"},{"Key":"Content-Type","Value":["application/pdf"],"$type":"KeyValuePair`2"}],"Length":56007,"Name":"Attachments","FileName":"Hossam-Reda-Tohamy-Node Js .pdf","$type":"FormFile"}],"SourceId":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","SourceType":"Treasury","Source":{"Type":"Treasury","Id":"1b4004a5-5b15-438b-bfc1-5fd06d9553ec","$type":"WalletDto"},"Counterparty":{"Type":"Vendor","Id":"3fa85f64-5717-4562-b3fc-2c963f66afa6","$type":"CounterpartyDto"},"$type":"CreateIncomeVoucherDto"}
2025-10-02 15:30:59.697 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 15:30:59.703 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 15:30:59.706 +03:00 [INF]  Company verified: "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 15:30:59.710 +03:00 [INF]  DTO validation passed
2025-10-02 15:30:59.717 +03:00 [INF]  Business validations passed
2025-10-02 15:30:59.733 +03:00 [INF]  Voucher saved with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:30:59.740 +03:00 [INF]  Saved 1 tax lines
2025-10-02 15:30:59.744 +03:00 [INF]  Processed attachment: Hossam-Reda-Tohamy-Node Js .pdf, Size: 56007 bytes, MimeType: application/pdf
2025-10-02 15:30:59.750 +03:00 [INF]  Saved 1 attachments to database
2025-10-02 15:30:59.769 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:30:59.780 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP) in 136.3541ms
2025-10-02 15:30:59.782 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.CreateIncomeVoucher (ModularERP)'
2025-10-02 15:30:59.785 +03:00 [INF] Request completed successfully with status code 201
2025-10-02 15:30:59.786 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/IncomeVouchers?Code=INC-125468&Date=2025-09-18T19:22:40.318Z&CurrencyCode=EGP&FxRate=1.0&Amount=600&Description=anu&CategoryId=f8cd0c63-50d7-4a69-a344-bc53be110f77&RecurrenceId=7b6fd5d0-11ec-43b6-b9d6-eba78273f3fe - 201 null application/json; charset=utf-8 169.3224ms
2025-10-02 15:31:25.188 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - null null
2025-10-02 15:31:25.194 +03:00 [INF] Request started
2025-10-02 15:31:25.194 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:31:25.196 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:31:25.201 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:31:25.210 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:31:25.215 +03:00 [WRN]  Voucher with ID "1cd6730f-09ed-463a-f67b-08de01aeedfa" is not an expense voucher. Type: "Income"
2025-10-02 15:31:25.218 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:31:25.222 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 16.1705ms
2025-10-02 15:31:25.225 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:31:25.227 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 15:31:25.229 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - 404 null application/json; charset=utf-8 41.2895ms
2025-10-02 15:31:44.763 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - null null
2025-10-02 15:31:44.769 +03:00 [INF] Request started
2025-10-02 15:31:44.770 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:31:44.771 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:31:44.775 +03:00 [INF] Route matched with {action = "GetExpenseVoucher", controller = "ExpenseVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetExpenseVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController (ModularERP).
2025-10-02 15:31:44.780 +03:00 [INF]  Start Handle GetExpenseVoucherById with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:31:44.782 +03:00 [WRN]  Voucher with ID "1cd6730f-09ed-463a-f67b-08de01aeedfa" is not an expense voucher. Type: "Income"
2025-10-02 15:31:44.785 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.ExpensesVoucher.DTO.ExpenseVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:31:44.787 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP) in 9.3236ms
2025-10-02 15:31:44.789 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.ExpensesVoucher.Controllers.ExpenseVouchersController.GetExpenseVoucher (ModularERP)'
2025-10-02 15:31:44.791 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 15:31:44.796 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/ExpenseVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - 404 null application/json; charset=utf-8 32.1508ms
2025-10-02 15:32:17.361 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - null null
2025-10-02 15:32:17.366 +03:00 [INF] Request started
2025-10-02 15:32:17.367 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:32:17.370 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:32:17.377 +03:00 [INF] Route matched with {action = "GetIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] GetIncomeVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:32:17.387 +03:00 [INF] Fetching income voucher with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:32:17.394 +03:00 [INF] Found income voucher: INC-100
2025-10-02 15:32:17.412 +03:00 [INF] Retrieved 1 tax lines and 1 attachments for voucher "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:32:17.418 +03:00 [INF] Successfully retrieved income voucher INC-100 with all related data
2025-10-02 15:32:17.419 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:32:17.422 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP) in 39.1313ms
2025-10-02 15:32:17.425 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:32:17.427 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:32:17.428 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - 200 null application/json; charset=utf-8 66.8367ms
2025-10-02 15:33:32.793 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/a1b25ac8-5d77-4177-35a9-08ddfe0755aa - multipart/form-data; boundary=--------------------------082555155730905210629450 99920
2025-10-02 15:33:32.798 +03:00 [INF] Request started
2025-10-02 15:33:32.800 +03:00 [INF] Processing request for tenant: 9df6fad9-79f1-4722-bec3-fc20bb0d5c14
2025-10-02 15:33:32.802 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:33:32.809 +03:00 [INF] Route matched with {action = "UpdateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] UpdateIncomeVoucher(System.Guid, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.String) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:33:32.863 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.868 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.875 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.880 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.885 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.891 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.901 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:33:32.914 +03:00 [INF]  Start Handle UpdateIncomeVoucher with ID: "a1b25ac8-5d77-4177-35a9-08ddfe0755aa"
2025-10-02 15:33:32.916 +03:00 [INF]  Tenant verified: "9df6fad9-79f1-4722-bec3-fc20bb0d5c14"
2025-10-02 15:33:32.920 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:33:32.924 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP) in 108.9948ms
2025-10-02 15:33:32.927 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:33:32.929 +03:00 [INF] Request completed successfully with status code 400
2025-10-02 15:33:32.932 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/a1b25ac8-5d77-4177-35a9-08ddfe0755aa - 400 null application/json; charset=utf-8 139.0569ms
2025-10-02 15:33:47.931 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/a1b25ac8-5d77-4177-35a9-08ddfe0755aa - multipart/form-data; boundary=--------------------------129882975248485912346296 99920
2025-10-02 15:33:47.936 +03:00 [INF] Request started
2025-10-02 15:33:47.937 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:33:47.939 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:33:47.943 +03:00 [INF] Route matched with {action = "UpdateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] UpdateIncomeVoucher(System.Guid, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.String) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:33:47.950 +03:00 [INF]  Start Handle UpdateIncomeVoucher with ID: "a1b25ac8-5d77-4177-35a9-08ddfe0755aa"
2025-10-02 15:33:47.954 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 15:33:47.958 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 15:33:47.963 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:33:47.965 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP) in 18.8941ms
2025-10-02 15:33:47.969 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:33:47.973 +03:00 [INF] Request completed successfully with status code 404
2025-10-02 15:33:47.976 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/a1b25ac8-5d77-4177-35a9-08ddfe0755aa - 404 null application/json; charset=utf-8 44.5736ms
2025-10-02 15:34:04.876 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - multipart/form-data; boundary=--------------------------969550021631773512134465 99920
2025-10-02 15:34:04.881 +03:00 [INF] Request started
2025-10-02 15:34:04.882 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:34:04.883 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:34:04.885 +03:00 [INF] Route matched with {action = "UpdateIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] UpdateIncomeVoucher(System.Guid, System.DateTime, System.String, System.Decimal, System.Decimal, System.String, System.Guid, System.Nullable`1[System.Guid], System.String, System.Guid, System.String, System.String, System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.String) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:34:04.895 +03:00 [INF]  Start Handle UpdateIncomeVoucher with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:34:04.898 +03:00 [INF]  Tenant verified: "8bed874f-cf2a-4ffa-a188-4cfef779774a"
2025-10-02 15:34:04.901 +03:00 [INF]  User verified: "f0602c31-0c12-4b5c-9ccf-fe17811d5c53"
2025-10-02 15:34:04.905 +03:00 [INF]  Voucher and Company verified: "1cd6730f-09ed-463a-f67b-08de01aeedfa" - "82b0fb02-1282-483c-ae26-c8466423707e"
2025-10-02 15:34:04.909 +03:00 [INF]  DTO validation passed
2025-10-02 15:34:04.915 +03:00 [INF]  Business validations passed
2025-10-02 15:34:04.924 +03:00 [INF]  Voucher updated with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:34:04.937 +03:00 [INF]  Saved 1 tax lines
2025-10-02 15:34:04.941 +03:00 [INF]  Processed attachment: Hossam-Reda-Tohamy-Full Stack NET Angular.pdf, Size: 98003 bytes, MimeType: application/pdf
2025-10-02 15:34:04.949 +03:00 [INF]  Saved 1 new attachments to database
2025-10-02 15:34:04.957 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:34:04.960 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP) in 69.1055ms
2025-10-02 15:34:04.964 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.UpdateIncomeVoucher (ModularERP)'
2025-10-02 15:34:04.966 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:34:04.968 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - 200 null application/json; charset=utf-8 91.4679ms
2025-10-02 15:36:09.479 +03:00 [INF] Starting web host...
2025-10-02 15:36:10.339 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:36:10.379 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-02 15:36:10.512 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:36:10.530 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-02 15:36:10.537 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-02 15:36:10.615 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-02 15:36:10.632 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-02 15:36:10.636 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-02 15:36:10.645 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-02 15:36:10.659 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-02 15:36:10.663 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-02 15:36:10.854 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-02 15:36:10.863 +03:00 [INF] Master database initialized successfully
2025-10-02 15:36:12.241 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 15:36:12.361 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-02 15:36:12.363 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-02 15:36:12.462 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 15:36:12.531 +03:00 [INF] Hosting environment: Development
2025-10-02 15:36:12.533 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-02 15:36:12.908 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-02 15:36:13.043 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 135.3851ms
2025-10-02 15:36:13.044 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 15:36:13.044 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-02 15:36:13.061 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 16.4543ms
2025-10-02 15:36:13.087 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.7615ms
2025-10-02 15:36:13.270 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-02 15:36:13.353 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 82.4081ms
2025-10-02 15:36:14.716 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - null null
2025-10-02 15:36:14.732 +03:00 [INF] Request started
2025-10-02 15:36:14.738 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:36:14.741 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:36:14.758 +03:00 [INF] Route matched with {action = "GetIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] GetIncomeVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:36:14.764 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:36:14.825 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-02 15:36:15.094 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-02 15:36:15.098 +03:00 [INF] Fetching income voucher with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:36:15.207 +03:00 [INF] Found income voucher: INC-100
2025-10-02 15:36:15.360 +03:00 [INF] Retrieved 1 tax lines and 2 attachments for voucher "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:36:15.376 +03:00 [INF] Successfully retrieved income voucher INC-100 with all related data
2025-10-02 15:36:15.384 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:36:15.416 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP) in 651.2374ms
2025-10-02 15:36:15.419 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:36:15.421 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:36:15.426 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/1cd6730f-09ed-463a-f67b-08de01aeedfa - 200 null application/json; charset=utf-8 710.2576ms
2025-10-02 15:37:27.090 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/TaxProfile - null null
2025-10-02 15:37:27.096 +03:00 [INF] Request started
2025-10-02 15:37:27.100 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:37:27.102 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetAll (ModularERP)'
2025-10-02 15:37:27.106 +03:00 [INF] Route matched with {action = "GetAll", controller = "TaxProfile"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto]]]] GetAll() on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController (ModularERP).
2025-10-02 15:37:27.133 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxProfileDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 15:37:27.141 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetAll (ModularERP) in 31.9833ms
2025-10-02 15:37:27.145 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxProfileController.GetAll (ModularERP)'
2025-10-02 15:37:27.147 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:37:27.150 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/TaxProfile - 200 null application/json; charset=utf-8 59.1531ms
2025-10-02 15:37:47.479 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/TaxComponent - null null
2025-10-02 15:37:47.484 +03:00 [INF] Request started
2025-10-02 15:37:47.485 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:37:47.486 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP)'
2025-10-02 15:37:47.492 +03:00 [INF] Route matched with {action = "GetAll", controller = "TaxComponent"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto]]]] GetAll() on controller ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController (ModularERP).
2025-10-02 15:37:47.513 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.TaxManagement.DTO.TaxComponentDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 15:37:47.521 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP) in 25.118ms
2025-10-02 15:37:47.526 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.TaxManagement.Controllers.TaxComponentController.GetAll (ModularERP)'
2025-10-02 15:37:47.529 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:37:47.530 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/TaxComponent - 200 null application/json; charset=utf-8 50.8891ms
2025-10-02 15:40:07.509 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/{1cd6730f-09ed-463a-f67b-08de01aeedfa} - null null
2025-10-02 15:40:07.514 +03:00 [INF] Request started
2025-10-02 15:40:07.516 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-02 15:40:07.517 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:40:07.520 +03:00 [INF] Route matched with {action = "GetIncomeVoucher", controller = "IncomeVouchers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto]]] GetIncomeVoucher(System.Guid) on controller ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController (ModularERP).
2025-10-02 15:40:07.527 +03:00 [INF] Fetching income voucher with ID: "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:40:07.534 +03:00 [INF] Found income voucher: INC-100
2025-10-02 15:40:07.545 +03:00 [INF] Retrieved 1 tax lines and 2 attachments for voucher "1cd6730f-09ed-463a-f67b-08de01aeedfa"
2025-10-02 15:40:07.548 +03:00 [INF] Successfully retrieved income voucher INC-100 with all related data
2025-10-02 15:40:07.550 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Finance.Features.IncomesVoucher.DTO.IncomeVoucherResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 15:40:07.553 +03:00 [INF] Executed action ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP) in 29.7096ms
2025-10-02 15:40:07.555 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Finance.Features.IncomesVoucher.Controllers.IncomeVouchersController.GetIncomeVoucher (ModularERP)'
2025-10-02 15:40:07.556 +03:00 [INF] Request completed successfully with status code 200
2025-10-02 15:40:07.560 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/IncomeVouchers/{1cd6730f-09ed-463a-f67b-08de01aeedfa} - 200 null application/json; charset=utf-8 50.9073ms
