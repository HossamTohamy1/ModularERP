2025-11-16 17:11:35.287 +02:00 [INF] Starting web host...
2025-11-16 17:11:42.413 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 17:11:42.465 +02:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 17:11:42.569 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 17:11:42.574 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 17:11:42.780 +02:00 [INF] Executed DbCommand (203ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 17:11:43.006 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 17:11:43.022 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 17:11:43.026 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 17:11:43.046 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 17:11:43.059 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 17:11:43.064 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 17:11:43.317 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 17:11:43.329 +02:00 [INF] Master database initialized successfully
2025-11-16 17:11:46.240 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 17:11:46.505 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 17:11:46.506 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 17:11:46.631 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 17:11:46.634 +02:00 [INF] Hosting environment: Development
2025-11-16 17:11:46.636 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 17:11:47.338 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 17:11:47.588 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 251.3188ms
2025-11-16 17:11:47.629 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 17:11:47.634 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 17:11:47.638 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.4959ms
2025-11-16 17:11:47.718 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 83.9752ms
2025-11-16 17:11:47.784 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 17:11:48.123 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 339.4187ms
2025-11-16 17:51:22.376 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 17:51:22.402 +02:00 [INF] Request started
2025-11-16 17:51:22.405 +02:00 [INF] === Incoming Request ===
2025-11-16 17:51:22.407 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 17:51:22.407 +02:00 [INF] Method: GET
2025-11-16 17:51:22.408 +02:00 [INF] === Headers ===
2025-11-16 17:51:22.411 +02:00 [INF] Accept: ["*/*"]
2025-11-16 17:51:22.415 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 17:51:22.417 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 17:51:22.418 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 17:51:22.419 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 17:51:22.421 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 17:51:22.422 +02:00 [INF] Content-Length: ["515"]
2025-11-16 17:51:22.424 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 17:51:22.425 +02:00 [INF] Postman-Token: ["123a6ecb-95ee-4929-8fa4-30294477409b"]
2025-11-16 17:51:22.429 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 17:51:22.431 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 17:51:22.433 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 17:51:22.461 +02:00 [INF] Route matched with {action = "GetAllGRNs", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGRNs(System.Guid, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 17:51:22.468 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 17:51:22.518 +02:00 [INF] API: Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 17:51:22.653 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 17:51:22.734 +02:00 [INF] Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 17:51:22.849 +02:00 [INF] Retrieved 0 GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 17:51:22.857 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNListItemDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 17:51:22.883 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP) in 414.9771ms
2025-11-16 17:51:22.886 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 17:51:22.887 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 17:51:22.893 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 517.0544ms
2025-11-16 18:03:46.071 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 18:03:46.083 +02:00 [INF] Request started
2025-11-16 18:03:46.085 +02:00 [INF] === Incoming Request ===
2025-11-16 18:03:46.087 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:03:46.088 +02:00 [INF] Method: POST
2025-11-16 18:03:46.089 +02:00 [INF] === Headers ===
2025-11-16 18:03:46.090 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:03:46.091 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:03:46.092 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:03:46.094 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:03:46.095 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:03:46.097 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 18:03:46.098 +02:00 [INF] Content-Length: ["515"]
2025-11-16 18:03:46.100 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:03:46.101 +02:00 [INF] Postman-Token: ["69acfa95-fabb-44a6-b169-bdcf9e0514b9"]
2025-11-16 18:03:46.105 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:03:46.106 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:03:46.107 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:03:46.113 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:03:46.137 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:03:46.763 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:03:46.768 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:03:46.790 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.NotFoundException: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 46
2025-11-16 18:03:46.845 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 730.1506ms
2025-11-16 18:03:46.849 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:03:46.852 +02:00 [ERR] Application exception occurred: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
ModularERP.Common.Exceptions.NotFoundException: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 46
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 18:03:46.881 +02:00 [INF] Error response sent with status code 404
2025-11-16 18:03:46.883 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 404 null application/json; charset=utf-8 812.3751ms
2025-11-16 18:08:39.931 +02:00 [INF] Starting web host...
2025-11-16 18:08:41.392 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:08:41.432 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 18:08:41.506 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:08:41.511 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 18:08:41.516 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 18:08:41.581 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 18:08:41.596 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:08:41.603 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 18:08:41.610 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 18:08:41.620 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 18:08:41.625 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 18:08:41.792 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 18:08:41.798 +02:00 [INF] Master database initialized successfully
2025-11-16 18:08:43.740 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 18:08:43.856 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 18:08:43.859 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 18:08:43.945 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 18:08:43.952 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 18:08:43.954 +02:00 [INF] Hosting environment: Development
2025-11-16 18:08:43.956 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 18:08:44.087 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 143.0496ms
2025-11-16 18:08:44.101 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 18:08:44.101 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 18:08:44.108 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.6888ms
2025-11-16 18:08:44.137 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 35.6908ms
2025-11-16 18:08:44.318 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 18:08:44.643 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 324.9241ms
2025-11-16 18:08:52.049 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 18:08:52.066 +02:00 [INF] Request started
2025-11-16 18:08:52.069 +02:00 [INF] === Incoming Request ===
2025-11-16 18:08:52.072 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:08:52.073 +02:00 [INF] Method: POST
2025-11-16 18:08:52.074 +02:00 [INF] === Headers ===
2025-11-16 18:08:52.077 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:08:52.080 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:08:52.081 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:08:52.084 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:08:52.085 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:08:52.088 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 18:08:52.091 +02:00 [INF] Content-Length: ["515"]
2025-11-16 18:08:52.094 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:08:52.096 +02:00 [INF] Postman-Token: ["050b9b5a-b51f-400c-be06-3d8c68cd6242"]
2025-11-16 18:08:52.101 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:08:52.102 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:08:52.104 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:08:52.119 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:08:52.125 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:08:52.154 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:08:52.210 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 18:08:52.711 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:08:52.715 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:08:52.732 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.NotFoundException: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 46
2025-11-16 18:08:52.745 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 619.7438ms
2025-11-16 18:08:52.748 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:08:52.752 +02:00 [ERR] Application exception occurred: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
ModularERP.Common.Exceptions.NotFoundException: Purchase Order with ID c9419c66-ab1f-4857-a967-37221b235ea5 not found
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 46
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 18:08:52.786 +02:00 [INF] Error response sent with status code 404
2025-11-16 18:08:52.792 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 404 null application/json; charset=utf-8 742.7824ms
2025-11-16 18:12:43.155 +02:00 [INF] Starting web host...
2025-11-16 18:12:44.500 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:12:44.540 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 18:12:44.621 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:12:44.626 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 18:12:44.630 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 18:12:44.689 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 18:12:44.705 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:12:44.710 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 18:12:44.716 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 18:12:44.729 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 18:12:44.734 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 18:12:44.890 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 18:12:44.900 +02:00 [INF] Master database initialized successfully
2025-11-16 18:12:46.883 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 18:12:46.990 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 18:12:46.992 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 18:12:47.076 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 18:12:47.078 +02:00 [INF] Hosting environment: Development
2025-11-16 18:12:47.079 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 18:12:47.366 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 18:12:47.517 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 152.0087ms
2025-11-16 18:12:47.519 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 18:12:47.520 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 18:12:47.532 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.5816ms
2025-11-16 18:12:47.553 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.4667ms
2025-11-16 18:12:47.697 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 18:12:48.003 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 305.8297ms
2025-11-16 18:12:51.789 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 18:12:51.812 +02:00 [INF] Request started
2025-11-16 18:12:51.814 +02:00 [INF] === Incoming Request ===
2025-11-16 18:12:51.816 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:12:51.817 +02:00 [INF] Method: POST
2025-11-16 18:12:51.819 +02:00 [INF] === Headers ===
2025-11-16 18:12:51.823 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:12:51.826 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:12:51.828 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:12:51.830 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:12:51.832 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:12:51.835 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 18:12:51.837 +02:00 [INF] Content-Length: ["515"]
2025-11-16 18:12:51.840 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:12:51.842 +02:00 [INF] Postman-Token: ["78a7e369-a5df-43e6-869e-e1c3a72d3039"]
2025-11-16 18:12:51.847 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:12:51.848 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:12:51.852 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:12:51.881 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:12:51.889 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:12:51.943 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:12:52.007 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 18:12:52.692 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:12:52.697 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:12:52.714 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
System.NullReferenceException: Object reference not set to an instance of an object.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 43
2025-11-16 18:12:52.758 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 869.6386ms
2025-11-16 18:12:52.760 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:12:52.763 +02:00 [ERR] Unexpected error occurred
System.NullReferenceException: Object reference not set to an instance of an object.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 43
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 18:12:52.828 +02:00 [INF] Error response sent with status code 500
2025-11-16 18:12:52.835 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 500 null application/json; charset=utf-8 1045.926ms
2025-11-16 18:14:17.043 +02:00 [INF] Starting web host...
2025-11-16 18:14:18.323 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:14:18.363 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 18:14:18.431 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:14:18.437 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 18:14:18.441 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 18:14:18.501 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 18:14:18.516 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:14:18.521 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 18:14:18.526 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 18:14:18.537 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 18:14:18.542 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 18:14:18.704 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 18:14:18.712 +02:00 [INF] Master database initialized successfully
2025-11-16 18:14:20.667 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 18:14:20.783 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 18:14:20.786 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 18:14:20.878 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 18:14:20.880 +02:00 [INF] Hosting environment: Development
2025-11-16 18:14:20.881 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 18:14:20.929 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 18:14:21.087 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 157.6188ms
2025-11-16 18:14:21.122 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 18:14:21.122 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 18:14:21.130 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.5492ms
2025-11-16 18:14:21.358 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 236.4584ms
2025-11-16 18:14:21.448 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 18:14:21.911 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 463.057ms
2025-11-16 18:14:30.321 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 18:14:30.341 +02:00 [INF] Request started
2025-11-16 18:14:30.344 +02:00 [INF] === Incoming Request ===
2025-11-16 18:14:30.346 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:14:30.347 +02:00 [INF] Method: POST
2025-11-16 18:14:30.348 +02:00 [INF] === Headers ===
2025-11-16 18:14:30.352 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:14:30.357 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:14:30.358 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:14:30.360 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:14:30.361 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:14:30.364 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 18:14:30.366 +02:00 [INF] Content-Length: ["515"]
2025-11-16 18:14:30.368 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:14:30.369 +02:00 [INF] Postman-Token: ["c8cae565-7c38-4a4d-94d1-a04bdfd60448"]
2025-11-16 18:14:30.375 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:14:30.376 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:14:30.378 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:14:30.395 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:14:30.402 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:14:30.432 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:14:30.489 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 18:14:31.035 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:14:31.041 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:14:31.042 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
System.NullReferenceException: Object reference not set to an instance of an object.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 43
2025-11-16 18:14:31.083 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 681.6819ms
2025-11-16 18:14:31.086 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:14:31.090 +02:00 [ERR] Unexpected error occurred
System.NullReferenceException: Object reference not set to an instance of an object.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 43
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 18:14:31.128 +02:00 [INF] Error response sent with status code 500
2025-11-16 18:14:31.134 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 500 null application/json; charset=utf-8 812.5842ms
2025-11-16 18:15:19.080 +02:00 [INF] Starting web host...
2025-11-16 18:15:20.495 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:15:20.538 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 18:15:20.609 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:15:20.614 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 18:15:20.620 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 18:15:20.676 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 18:15:20.692 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 18:15:20.695 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 18:15:20.702 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 18:15:20.714 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 18:15:20.719 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 18:15:20.895 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 18:15:20.902 +02:00 [INF] Master database initialized successfully
2025-11-16 18:15:22.843 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 18:15:22.952 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 18:15:22.955 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 18:15:23.011 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 18:15:23.062 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 18:15:23.064 +02:00 [INF] Hosting environment: Development
2025-11-16 18:15:23.065 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 18:15:23.152 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 141.1159ms
2025-11-16 18:15:23.192 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 18:15:23.192 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 18:15:23.201 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.7627ms
2025-11-16 18:15:23.220 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.3709ms
2025-11-16 18:15:23.256 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 18:15:23.581 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 325.5802ms
2025-11-16 18:15:26.069 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 18:15:26.084 +02:00 [INF] Request started
2025-11-16 18:15:26.088 +02:00 [INF] === Incoming Request ===
2025-11-16 18:15:26.089 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:15:26.090 +02:00 [INF] Method: POST
2025-11-16 18:15:26.091 +02:00 [INF] === Headers ===
2025-11-16 18:15:26.094 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:15:26.096 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:15:26.099 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:15:26.100 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:15:26.102 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:15:26.104 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 18:15:26.105 +02:00 [INF] Content-Length: ["515"]
2025-11-16 18:15:26.108 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:15:26.110 +02:00 [INF] Postman-Token: ["44922bd8-2de4-4e6e-8d4d-408d41b6d408"]
2025-11-16 18:15:26.114 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:15:26.116 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:15:26.119 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:15:26.135 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:15:26.141 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:15:26.169 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:15:26.223 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 18:15:26.807 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 18:15:26.812 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 18:15:27.194 +02:00 [INF] GRN created successfully with number: GRN-2025-00001
2025-11-16 18:15:27.336 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 18:15:27.366 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 1223.7984ms
2025-11-16 18:15:27.370 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 18:15:27.373 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 18:15:27.382 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 1313.5043ms
2025-11-16 18:22:09.167 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - null null
2025-11-16 18:22:09.181 +02:00 [INF] Request started
2025-11-16 18:22:09.182 +02:00 [INF] === Incoming Request ===
2025-11-16 18:22:09.184 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:22:09.185 +02:00 [INF] Method: GET
2025-11-16 18:22:09.188 +02:00 [INF] === Headers ===
2025-11-16 18:22:09.189 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:22:09.191 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:22:09.192 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:22:09.194 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:22:09.195 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:22:09.198 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:22:09.201 +02:00 [INF] Postman-Token: ["e6bfa3c4-8b05-4df5-97ba-a3782793e270"]
2025-11-16 18:22:09.205 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:22:09.207 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:22:09.208 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 18:22:09.215 +02:00 [INF] Route matched with {action = "GetAllGRNs", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGRNs(System.Guid, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:22:09.222 +02:00 [INF] API: Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 18:22:09.227 +02:00 [INF] Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 18:22:09.288 +02:00 [INF] Retrieved 0 GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 18:22:09.290 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNListItemDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 18:22:09.294 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP) in 73.9832ms
2025-11-16 18:22:09.296 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 18:22:09.300 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 18:22:09.301 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 134.3096ms
2025-11-16 18:23:58.897 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts?CompanyId=90137c92-382d-404c-bade-e5fefb1e8dbf&warehouseId=e5d0bbaa-9099-43e1-bb16-f9744078a9ea&purchaseOrderId=c9419c66-ab1f-4857-a967-37221b235ea5 - null null
2025-11-16 18:23:58.903 +02:00 [INF] Request started
2025-11-16 18:23:58.904 +02:00 [INF] === Incoming Request ===
2025-11-16 18:23:58.905 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 18:23:58.906 +02:00 [INF] Method: GET
2025-11-16 18:23:58.908 +02:00 [INF] === Headers ===
2025-11-16 18:23:58.909 +02:00 [INF] Accept: ["*/*"]
2025-11-16 18:23:58.911 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 18:23:58.913 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 18:23:58.914 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 18:23:58.916 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 18:23:58.918 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 18:23:58.920 +02:00 [INF] Postman-Token: ["974b48f8-457c-4f4f-850d-c28f68f4d781"]
2025-11-16 18:23:58.921 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 18:23:58.923 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 18:23:58.924 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 18:23:58.925 +02:00 [INF] Route matched with {action = "GetAllGRNs", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGRNs(System.Guid, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 18:23:58.934 +02:00 [INF] API: Fetching all GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 18:23:58.939 +02:00 [INF] Fetching all GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 18:23:58.956 +02:00 [INF] Retrieved 1 GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 18:23:58.958 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNListItemDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 18:23:58.962 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP) in 30.6576ms
2025-11-16 18:23:58.964 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 18:23:58.967 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 18:23:58.968 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts?CompanyId=90137c92-382d-404c-bade-e5fefb1e8dbf&warehouseId=e5d0bbaa-9099-43e1-bb16-f9744078a9ea&purchaseOrderId=c9419c66-ab1f-4857-a967-37221b235ea5 - 200 null application/json; charset=utf-8 71.378ms
2025-11-16 19:01:58.425 +02:00 [INF] Starting web host...
2025-11-16 19:02:00.097 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:02:00.159 +02:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:02:00.235 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:02:00.241 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:02:00.246 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:02:00.299 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:02:00.315 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:02:00.319 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:02:00.325 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:02:00.338 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:02:00.341 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:02:00.505 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:02:00.513 +02:00 [INF] Master database initialized successfully
2025-11-16 19:02:02.520 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:02:02.630 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:02:02.631 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:02:02.716 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:02:02.717 +02:00 [INF] Hosting environment: Development
2025-11-16 19:02:02.718 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:02:02.806 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:02:02.952 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 146.9557ms
2025-11-16 19:02:02.953 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:02:02.953 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:02:02.969 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 16.355ms
2025-11-16 19:02:03.016 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 63.1306ms
2025-11-16 19:02:03.145 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:02:03.385 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 239.9667ms
2025-11-16 19:02:12.063 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 515
2025-11-16 19:02:12.084 +02:00 [INF] Request started
2025-11-16 19:02:12.087 +02:00 [INF] === Incoming Request ===
2025-11-16 19:02:12.089 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:02:12.091 +02:00 [INF] Method: POST
2025-11-16 19:02:12.092 +02:00 [INF] === Headers ===
2025-11-16 19:02:12.096 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:02:12.100 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:02:12.101 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:02:12.103 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:02:12.105 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:02:12.108 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:02:12.111 +02:00 [INF] Content-Length: ["515"]
2025-11-16 19:02:12.114 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:02:12.115 +02:00 [INF] Postman-Token: ["dd996165-403a-42a7-8460-86cbe68ebe92"]
2025-11-16 19:02:12.119 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:02:12.121 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:02:12.125 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:02:12.146 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:02:12.153 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:02:12.188 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:02:12.249 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:02:12.924 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:02:12.930 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:02:13.079 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 25 units of  Product. Only 5.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 102
2025-11-16 19:02:13.118 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 965.6914ms
2025-11-16 19:02:13.121 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:02:13.126 +02:00 [WRN] Business logic exception occurred: Cannot receive 25 units of  Product. Only 5.000 units pending.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 25 units of  Product. Only 5.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 102
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:02:13.163 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:02:13.169 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 1105.4925ms
2025-11-16 19:02:26.519 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:02:26.530 +02:00 [INF] Request started
2025-11-16 19:02:26.531 +02:00 [INF] === Incoming Request ===
2025-11-16 19:02:26.532 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:02:26.533 +02:00 [INF] Method: POST
2025-11-16 19:02:26.535 +02:00 [INF] === Headers ===
2025-11-16 19:02:26.536 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:02:26.539 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:02:26.540 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:02:26.542 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:02:26.544 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:02:26.546 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:02:26.547 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:02:26.550 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:02:26.556 +02:00 [INF] Postman-Token: ["e2f46d57-6ad6-46bb-8f2c-a5060f6a6d9b"]
2025-11-16 19:02:26.561 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:02:26.561 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:02:26.563 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:02:26.564 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:02:26.572 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:02:26.576 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:02:27.002 +02:00 [INF] GRN created successfully with number: GRN-2025-00002
2025-11-16 19:02:27.082 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:02:27.100 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 528.8181ms
2025-11-16 19:02:27.180 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:02:27.183 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:02:27.185 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 666.3012ms
2025-11-16 19:07:25.777 +02:00 [INF] Starting web host...
2025-11-16 19:07:27.098 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:07:27.147 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:07:27.223 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:07:27.229 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:07:27.233 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:07:27.291 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:07:27.307 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:07:27.311 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:07:27.317 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:07:27.330 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:07:27.334 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:07:27.492 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:07:27.501 +02:00 [INF] Master database initialized successfully
2025-11-16 19:07:29.494 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:07:29.604 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:07:29.606 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:07:29.691 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:07:29.693 +02:00 [INF] Hosting environment: Development
2025-11-16 19:07:29.694 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:07:30.138 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:07:30.260 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 123.0457ms
2025-11-16 19:07:30.420 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:07:30.420 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:07:30.430 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.9316ms
2025-11-16 19:07:30.444 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.0041ms
2025-11-16 19:07:30.488 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:07:30.738 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 250.7573ms
2025-11-16 19:07:39.415 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:07:39.430 +02:00 [INF] Request started
2025-11-16 19:07:39.433 +02:00 [INF] === Incoming Request ===
2025-11-16 19:07:39.436 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:07:39.437 +02:00 [INF] Method: POST
2025-11-16 19:07:39.438 +02:00 [INF] === Headers ===
2025-11-16 19:07:39.440 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:07:39.444 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:07:39.445 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:07:39.446 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:07:39.449 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:07:39.451 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:07:39.453 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:07:39.455 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:07:39.456 +02:00 [INF] Postman-Token: ["ef744d75-28e9-45d2-aab0-d2843525f9f7"]
2025-11-16 19:07:39.460 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:07:39.461 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:07:39.466 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:07:39.482 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:07:39.488 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:07:39.516 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:07:39.572 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:07:40.149 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:07:40.155 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:07:40.175 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 69
2025-11-16 19:07:40.196 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 707.526ms
2025-11-16 19:07:40.200 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:07:40.203 +02:00 [WRN] Business logic exception occurred: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 69
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:07:40.237 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:07:40.243 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 827.6651ms
2025-11-16 19:08:06.008 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:08:06.017 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 8.815ms
2025-11-16 19:08:06.027 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:08:06.027 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:08:06.031 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 4.5974ms
2025-11-16 19:08:06.042 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 15.1993ms
2025-11-16 19:08:06.101 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:08:06.314 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 212.5795ms
2025-11-16 19:08:15.751 +02:00 [INF] Starting web host...
2025-11-16 19:08:17.218 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:08:17.261 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:08:17.352 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:08:17.358 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:08:17.363 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:08:17.427 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:08:17.443 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:08:17.448 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:08:17.455 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:08:17.467 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:08:17.472 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:08:17.681 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:08:17.688 +02:00 [INF] Master database initialized successfully
2025-11-16 19:08:19.729 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:08:19.832 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:08:19.834 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:08:19.918 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:08:19.920 +02:00 [INF] Hosting environment: Development
2025-11-16 19:08:19.921 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:08:20.269 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:08:20.409 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 141.6356ms
2025-11-16 19:08:20.450 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:08:20.450 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:08:20.456 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.4989ms
2025-11-16 19:08:20.476 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.0217ms
2025-11-16 19:08:20.506 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:08:20.755 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 248.9545ms
2025-11-16 19:08:39.609 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:08:39.625 +02:00 [INF] Request started
2025-11-16 19:08:39.628 +02:00 [INF] === Incoming Request ===
2025-11-16 19:08:39.631 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:08:39.632 +02:00 [INF] Method: POST
2025-11-16 19:08:39.634 +02:00 [INF] === Headers ===
2025-11-16 19:08:39.636 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:08:39.640 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:08:39.641 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:08:39.643 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:08:39.645 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:08:39.649 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:08:39.650 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:08:39.652 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:08:39.653 +02:00 [INF] Postman-Token: ["2c9031d0-9ad0-4c09-9ff8-a6b68683c055"]
2025-11-16 19:08:39.657 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:08:39.659 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:08:39.661 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:08:39.676 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:08:39.684 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:08:39.713 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:08:39.770 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:08:40.339 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:08:40.345 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:08:40.366 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 69
2025-11-16 19:08:40.383 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 698.3766ms
2025-11-16 19:08:40.385 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:08:40.389 +02:00 [WRN] Business logic exception occurred: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot create GRN for a Purchase Order in Draft status. Please approve the PO first.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 69
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:08:40.419 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:08:40.425 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 815.5069ms
2025-11-16 19:11:02.990 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - null 0
2025-11-16 19:11:03.003 +02:00 [INF] Request started
2025-11-16 19:11:03.005 +02:00 [INF] === Incoming Request ===
2025-11-16 19:11:03.006 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/submit
2025-11-16 19:11:03.007 +02:00 [INF] Method: POST
2025-11-16 19:11:03.008 +02:00 [INF] === Headers ===
2025-11-16 19:11:03.009 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:11:03.012 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:11:03.017 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:11:03.018 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:11:03.019 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:11:03.022 +02:00 [INF] Content-Length: ["0"]
2025-11-16 19:11:03.023 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:11:03.025 +02:00 [INF] Postman-Token: ["e8a22ec6-4789-4af7-b81b-f3a5e8fdb49b"]
2025-11-16 19:11:03.028 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:11:03.032 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:11:03.034 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:11:03.039 +02:00 [INF] Route matched with {action = "SubmitPurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SubmitPurchaseOrder(System.Guid, SubmitPurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:11:03.058 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-16 19:11:03.072 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP) in 29.1414ms
2025-11-16 19:11:03.075 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:11:03.077 +02:00 [INF] Request completed successfully with status code 415
2025-11-16 19:11:03.080 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - 415 null application/problem+json; charset=utf-8 89.3558ms
2025-11-16 19:12:45.213 +02:00 [INF] Starting web host...
2025-11-16 19:12:46.709 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:12:46.749 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:12:46.819 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:12:46.826 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:12:46.831 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:12:46.885 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:12:46.901 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:12:46.905 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:12:46.911 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:12:46.922 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:12:46.926 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:12:47.088 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:12:47.094 +02:00 [INF] Master database initialized successfully
2025-11-16 19:12:49.001 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:12:49.107 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:12:49.109 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:12:49.187 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:12:49.216 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:12:49.218 +02:00 [INF] Hosting environment: Development
2025-11-16 19:12:49.218 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:12:49.334 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 147.3962ms
2025-11-16 19:12:49.340 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:12:49.340 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:12:49.354 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 13.6668ms
2025-11-16 19:12:49.426 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 85.3937ms
2025-11-16 19:12:49.471 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:12:49.731 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 260.4931ms
2025-11-16 19:13:42.917 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - null 0
2025-11-16 19:13:42.934 +02:00 [INF] Request started
2025-11-16 19:13:42.936 +02:00 [INF] === Incoming Request ===
2025-11-16 19:13:42.938 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/approve
2025-11-16 19:13:42.939 +02:00 [INF] Method: POST
2025-11-16 19:13:42.940 +02:00 [INF] === Headers ===
2025-11-16 19:13:42.942 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:13:42.945 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:13:42.946 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:13:42.948 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:13:42.949 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:13:42.950 +02:00 [INF] Content-Length: ["0"]
2025-11-16 19:13:42.952 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:13:42.953 +02:00 [INF] Postman-Token: ["860077a8-a02b-4d95-9302-1e006f516871"]
2025-11-16 19:13:42.957 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:13:42.959 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:13:42.961 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:13:42.976 +02:00 [INF] Route matched with {action = "ApprovePurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApprovePurchaseOrder(System.Guid, ApprovePurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:13:42.982 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:13:42.994 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-16 19:13:43.012 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP) in 31.0159ms
2025-11-16 19:13:43.016 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:13:43.017 +02:00 [INF] Request completed successfully with status code 415
2025-11-16 19:13:43.020 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - 415 null application/problem+json; charset=utf-8 102.549ms
2025-11-16 19:17:56.427 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - application/json 90
2025-11-16 19:17:56.441 +02:00 [INF] Request started
2025-11-16 19:17:56.443 +02:00 [INF] === Incoming Request ===
2025-11-16 19:17:56.444 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/approve
2025-11-16 19:17:56.445 +02:00 [INF] Method: POST
2025-11-16 19:17:56.447 +02:00 [INF] === Headers ===
2025-11-16 19:17:56.448 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:17:56.449 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:17:56.450 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:17:56.452 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:17:56.453 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:17:56.455 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:17:56.456 +02:00 [INF] Content-Length: ["90"]
2025-11-16 19:17:56.458 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:17:56.460 +02:00 [INF] Postman-Token: ["8fb895f1-d43c-4058-a2c1-7b026b38283e"]
2025-11-16 19:17:56.464 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:17:56.465 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:17:56.467 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:17:56.468 +02:00 [INF] Route matched with {action = "ApprovePurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApprovePurchaseOrder(System.Guid, ApprovePurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:17:56.582 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:17:56.633 +02:00 [INF] Approving purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:17:56.770 +02:00 [ERR] Error approving purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Only purchase orders in Submitted status can be approved
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_PurchaseOrder.ApprovePurchaseOrderHandler.Handle(ApprovePurchaseOrderCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_PurchaseOrder\ApprovePurchaseOrderHandler.cs:line 42
2025-11-16 19:17:56.785 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP) in 313.374ms
2025-11-16 19:17:56.786 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:17:56.804 +02:00 [WRN] Business logic exception occurred: Only purchase orders in Submitted status can be approved
ModularERP.Common.Exceptions.BusinessLogicException: Only purchase orders in Submitted status can be approved
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_PurchaseOrder.ApprovePurchaseOrderHandler.Handle(ApprovePurchaseOrderCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_PurchaseOrder\ApprovePurchaseOrderHandler.cs:line 42
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder(Guid id, ApprovePurchaseOrderRequest request) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\PurchaseOrderController.cs:line 123
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:17:56.829 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:17:56.834 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - 400 null application/json; charset=utf-8 406.7593ms
2025-11-16 19:19:19.476 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - application/json 61
2025-11-16 19:19:19.481 +02:00 [INF] Request started
2025-11-16 19:19:19.482 +02:00 [INF] === Incoming Request ===
2025-11-16 19:19:19.483 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/submit
2025-11-16 19:19:19.485 +02:00 [INF] Method: POST
2025-11-16 19:19:19.486 +02:00 [INF] === Headers ===
2025-11-16 19:19:19.488 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:19:19.489 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:19:19.491 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:19:19.492 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:19:19.493 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:19:19.495 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:19:19.496 +02:00 [INF] Content-Length: ["61"]
2025-11-16 19:19:19.497 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:19:19.499 +02:00 [INF] Postman-Token: ["d8a662a2-346e-45c1-a676-d61b2ffe8a0e"]
2025-11-16 19:19:19.500 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:19:19.502 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:19:19.503 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:19:19.508 +02:00 [INF] Route matched with {action = "SubmitPurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SubmitPurchaseOrder(System.Guid, SubmitPurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:19:19.556 +02:00 [INF] Submitting purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:19:19.689 +02:00 [ERR] Error submitting purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_PurchaseOrders_AspNetUsers_SubmittedBy". The conflict occurred in database "ModularERP_Tenant_ac68e928aa8044b69ff2ed99d02196e4", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b0481802-e673-402d-ad5e-71a65e821b29
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 2530
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 157
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_PurchaseOrder.SubmitPurchaseOrderHandler.Handle(SubmitPurchaseOrderCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_PurchaseOrder\SubmitPurchaseOrderHandler.cs:line 52
2025-11-16 19:19:19.723 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP) in 211.2938ms
2025-11-16 19:19:19.724 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:19:19.726 +02:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The UPDATE statement conflicted with the FOREIGN KEY constraint "FK_PurchaseOrders_AspNetUsers_SubmittedBy". The conflict occurred in database "ModularERP_Tenant_ac68e928aa8044b69ff2ed99d02196e4", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b0481802-e673-402d-ad5e-71a65e821b29
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 2530
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 157
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_PurchaseOrder.SubmitPurchaseOrderHandler.Handle(SubmitPurchaseOrderCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_PurchaseOrder\SubmitPurchaseOrderHandler.cs:line 52
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder(Guid id, SubmitPurchaseOrderRequest request) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\PurchaseOrderController.cs:line 105
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:19:19.750 +02:00 [INF] Error response sent with status code 500
2025-11-16 19:19:19.751 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - 500 null application/json; charset=utf-8 275.1774ms
2025-11-16 19:19:27.641 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - application/json 61
2025-11-16 19:19:27.644 +02:00 [INF] Request started
2025-11-16 19:19:27.646 +02:00 [INF] === Incoming Request ===
2025-11-16 19:19:27.647 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/submit
2025-11-16 19:19:27.649 +02:00 [INF] Method: POST
2025-11-16 19:19:27.650 +02:00 [INF] === Headers ===
2025-11-16 19:19:27.651 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:19:27.653 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:19:27.655 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:19:27.656 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:19:27.657 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:19:27.659 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:19:27.660 +02:00 [INF] Content-Length: ["61"]
2025-11-16 19:19:27.663 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:19:27.665 +02:00 [INF] Postman-Token: ["f7a5d22a-b3f9-45be-ba88-aa9efb82b987"]
2025-11-16 19:19:27.667 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:19:27.668 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:19:27.669 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:19:27.670 +02:00 [INF] Route matched with {action = "SubmitPurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SubmitPurchaseOrder(System.Guid, SubmitPurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:19:27.674 +02:00 [INF] Submitting purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:19:27.689 +02:00 [INF] Purchase order PO-202510-0001 submitted successfully
2025-11-16 19:19:27.692 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:19:27.697 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP) in 24.6675ms
2025-11-16 19:19:27.700 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:19:27.701 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:19:27.702 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/submit - 200 null application/json; charset=utf-8 61.4536ms
2025-11-16 19:19:45.856 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - application/json 90
2025-11-16 19:19:45.860 +02:00 [INF] Request started
2025-11-16 19:19:45.860 +02:00 [INF] === Incoming Request ===
2025-11-16 19:19:45.862 +02:00 [INF] Path: /api/PurchaseOrder/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/approve
2025-11-16 19:19:45.864 +02:00 [INF] Method: POST
2025-11-16 19:19:45.865 +02:00 [INF] === Headers ===
2025-11-16 19:19:45.866 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:19:45.867 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:19:45.869 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:19:45.872 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:19:45.874 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:19:45.875 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:19:45.877 +02:00 [INF] Content-Length: ["90"]
2025-11-16 19:19:45.879 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:19:45.881 +02:00 [INF] Postman-Token: ["11f36412-5559-4d64-ac78-5c8290c68498"]
2025-11-16 19:19:45.882 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:19:45.883 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:19:45.884 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:19:45.886 +02:00 [INF] Route matched with {action = "ApprovePurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApprovePurchaseOrder(System.Guid, ApprovePurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:19:45.890 +02:00 [INF] Approving purchase order with ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:19:45.904 +02:00 [INF] Purchase order PO-202510-0001 approved successfully
2025-11-16 19:19:45.907 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:19:45.909 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP) in 20.6237ms
2025-11-16 19:19:45.911 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:19:45.913 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:19:45.914 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{c9419c66-ab1f-4857-a967-37221b235ea5}/approve - 200 null application/json; charset=utf-8 57.3697ms
2025-11-16 19:20:11.078 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:20:11.082 +02:00 [INF] Request started
2025-11-16 19:20:11.083 +02:00 [INF] === Incoming Request ===
2025-11-16 19:20:11.083 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:20:11.084 +02:00 [INF] Method: POST
2025-11-16 19:20:11.086 +02:00 [INF] === Headers ===
2025-11-16 19:20:11.087 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:20:11.089 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:20:11.090 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:20:11.091 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:20:11.092 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:20:11.094 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:20:11.096 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:20:11.097 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:20:11.099 +02:00 [INF] Postman-Token: ["1d0af481-0f83-41f5-b6e5-1e8cbf69813a"]
2025-11-16 19:20:11.100 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:20:11.101 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:20:11.102 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:20:11.106 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:20:11.119 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:20:11.506 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:20:11.511 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:20:11.604 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 5 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 122
2025-11-16 19:20:11.615 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 507.0539ms
2025-11-16 19:20:11.618 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:20:11.619 +02:00 [WRN] Business logic exception occurred: Cannot receive 5 units of  Product. Only 0.000 units pending.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 5 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 122
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:20:11.628 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:20:11.629 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 550.6385ms
2025-11-16 19:20:29.878 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:20:29.881 +02:00 [INF] Request started
2025-11-16 19:20:29.882 +02:00 [INF] === Incoming Request ===
2025-11-16 19:20:29.883 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:20:29.884 +02:00 [INF] Method: POST
2025-11-16 19:20:29.884 +02:00 [INF] === Headers ===
2025-11-16 19:20:29.885 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:20:29.886 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:20:29.888 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:20:29.889 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:20:29.890 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:20:29.893 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:20:29.894 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:20:29.895 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:20:29.897 +02:00 [INF] Postman-Token: ["12894d02-fe78-423e-82d3-d14130a37680"]
2025-11-16 19:20:29.898 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:20:29.899 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:20:29.900 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:20:29.901 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:20:29.903 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:20:29.906 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:20:30.097 +02:00 [INF] GRN created successfully with number: GRN-2025-00001
2025-11-16 19:20:30.161 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:20:30.175 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 272.3822ms
2025-11-16 19:20:30.178 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:20:30.180 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:20:30.181 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 303.1195ms
2025-11-16 19:22:06.230 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:22:06.235 +02:00 [INF] Request started
2025-11-16 19:22:06.235 +02:00 [INF] === Incoming Request ===
2025-11-16 19:22:06.237 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:22:06.238 +02:00 [INF] Method: POST
2025-11-16 19:22:06.238 +02:00 [INF] === Headers ===
2025-11-16 19:22:06.239 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:22:06.241 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:22:06.242 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:22:06.244 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:22:06.245 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:22:06.247 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:22:06.249 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:22:06.250 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:22:06.252 +02:00 [INF] Postman-Token: ["07542ecd-f012-4288-ba75-301e9e3f8859"]
2025-11-16 19:22:06.253 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:22:06.254 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:22:06.255 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:22:06.256 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:22:06.259 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:22:06.265 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:22:06.277 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 122
2025-11-16 19:22:06.280 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 21.8815ms
2025-11-16 19:22:06.283 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:22:06.285 +02:00 [WRN] Business logic exception occurred: Cannot receive 2 units of  Product. Only 0.000 units pending.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 122
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:22:06.297 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:22:06.298 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 67.9731ms
2025-11-16 19:28:25.154 +02:00 [INF] Starting web host...
2025-11-16 19:28:26.494 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:28:26.535 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:28:26.609 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:28:26.615 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:28:26.619 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:28:26.672 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:28:26.688 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:28:26.692 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:28:26.697 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:28:26.709 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:28:26.713 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:28:26.869 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:28:26.876 +02:00 [INF] Master database initialized successfully
2025-11-16 19:28:29.141 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:28:29.244 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:28:29.247 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:28:29.363 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:28:29.365 +02:00 [INF] Hosting environment: Development
2025-11-16 19:28:29.368 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:28:29.517 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:28:29.693 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 176.0568ms
2025-11-16 19:28:29.875 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:28:29.875 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:28:29.882 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.1808ms
2025-11-16 19:28:29.904 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.6327ms
2025-11-16 19:28:29.963 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:28:30.266 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 302.7732ms
2025-11-16 19:28:36.376 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:28:36.393 +02:00 [INF] Request started
2025-11-16 19:28:36.395 +02:00 [INF] === Incoming Request ===
2025-11-16 19:28:36.398 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:28:36.399 +02:00 [INF] Method: POST
2025-11-16 19:28:36.401 +02:00 [INF] === Headers ===
2025-11-16 19:28:36.403 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:28:36.406 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:28:36.407 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:28:36.409 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:28:36.410 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:28:36.412 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:28:36.416 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:28:36.418 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:28:36.420 +02:00 [INF] Postman-Token: ["25d87f2e-b49e-49a4-a0f5-9048fc039582"]
2025-11-16 19:28:36.424 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:28:36.426 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:28:36.429 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:28:36.446 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:28:36.453 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:28:36.482 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:28:36.553 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:28:37.123 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:28:37.130 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:28:37.235 +02:00 [ERR] Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 150
2025-11-16 19:28:37.259 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 806.4152ms
2025-11-16 19:28:37.261 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:28:37.265 +02:00 [WRN] Business logic exception occurred: Cannot receive 2 units of  Product. Only 0.000 units pending.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of  Product. Only 0.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 150
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:28:37.297 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:28:37.304 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 927.4082ms
2025-11-16 19:30:28.452 +02:00 [INF] Starting web host...
2025-11-16 19:30:29.893 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:30:29.941 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:30:30.028 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:30:30.037 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:30:30.042 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:30:30.096 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:30:30.111 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:30:30.116 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:30:30.122 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:30:30.134 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:30:30.138 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:30:30.330 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:30:30.338 +02:00 [INF] Master database initialized successfully
2025-11-16 19:30:32.512 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:30:32.621 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:30:32.624 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:30:32.710 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:30:32.712 +02:00 [INF] Hosting environment: Development
2025-11-16 19:30:32.713 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:30:32.896 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:30:33.064 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 168.9402ms
2025-11-16 19:30:33.129 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:30:33.129 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:30:33.136 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.9948ms
2025-11-16 19:30:33.156 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.5449ms
2025-11-16 19:30:33.179 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:30:33.414 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 234.9965ms
2025-11-16 19:30:36.542 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:30:36.565 +02:00 [INF] Request started
2025-11-16 19:30:36.567 +02:00 [INF] === Incoming Request ===
2025-11-16 19:30:36.569 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:30:36.570 +02:00 [INF] Method: POST
2025-11-16 19:30:36.572 +02:00 [INF] === Headers ===
2025-11-16 19:30:36.576 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:30:36.580 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:30:36.581 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:30:36.582 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:30:36.584 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:30:36.586 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:30:36.587 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:30:36.589 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:30:36.591 +02:00 [INF] Postman-Token: ["22a623f7-7b9a-4f23-b00f-825b99eedc62"]
2025-11-16 19:30:36.597 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:30:36.599 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:30:36.601 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:30:36.618 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:30:36.625 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:30:36.663 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:30:36.737 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:30:37.452 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:30:37.461 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:30:37.487 +02:00 [INF] PO found: PO-202510-0001 | DocumentStatus: Approved | ReceptionStatus: Fully Received | PaymentStatus: PartiallyPaid
2025-11-16 19:30:37.593 +02:00 [INF] Validating line item | POLineItemId: "e61bce09-3b17-4067-b6b8-08de19560c5f" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 5.000 | Pending: 0.000 | Attempting to Receive: 2
2025-11-16 19:30:37.596 +02:00 [ERR] Line item already fully received | POLineItemId: "e61bce09-3b17-4067-b6b8-08de19560c5f" | Item: ' Product' | Ordered: 5.000 | Already Received: 5.000
2025-11-16 19:30:37.599 +02:00 [ERR] ‚ùå Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 192
2025-11-16 19:30:37.625 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 999.5937ms
2025-11-16 19:30:37.629 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:30:37.633 +02:00 [WRN] Business logic exception occurred: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 192
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:30:37.679 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:30:37.685 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 1142.8834ms
2025-11-16 19:31:04.273 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:31:04.285 +02:00 [INF] Request started
2025-11-16 19:31:04.286 +02:00 [INF] === Incoming Request ===
2025-11-16 19:31:04.287 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:31:04.288 +02:00 [INF] Method: POST
2025-11-16 19:31:04.289 +02:00 [INF] === Headers ===
2025-11-16 19:31:04.290 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:31:04.291 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:31:04.294 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:31:04.295 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:31:04.298 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:31:04.300 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:31:04.302 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:31:04.304 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:31:04.305 +02:00 [INF] Postman-Token: ["d217580b-84c2-4082-b8ef-903931b56a3e"]
2025-11-16 19:31:04.308 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:31:04.310 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:31:04.311 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:31:04.316 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:31:04.320 +02:00 [INF] API: Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:31:04.324 +02:00 [INF] Creating new GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:31:04.331 +02:00 [INF] PO found: PO-202510-0001 | DocumentStatus: Approved | ReceptionStatus: Fully Received | PaymentStatus: PartiallyPaid
2025-11-16 19:31:04.343 +02:00 [INF] Validating line item | POLineItemId: "e61bce09-3b17-4067-b6b8-08de19560c5f" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 5.000 | Pending: 0.000 | Attempting to Receive: 2
2025-11-16 19:31:04.347 +02:00 [ERR] Line item already fully received | POLineItemId: "e61bce09-3b17-4067-b6b8-08de19560c5f" | Item: ' Product' | Ordered: 5.000 | Already Received: 5.000
2025-11-16 19:31:04.349 +02:00 [ERR] ‚ùå Error creating GRN for PO: "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 192
2025-11-16 19:31:04.354 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 34.249ms
2025-11-16 19:31:04.355 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:31:04.356 +02:00 [WRN] Business logic exception occurred: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive ' Product'. This item has already been fully received. Ordered: 5.000, Already Received: 5.000, Pending: 0. Please check if a previous GRN was created for this item.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 192
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:31:04.378 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:31:04.382 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 108.5503ms
2025-11-16 19:32:13.090 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/submit - application/json 61
2025-11-16 19:32:13.096 +02:00 [INF] Request started
2025-11-16 19:32:13.097 +02:00 [INF] === Incoming Request ===
2025-11-16 19:32:13.099 +02:00 [INF] Path: /api/PurchaseOrder/%7B23d49ad7-c8f3-4545-9bb3-6957cdf43515%7D/submit
2025-11-16 19:32:13.100 +02:00 [INF] Method: POST
2025-11-16 19:32:13.102 +02:00 [INF] === Headers ===
2025-11-16 19:32:13.102 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:32:13.104 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:32:13.105 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:32:13.107 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:32:13.109 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:32:13.113 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:32:13.114 +02:00 [INF] Content-Length: ["61"]
2025-11-16 19:32:13.116 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:32:13.117 +02:00 [INF] Postman-Token: ["3199b667-0ec2-4a5d-9ca5-b87abffbd2fd"]
2025-11-16 19:32:13.119 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:32:13.121 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:32:13.123 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:32:13.134 +02:00 [INF] Route matched with {action = "SubmitPurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SubmitPurchaseOrder(System.Guid, SubmitPurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:32:13.168 +02:00 [INF] Submitting purchase order with ID: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:32:13.360 +02:00 [INF] Purchase order PO-202510-0005 submitted successfully
2025-11-16 19:32:13.366 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:32:13.370 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP) in 232.5723ms
2025-11-16 19:32:13.374 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:32:13.376 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:32:13.377 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/submit - 200 null application/json; charset=utf-8 286.4649ms
2025-11-16 19:32:24.398 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/approve - application/json 90
2025-11-16 19:32:24.402 +02:00 [INF] Request started
2025-11-16 19:32:24.403 +02:00 [INF] === Incoming Request ===
2025-11-16 19:32:24.404 +02:00 [INF] Path: /api/PurchaseOrder/%7B23d49ad7-c8f3-4545-9bb3-6957cdf43515%7D/approve
2025-11-16 19:32:24.405 +02:00 [INF] Method: POST
2025-11-16 19:32:24.406 +02:00 [INF] === Headers ===
2025-11-16 19:32:24.407 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:32:24.411 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:32:24.413 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:32:24.414 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:32:24.416 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:32:24.417 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:32:24.421 +02:00 [INF] Content-Length: ["90"]
2025-11-16 19:32:24.423 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:32:24.425 +02:00 [INF] Postman-Token: ["299b1a46-d7d5-447b-a367-5e9095a4fd38"]
2025-11-16 19:32:24.427 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:32:24.430 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:32:24.432 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:32:24.436 +02:00 [INF] Route matched with {action = "ApprovePurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApprovePurchaseOrder(System.Guid, ApprovePurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:32:24.459 +02:00 [INF] Approving purchase order with ID: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:32:24.478 +02:00 [INF] Purchase order PO-202510-0005 approved successfully
2025-11-16 19:32:24.479 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:32:24.481 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP) in 39.5029ms
2025-11-16 19:32:24.483 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:32:24.485 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:32:24.486 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/approve - 200 null application/json; charset=utf-8 88.342ms
2025-11-16 19:32:34.846 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:32:34.849 +02:00 [INF] Request started
2025-11-16 19:32:34.850 +02:00 [INF] === Incoming Request ===
2025-11-16 19:32:34.852 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:32:34.853 +02:00 [INF] Method: POST
2025-11-16 19:32:34.854 +02:00 [INF] === Headers ===
2025-11-16 19:32:34.855 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:32:34.859 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:32:34.861 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:32:34.862 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:32:34.864 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:32:34.865 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:32:34.869 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:32:34.870 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:32:34.872 +02:00 [INF] Postman-Token: ["4d3793b9-8693-4acd-ab00-1cf535999e7c"]
2025-11-16 19:32:34.874 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:32:34.875 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:32:34.877 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:32:34.879 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:32:34.883 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:32:34.889 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:32:34.892 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: NotReceived | PaymentStatus: PartiallyPaid
2025-11-16 19:32:34.908 +02:00 [ERR] Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to PO "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:32:34.910 +02:00 [ERR] ‚ùå Error creating GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
ModularERP.Common.Exceptions.BusinessLogicException: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 136
2025-11-16 19:32:34.913 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 31.0767ms
2025-11-16 19:32:34.915 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:32:34.917 +02:00 [WRN] Business logic exception occurred: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
ModularERP.Common.Exceptions.BusinessLogicException: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 136
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:32:34.937 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:32:34.940 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 93.5598ms
2025-11-16 19:33:02.663 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 306
2025-11-16 19:33:02.667 +02:00 [INF] Request started
2025-11-16 19:33:02.667 +02:00 [INF] === Incoming Request ===
2025-11-16 19:33:02.668 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-16 19:33:02.669 +02:00 [INF] Method: POST
2025-11-16 19:33:02.670 +02:00 [INF] === Headers ===
2025-11-16 19:33:02.671 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:33:02.675 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:33:02.677 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:33:02.678 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:33:02.680 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:33:02.682 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:33:02.685 +02:00 [INF] Content-Length: ["306"]
2025-11-16 19:33:02.686 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:33:02.688 +02:00 [INF] Postman-Token: ["222f2345-385b-4321-bb2c-e29c25209cd9"]
2025-11-16 19:33:02.690 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:33:02.692 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:33:02.693 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:33:02.699 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-16 19:33:02.711 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:33:02.722 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:33:02.734 +02:00 [ERR] Error creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot add items to Purchase Order in Approved status
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POItme.CreatePOLineItemHandler.Handle(CreatePOLineItemCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POItme\CreatePOLineItemHandler.cs:line 59
2025-11-16 19:33:02.744 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 42.55ms
2025-11-16 19:33:02.747 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:33:02.748 +02:00 [WRN] Business logic exception occurred: Cannot add items to Purchase Order in Approved status
ModularERP.Common.Exceptions.BusinessLogicException: Cannot add items to Purchase Order in Approved status
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POItme.CreatePOLineItemHandler.Handle(CreatePOLineItemCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POItme\CreatePOLineItemHandler.cs:line 59
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem(Guid purchaseOrderId, CreatePOLineItemDto lineItem) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\POLineItemController.cs:line 104
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:33:02.767 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:33:02.769 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 400 null application/json; charset=utf-8 105.3786ms
2025-11-16 19:33:39.057 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 306
2025-11-16 19:33:39.062 +02:00 [INF] Request started
2025-11-16 19:33:39.063 +02:00 [INF] === Incoming Request ===
2025-11-16 19:33:39.064 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-16 19:33:39.065 +02:00 [INF] Method: POST
2025-11-16 19:33:39.068 +02:00 [INF] === Headers ===
2025-11-16 19:33:39.069 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:33:39.070 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:33:39.071 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:33:39.073 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:33:39.074 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:33:39.076 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:33:39.079 +02:00 [INF] Content-Length: ["306"]
2025-11-16 19:33:39.082 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:33:39.084 +02:00 [INF] Postman-Token: ["36b9f10c-eea1-43b1-b1b5-0ef8235bf5f5"]
2025-11-16 19:33:39.085 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:33:39.086 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:33:39.089 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:33:39.091 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-16 19:33:39.094 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:33:39.097 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-16 19:33:39.303 +02:00 [INF] Line item "15bd95a6-b0ae-4743-5815-08de25364791" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5". Subtotal: 75000, Discount: 7500.0, Tax: 10125.0000, Total: 77625.0000
2025-11-16 19:33:39.333 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:33:39.360 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 266.744ms
2025-11-16 19:33:39.364 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:33:39.366 +02:00 [INF] Request completed successfully with status code 201
2025-11-16 19:33:39.367 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 201 null application/json; charset=utf-8 309.7437ms
2025-11-16 19:33:52.497 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/submit - application/json 61
2025-11-16 19:33:52.500 +02:00 [INF] Request started
2025-11-16 19:33:52.501 +02:00 [INF] === Incoming Request ===
2025-11-16 19:33:52.502 +02:00 [INF] Path: /api/PurchaseOrder/%7B23d49ad7-c8f3-4545-9bb3-6957cdf43515%7D/submit
2025-11-16 19:33:52.503 +02:00 [INF] Method: POST
2025-11-16 19:33:52.504 +02:00 [INF] === Headers ===
2025-11-16 19:33:52.505 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:33:52.509 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:33:52.512 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:33:52.514 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:33:52.515 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:33:52.518 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:33:52.520 +02:00 [INF] Content-Length: ["61"]
2025-11-16 19:33:52.521 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:33:52.523 +02:00 [INF] Postman-Token: ["c3ee6497-cd48-44b0-929e-a739c67ef069"]
2025-11-16 19:33:52.525 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:33:52.528 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:33:52.530 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:33:52.531 +02:00 [INF] Route matched with {action = "SubmitPurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SubmitPurchaseOrder(System.Guid, SubmitPurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:33:52.535 +02:00 [INF] Submitting purchase order with ID: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:33:52.550 +02:00 [INF] Purchase order PO-202510-0005 submitted successfully
2025-11-16 19:33:52.551 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:33:52.553 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP) in 18.8681ms
2025-11-16 19:33:52.556 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.SubmitPurchaseOrder (ModularERP)'
2025-11-16 19:33:52.558 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:33:52.559 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/submit - 200 null application/json; charset=utf-8 62.0924ms
2025-11-16 19:33:54.814 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/approve - application/json 90
2025-11-16 19:33:54.817 +02:00 [INF] Request started
2025-11-16 19:33:54.818 +02:00 [INF] === Incoming Request ===
2025-11-16 19:33:54.819 +02:00 [INF] Path: /api/PurchaseOrder/%7B23d49ad7-c8f3-4545-9bb3-6957cdf43515%7D/approve
2025-11-16 19:33:54.820 +02:00 [INF] Method: POST
2025-11-16 19:33:54.821 +02:00 [INF] === Headers ===
2025-11-16 19:33:54.822 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:33:54.826 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:33:54.828 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:33:54.829 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:33:54.831 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:33:54.832 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:33:54.835 +02:00 [INF] Content-Length: ["90"]
2025-11-16 19:33:54.836 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:33:54.837 +02:00 [INF] Postman-Token: ["2cb17d57-ba12-4463-b5f5-73b20db94538"]
2025-11-16 19:33:54.839 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:33:54.840 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:33:54.842 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:33:54.843 +02:00 [INF] Route matched with {action = "ApprovePurchaseOrder", controller = "PurchaseOrder"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ApprovePurchaseOrder(System.Guid, ApprovePurchaseOrderRequest) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController (ModularERP).
2025-11-16 19:33:54.850 +02:00 [INF] Approving purchase order with ID: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:33:54.855 +02:00 [INF] Purchase order PO-202510-0005 approved successfully
2025-11-16 19:33:54.858 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 19:33:54.860 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP) in 11.014ms
2025-11-16 19:33:54.862 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PurchaseOrderController.ApprovePurchaseOrder (ModularERP)'
2025-11-16 19:33:54.866 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:33:54.867 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/PurchaseOrder/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/approve - 200 null application/json; charset=utf-8 53.2413ms
2025-11-16 19:33:58.129 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:33:58.132 +02:00 [INF] Request started
2025-11-16 19:33:58.133 +02:00 [INF] === Incoming Request ===
2025-11-16 19:33:58.134 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:33:58.135 +02:00 [INF] Method: POST
2025-11-16 19:33:58.136 +02:00 [INF] === Headers ===
2025-11-16 19:33:58.138 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:33:58.141 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:33:58.143 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:33:58.145 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:33:58.146 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:33:58.147 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:33:58.149 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:33:58.152 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:33:58.154 +02:00 [INF] Postman-Token: ["c4677676-660b-495b-92c0-09ffadfcd63a"]
2025-11-16 19:33:58.157 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:33:58.158 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:33:58.161 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:33:58.163 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:33:58.166 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:33:58.169 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:33:58.175 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: NotReceived | PaymentStatus: PartiallyPaid
2025-11-16 19:33:58.183 +02:00 [ERR] Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to PO "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:33:58.186 +02:00 [ERR] ‚ùå Error creating GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
ModularERP.Common.Exceptions.BusinessLogicException: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 136
2025-11-16 19:33:58.189 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 23.8545ms
2025-11-16 19:33:58.193 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:33:58.195 +02:00 [WRN] Business logic exception occurred: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
ModularERP.Common.Exceptions.BusinessLogicException: Line items e61bce09-3b17-4067-b6b8-08de19560c5f do not belong to Purchase Order 23d49ad7-c8f3-4545-9bb3-6957cdf43515
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 136
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 19:33:58.215 +02:00 [INF] Error response sent with status code 400
2025-11-16 19:33:58.216 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 86.8534ms
2025-11-16 19:35:14.849 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/items - application/json 306
2025-11-16 19:35:14.853 +02:00 [INF] Request started
2025-11-16 19:35:14.853 +02:00 [INF] === Incoming Request ===
2025-11-16 19:35:14.854 +02:00 [INF] Path: /api/purchase-orders/%7B23d49ad7-c8f3-4545-9bb3-6957cdf43515%7D/items
2025-11-16 19:35:14.855 +02:00 [INF] Method: POST
2025-11-16 19:35:14.856 +02:00 [INF] === Headers ===
2025-11-16 19:35:14.857 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:35:14.860 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:35:14.861 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:35:14.864 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:35:14.865 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:35:14.868 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:35:14.870 +02:00 [INF] Content-Length: ["306"]
2025-11-16 19:35:14.871 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:35:14.872 +02:00 [INF] Postman-Token: ["fec0288f-0cb2-447e-9dcc-b1aba6cb2ee6"]
2025-11-16 19:35:14.874 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:35:14.875 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:35:14.876 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:35:14.878 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-16 19:35:14.884 +02:00 [INF] POST request received to create line item for PO "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:35:14.887 +02:00 [INF] Creating line item for Purchase Order "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:35:14.909 +02:00 [INF] Line item "172d5908-2ebf-4fa0-5816-08de25364791" created successfully for PO "23d49ad7-c8f3-4545-9bb3-6957cdf43515". Subtotal: 75000, Discount: 7500.0, Tax: 10125.0000, Total: 77625.0000
2025-11-16 19:35:14.919 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:35:14.922 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 38.675ms
2025-11-16 19:35:14.925 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-16 19:35:14.926 +02:00 [INF] Request completed successfully with status code 201
2025-11-16 19:35:14.927 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{23d49ad7-c8f3-4545-9bb3-6957cdf43515}/items - 201 null application/json; charset=utf-8 78.5472ms
2025-11-16 19:35:36.495 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:35:36.498 +02:00 [INF] Request started
2025-11-16 19:35:36.499 +02:00 [INF] === Incoming Request ===
2025-11-16 19:35:36.500 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:35:36.501 +02:00 [INF] Method: POST
2025-11-16 19:35:36.503 +02:00 [INF] === Headers ===
2025-11-16 19:35:36.505 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:35:36.506 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:35:36.508 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:35:36.510 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:35:36.511 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:35:36.515 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:35:36.516 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:35:36.518 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:35:36.519 +02:00 [INF] Postman-Token: ["dbac7512-b99e-4855-a556-257aed77e8be"]
2025-11-16 19:35:36.521 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:35:36.522 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:35:36.523 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:35:36.527 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:35:36.531 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:35:36.533 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:35:36.538 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: NotReceived | PaymentStatus: PartiallyPaid
2025-11-16 19:35:36.549 +02:00 [INF] Validating line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 0.000 | Pending: 5.000 | Attempting to Receive: 2
2025-11-16 19:35:36.553 +02:00 [INF] ‚úÖ Validation passed for line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' | Receiving: 2
2025-11-16 19:35:36.574 +02:00 [INF] Generated GRN Number: GRN-2025-00001
2025-11-16 19:35:36.657 +02:00 [INF] GRN entity created with Id: "5add8f05-71b7-4d97-1abe-08de25368d83"
2025-11-16 19:35:36.670 +02:00 [INF] Updated PO Line Item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Previous Received: 0.000 | New Received: 2.000 | Increment: 2
2025-11-16 19:35:36.684 +02:00 [INF] Updating PO Reception Status | PO: PO-202510-0005 | Previous: NotReceived | New: Partially Received
2025-11-16 19:35:36.695 +02:00 [INF] ‚úÖ GRN created successfully | GRN Number: GRN-2025-00001 | PO: PO-202510-0005
2025-11-16 19:35:36.765 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:35:36.777 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 246.2803ms
2025-11-16 19:35:36.779 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:35:36.781 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:35:36.782 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 286.8072ms
2025-11-16 19:39:33.267 +02:00 [INF] Starting web host...
2025-11-16 19:39:34.676 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:39:34.717 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 19:39:34.794 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:39:34.800 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 19:39:34.804 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 19:39:34.858 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 19:39:34.876 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 19:39:34.881 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 19:39:34.887 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 19:39:34.898 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 19:39:34.903 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 19:39:35.071 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 19:39:35.079 +02:00 [INF] Master database initialized successfully
2025-11-16 19:39:37.219 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 19:39:37.333 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 19:39:37.336 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 19:39:37.422 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 19:39:37.425 +02:00 [INF] Hosting environment: Development
2025-11-16 19:39:37.426 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 19:39:37.723 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 19:39:37.852 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 129.7173ms
2025-11-16 19:39:37.858 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 19:39:37.858 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 19:39:37.872 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.0216ms
2025-11-16 19:39:37.890 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.7388ms
2025-11-16 19:39:37.948 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 19:39:38.209 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 260.3639ms
2025-11-16 19:40:11.526 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 19:40:11.558 +02:00 [INF] Request started
2025-11-16 19:40:11.561 +02:00 [INF] === Incoming Request ===
2025-11-16 19:40:11.562 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 19:40:11.563 +02:00 [INF] Method: POST
2025-11-16 19:40:11.564 +02:00 [INF] === Headers ===
2025-11-16 19:40:11.568 +02:00 [INF] Accept: ["*/*"]
2025-11-16 19:40:11.571 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 19:40:11.573 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 19:40:11.574 +02:00 [INF] User-Agent: ["PostmanRuntime/7.50.0"]
2025-11-16 19:40:11.576 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 19:40:11.577 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 19:40:11.580 +02:00 [INF] Content-Length: ["514"]
2025-11-16 19:40:11.583 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 19:40:11.584 +02:00 [INF] Postman-Token: ["d42a336a-b6a0-40bc-ae59-60f22871b530"]
2025-11-16 19:40:11.591 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 19:40:11.592 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 19:40:11.594 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:40:11.618 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 19:40:11.626 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:40:11.666 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:40:11.742 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 19:40:12.503 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 19:40:12.516 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 19:40:12.542 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: Partially Received | PaymentStatus: PartiallyPaid
2025-11-16 19:40:12.627 +02:00 [INF] Validating line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 2.000 | Pending: 3.000 | Attempting to Receive: 2
2025-11-16 19:40:12.632 +02:00 [INF] ‚úÖ Validation passed for line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' | Receiving: 2
2025-11-16 19:40:12.648 +02:00 [INF] Generated GRN Number: GRN-2025-00002
2025-11-16 19:40:12.834 +02:00 [INF] GRN entity created with Id: "a6f6f582-651a-45e1-842e-08de25373214"
2025-11-16 19:40:12.917 +02:00 [INF] Updated PO Line Item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Previous Received: 2.000 | New Received: 4.000 | Increment: 2
2025-11-16 19:40:12.928 +02:00 [INF] Updating PO Reception Status | PO: PO-202510-0005 | Previous: Partially Received | New: Partially Received
2025-11-16 19:40:13.027 +02:00 [INF] ‚úÖ GRN created successfully | GRN Number: GRN-2025-00002 | PO: PO-202510-0005
2025-11-16 19:40:13.102 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 19:40:13.125 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 1500.4309ms
2025-11-16 19:40:13.128 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 19:40:13.131 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 19:40:13.136 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 1610.652ms
2025-11-16 21:12:16.091 +02:00 [INF] Starting web host...
2025-11-16 21:12:17.557 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:12:17.637 +02:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 21:12:17.725 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:12:17.730 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 21:12:17.747 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 21:12:17.813 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 21:12:17.834 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:12:17.839 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 21:12:17.846 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 21:12:17.856 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 21:12:17.861 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 21:12:18.084 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 21:12:18.094 +02:00 [INF] Master database initialized successfully
2025-11-16 21:12:21.060 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 21:12:21.242 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 21:12:21.243 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 21:12:21.381 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 21:12:21.382 +02:00 [INF] Hosting environment: Development
2025-11-16 21:12:21.384 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 21:12:21.841 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 21:12:22.433 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 594.1653ms
2025-11-16 21:12:22.461 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 21:12:22.461 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 21:12:22.579 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 117.5137ms
2025-11-16 21:12:22.686 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 224.6508ms
2025-11-16 21:12:22.732 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 21:12:23.283 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 551.004ms
2025-11-16 21:13:49.891 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - null null
2025-11-16 21:13:49.913 +02:00 [INF] Request started
2025-11-16 21:13:49.915 +02:00 [INF] === Incoming Request ===
2025-11-16 21:13:49.917 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 21:13:49.918 +02:00 [INF] Method: GET
2025-11-16 21:13:49.919 +02:00 [INF] === Headers ===
2025-11-16 21:13:49.921 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:13:49.924 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:13:49.926 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:13:49.928 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:13:49.929 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:13:49.931 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:13:49.933 +02:00 [INF] Postman-Token: ["ba055fcd-5243-4fb1-8e87-7ae945fc8188"]
2025-11-16 21:13:49.937 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:13:49.938 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:13:49.940 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 21:13:49.959 +02:00 [INF] Route matched with {action = "GetAllGRNs", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGRNs(System.Guid, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:13:49.965 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:13:49.977 +02:00 [INF] API: Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 21:13:50.044 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 21:13:50.102 +02:00 [INF] Fetching all GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 21:13:50.226 +02:00 [INF] Retrieved 0 GRNs for Company: "00000000-0000-0000-0000-000000000000"
2025-11-16 21:13:50.233 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNListItemDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 21:13:50.251 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP) in 286.444ms
2025-11-16 21:13:50.254 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 21:13:50.256 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:13:50.261 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 370.3549ms
2025-11-16 21:14:18.257 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts?CompanyId=90137c92-382d-404c-bade-e5fefb1e8dbf&warehouseId=e5d0bbaa-9099-43e1-bb16-f9744078a9ea&purchaseOrderId=23d49ad7-c8f3-4545-9bb3-6957cdf43515 - null null
2025-11-16 21:14:18.270 +02:00 [INF] Request started
2025-11-16 21:14:18.272 +02:00 [INF] === Incoming Request ===
2025-11-16 21:14:18.273 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 21:14:18.274 +02:00 [INF] Method: GET
2025-11-16 21:14:18.274 +02:00 [INF] === Headers ===
2025-11-16 21:14:18.276 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:14:18.277 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:14:18.278 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:14:18.280 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:14:18.282 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:14:18.283 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:14:18.285 +02:00 [INF] Postman-Token: ["ecb9a66e-ee99-46e2-b486-9519cd39180d"]
2025-11-16 21:14:18.288 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:14:18.289 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:14:18.290 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 21:14:18.291 +02:00 [INF] Route matched with {action = "GetAllGRNs", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllGRNs(System.Guid, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:14:18.297 +02:00 [INF] API: Fetching all GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 21:14:18.337 +02:00 [INF] Fetching all GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 21:14:18.366 +02:00 [INF] Retrieved 2 GRNs for Company: "90137c92-382d-404c-bade-e5fefb1e8dbf"
2025-11-16 21:14:18.369 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNListItemDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 21:14:18.372 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP) in 78.2951ms
2025-11-16 21:14:18.374 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetAllGRNs (ModularERP)'
2025-11-16 21:14:18.375 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:14:18.376 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts?CompanyId=90137c92-382d-404c-bade-e5fefb1e8dbf&warehouseId=e5d0bbaa-9099-43e1-bb16-f9744078a9ea&purchaseOrderId=23d49ad7-c8f3-4545-9bb3-6957cdf43515 - 200 null application/json; charset=utf-8 119.0614ms
2025-11-16 21:15:50.969 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5add8f05-71b7-4d97-1abe-08de25368d83} - null null
2025-11-16 21:15:50.975 +02:00 [INF] Request started
2025-11-16 21:15:50.976 +02:00 [INF] === Incoming Request ===
2025-11-16 21:15:50.977 +02:00 [INF] Path: /api/GoodsReceipts/%7B5add8f05-71b7-4d97-1abe-08de25368d83%7D
2025-11-16 21:15:50.978 +02:00 [INF] Method: GET
2025-11-16 21:15:50.979 +02:00 [INF] === Headers ===
2025-11-16 21:15:50.980 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:15:50.982 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:15:50.983 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:15:50.985 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:15:50.987 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:15:50.989 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:15:50.990 +02:00 [INF] Postman-Token: ["de42edf4-5450-4c04-96e4-41d30f3d6545"]
2025-11-16 21:15:50.991 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:15:50.992 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:15:50.994 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:15:50.998 +02:00 [INF] Route matched with {action = "GetGRNById", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetGRNById(System.Guid, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:15:51.003 +02:00 [INF] API: Fetching GRN with ID: "5add8f05-71b7-4d97-1abe-08de25368d83"
2025-11-16 21:15:51.011 +02:00 [INF] Fetching GRN with ID: "5add8f05-71b7-4d97-1abe-08de25368d83"
2025-11-16 21:15:51.124 +02:00 [INF] Retrieved GRN successfully: GRN-2025-00001
2025-11-16 21:15:51.127 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:15:51.142 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP) in 140.1872ms
2025-11-16 21:15:51.144 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:15:51.146 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:15:51.147 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5add8f05-71b7-4d97-1abe-08de25368d83} - 200 null application/json; charset=utf-8 177.8243ms
2025-11-16 21:16:09.667 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 21:16:09.671 +02:00 [INF] Request started
2025-11-16 21:16:09.672 +02:00 [INF] === Incoming Request ===
2025-11-16 21:16:09.672 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 21:16:09.673 +02:00 [INF] Method: POST
2025-11-16 21:16:09.675 +02:00 [INF] === Headers ===
2025-11-16 21:16:09.675 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:16:09.677 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:16:09.678 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:16:09.680 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:16:09.682 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:16:09.683 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 21:16:09.685 +02:00 [INF] Content-Length: ["514"]
2025-11-16 21:16:09.686 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:16:09.687 +02:00 [INF] Postman-Token: ["11bf8bcb-7d8c-44cd-ba8c-4026109d5546"]
2025-11-16 21:16:09.689 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:16:09.690 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:16:09.691 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 21:16:09.695 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:16:09.714 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 21:16:10.112 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:16:10.119 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 21:16:10.128 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: Partially Received | PaymentStatus: PartiallyPaid
2025-11-16 21:16:10.171 +02:00 [INF] Validating line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 4.000 | Pending: 1.000 | Attempting to Receive: 2
2025-11-16 21:16:10.174 +02:00 [ERR] Attempting to over-receive | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' | Ordered: 5.000 | Already Received: 4.000 | Pending: 1.000 | Attempting: 2
2025-11-16 21:16:10.182 +02:00 [ERR] ‚ùå Error creating GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of ' Product'. Ordered: 5.000, Already Received: 4.000, Only 1.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 210
2025-11-16 21:16:10.219 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 520.3895ms
2025-11-16 21:16:10.221 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 21:16:10.223 +02:00 [WRN] Business logic exception occurred: Cannot receive 2 units of ' Product'. Ordered: 5.000, Already Received: 4.000, Only 1.000 units pending.
ModularERP.Common.Exceptions.BusinessLogicException: Cannot receive 2 units of ' Product'. Ordered: 5.000, Already Received: 4.000, Only 1.000 units pending.
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.CreateGRNHandler.Handle(CreateGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\CreateGRNHandler.cs:line 210
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN(CreateGRNDto request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GoodsReceiptsController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 21:16:10.245 +02:00 [INF] Error response sent with status code 400
2025-11-16 21:16:10.247 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 400 null application/json; charset=utf-8 579.9553ms
2025-11-16 21:16:24.019 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - application/json 514
2025-11-16 21:16:24.023 +02:00 [INF] Request started
2025-11-16 21:16:24.024 +02:00 [INF] === Incoming Request ===
2025-11-16 21:16:24.024 +02:00 [INF] Path: /api/GoodsReceipts
2025-11-16 21:16:24.026 +02:00 [INF] Method: POST
2025-11-16 21:16:24.027 +02:00 [INF] === Headers ===
2025-11-16 21:16:24.028 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:16:24.029 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:16:24.031 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:16:24.032 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:16:24.033 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:16:24.034 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 21:16:24.036 +02:00 [INF] Content-Length: ["514"]
2025-11-16 21:16:24.037 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:16:24.039 +02:00 [INF] Postman-Token: ["1db8bd33-39f2-40ae-905d-00d1f009482b"]
2025-11-16 21:16:24.042 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:16:24.043 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:16:24.044 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 21:16:24.045 +02:00 [INF] Route matched with {action = "CreateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateGRN(ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.CreateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:16:24.048 +02:00 [INF] API: Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 21:16:24.051 +02:00 [INF] Creating new GRN for PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 21:16:24.055 +02:00 [INF] PO found: PO-202510-0005 | DocumentStatus: Approved | ReceptionStatus: Partially Received | PaymentStatus: PartiallyPaid
2025-11-16 21:16:24.060 +02:00 [INF] Validating line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' (SKU-104) | Ordered: 5.000 | Previously Received: 4.000 | Pending: 1.000 | Attempting to Receive: 1
2025-11-16 21:16:24.062 +02:00 [INF] ‚úÖ Validation passed for line item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Item: ' Product' | Receiving: 1
2025-11-16 21:16:24.075 +02:00 [INF] Generated GRN Number: GRN-2025-00003
2025-11-16 21:16:24.259 +02:00 [INF] GRN entity created with Id: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:16:24.346 +02:00 [INF] Updated PO Line Item | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Previous Received: 4.000 | New Received: 5.000 | Increment: 1
2025-11-16 21:16:24.355 +02:00 [INF] Updating PO Reception Status | PO: PO-202510-0005 | Previous: Partially Received | New: Fully Received
2025-11-16 21:16:24.473 +02:00 [INF] ‚úÖ GRN created successfully | GRN Number: GRN-2025-00003 | PO: PO-202510-0005
2025-11-16 21:16:24.523 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:16:24.527 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP) in 479.1845ms
2025-11-16 21:16:24.529 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.CreateGRN (ModularERP)'
2025-11-16 21:16:24.530 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:16:24.531 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GoodsReceipts - 200 null application/json; charset=utf-8 511.8777ms
2025-11-16 21:20:43.525 +02:00 [INF] Starting web host...
2025-11-16 21:20:45.162 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:20:45.236 +02:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 21:20:45.322 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:20:45.327 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 21:20:45.343 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 21:20:45.398 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 21:20:45.413 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:20:45.417 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 21:20:45.424 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 21:20:45.435 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 21:20:45.442 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 21:20:45.606 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 21:20:45.613 +02:00 [INF] Master database initialized successfully
2025-11-16 21:20:47.686 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 21:20:47.793 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 21:20:47.795 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 21:20:47.882 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 21:20:47.885 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 21:20:47.889 +02:00 [INF] Hosting environment: Development
2025-11-16 21:20:47.889 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 21:20:48.009 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 127.9446ms
2025-11-16 21:20:48.071 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 21:20:48.071 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 21:20:48.079 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.9394ms
2025-11-16 21:20:48.093 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.8501ms
2025-11-16 21:20:48.160 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 21:20:48.398 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 238.1809ms
2025-11-16 21:24:43.914 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5add8f05-71b7-4d97-1abe-08de25368d83} - null null
2025-11-16 21:24:43.935 +02:00 [INF] Request started
2025-11-16 21:24:43.937 +02:00 [INF] === Incoming Request ===
2025-11-16 21:24:43.939 +02:00 [INF] Path: /api/GoodsReceipts/%7B5add8f05-71b7-4d97-1abe-08de25368d83%7D
2025-11-16 21:24:43.940 +02:00 [INF] Method: GET
2025-11-16 21:24:43.941 +02:00 [INF] === Headers ===
2025-11-16 21:24:43.944 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:24:43.947 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:24:43.948 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:24:43.949 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:24:43.950 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:24:43.952 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:24:43.953 +02:00 [INF] Postman-Token: ["79b77bf2-1be7-4ec8-a185-dadc1fbbe7ea"]
2025-11-16 21:24:43.958 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:24:43.960 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:24:43.962 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:24:43.983 +02:00 [INF] Route matched with {action = "GetGRNById", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetGRNById(System.Guid, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:24:43.988 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:24:44.004 +02:00 [INF] API: Fetching GRN with ID: "5add8f05-71b7-4d97-1abe-08de25368d83"
2025-11-16 21:24:44.080 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 21:24:44.145 +02:00 [INF] Fetching GRN with ID: "5add8f05-71b7-4d97-1abe-08de25368d83"
2025-11-16 21:24:44.296 +02:00 [INF] ‚úÖ Retrieved GRN successfully: GRN-2025-00001 | PO: PO-202510-0005 | Status: Fully Received
2025-11-16 21:24:44.304 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:24:44.338 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP) in 349.2422ms
2025-11-16 21:24:44.341 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:24:44.343 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:24:44.348 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5add8f05-71b7-4d97-1abe-08de25368d83} - 200 null application/json; charset=utf-8 434.173ms
2025-11-16 21:26:11.888 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - null null
2025-11-16 21:26:11.902 +02:00 [INF] Request started
2025-11-16 21:26:11.903 +02:00 [INF] === Incoming Request ===
2025-11-16 21:26:11.904 +02:00 [INF] Path: /api/GoodsReceipts/%7B5aead617-f576-411f-526a-08de2544a21d%7D
2025-11-16 21:26:11.905 +02:00 [INF] Method: GET
2025-11-16 21:26:11.906 +02:00 [INF] === Headers ===
2025-11-16 21:26:11.907 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:26:11.908 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:26:11.910 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:26:11.911 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:26:11.913 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:26:11.915 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:26:11.916 +02:00 [INF] Postman-Token: ["f5296446-c10f-431c-96ed-71dde19d8c6e"]
2025-11-16 21:26:11.920 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:26:11.921 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:26:11.922 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:26:11.923 +02:00 [INF] Route matched with {action = "GetGRNById", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetGRNById(System.Guid, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:26:11.926 +02:00 [INF] API: Fetching GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:26:11.970 +02:00 [INF] Fetching GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:26:11.990 +02:00 [INF] ‚úÖ Retrieved GRN successfully: GRN-2025-00003 | PO: PO-202510-0005 | Status: Fully Received
2025-11-16 21:26:11.993 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:26:11.995 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP) in 69.8102ms
2025-11-16 21:26:11.997 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.GetGRNById (ModularERP)'
2025-11-16 21:26:11.998 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:26:11.999 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - 200 null application/json; charset=utf-8 111.0311ms
2025-11-16 21:42:20.612 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - application/json 476
2025-11-16 21:42:20.617 +02:00 [INF] Request started
2025-11-16 21:42:20.618 +02:00 [INF] === Incoming Request ===
2025-11-16 21:42:20.619 +02:00 [INF] Path: /api/GoodsReceipts/%7B5aead617-f576-411f-526a-08de2544a21d%7D
2025-11-16 21:42:20.620 +02:00 [INF] Method: PUT
2025-11-16 21:42:20.621 +02:00 [INF] === Headers ===
2025-11-16 21:42:20.623 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:42:20.624 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:42:20.626 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:42:20.627 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:42:20.628 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:42:20.629 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 21:42:20.631 +02:00 [INF] Content-Length: ["476"]
2025-11-16 21:42:20.632 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:42:20.634 +02:00 [INF] Postman-Token: ["7bb50d38-efe8-4e13-ab98-67211f668815"]
2025-11-16 21:42:20.635 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:42:20.636 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:42:20.637 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 21:42:20.643 +02:00 [INF] Route matched with {action = "UpdateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.UpdateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:42:20.663 +02:00 [INF] API: Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:42:21.249 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:42:21.254 +02:00 [INF] Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:42:21.415 +02:00 [INF] GRN updated successfully: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:42:21.455 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:42:21.459 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP) in 813.3896ms
2025-11-16 21:42:21.460 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 21:42:21.461 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:42:21.463 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - 200 null application/json; charset=utf-8 850.4002ms
2025-11-16 21:44:47.994 +02:00 [INF] Starting web host...
2025-11-16 21:44:49.457 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:44:49.509 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 21:44:49.595 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:44:49.600 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 21:44:49.615 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 21:44:49.669 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 21:44:49.685 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 21:44:49.691 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 21:44:49.698 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 21:44:49.711 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 21:44:49.717 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 21:44:49.878 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 21:44:49.885 +02:00 [INF] Master database initialized successfully
2025-11-16 21:44:51.874 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 21:44:51.980 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 21:44:51.982 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 21:44:52.067 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 21:44:52.069 +02:00 [INF] Hosting environment: Development
2025-11-16 21:44:52.070 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 21:44:52.376 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 21:44:52.507 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 131.2504ms
2025-11-16 21:44:52.653 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 21:44:52.653 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 21:44:52.659 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.1922ms
2025-11-16 21:44:52.679 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.7995ms
2025-11-16 21:44:52.736 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 21:44:52.971 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 234.7144ms
2025-11-16 21:45:03.064 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - application/json 476
2025-11-16 21:45:03.081 +02:00 [INF] Request started
2025-11-16 21:45:03.084 +02:00 [INF] === Incoming Request ===
2025-11-16 21:45:03.088 +02:00 [INF] Path: /api/GoodsReceipts/%7B5aead617-f576-411f-526a-08de2544a21d%7D
2025-11-16 21:45:03.090 +02:00 [INF] Method: PUT
2025-11-16 21:45:03.091 +02:00 [INF] === Headers ===
2025-11-16 21:45:03.094 +02:00 [INF] Accept: ["*/*"]
2025-11-16 21:45:03.096 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 21:45:03.098 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 21:45:03.099 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 21:45:03.102 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 21:45:03.103 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 21:45:03.105 +02:00 [INF] Content-Length: ["476"]
2025-11-16 21:45:03.107 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 21:45:03.108 +02:00 [INF] Postman-Token: ["a2f4d9bb-6234-4061-b016-c727c98f126e"]
2025-11-16 21:45:03.113 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 21:45:03.114 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 21:45:03.116 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 21:45:03.132 +02:00 [INF] Route matched with {action = "UpdateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.UpdateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 21:45:03.139 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:45:03.173 +02:00 [INF] API: Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:45:03.236 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 21:45:03.805 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 21:45:03.811 +02:00 [INF] Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 21:45:03.860 +02:00 [INF] Existing GRN found: GRN-2025-00003 | PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 21:45:03.880 +02:00 [INF] Line item updated | GRNLineItemId: "f77b57ed-3f57-41d6-06b0-08de2544a223" | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Old: 1.000 | New: 1 | Delta: 0.000
2025-11-16 21:45:04.037 +02:00 [INF] ‚úÖ GRN updated successfully: GRN-2025-00003
2025-11-16 21:45:04.118 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 21:45:04.140 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP) in 1000.3735ms
2025-11-16 21:45:04.143 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 21:45:04.145 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 21:45:04.151 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - 200 null application/json; charset=utf-8 1087.0439ms
2025-11-16 22:28:07.534 +02:00 [INF] Starting web host...
2025-11-16 22:28:09.118 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:28:09.161 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:28:09.230 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:28:09.236 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:28:09.241 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:28:09.304 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:28:09.320 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:28:09.325 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:28:09.332 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:28:09.345 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:28:09.349 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:28:09.505 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:28:09.512 +02:00 [INF] Master database initialized successfully
2025-11-16 22:28:11.521 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:28:11.635 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:28:11.637 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:28:11.724 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:28:11.726 +02:00 [INF] Hosting environment: Development
2025-11-16 22:28:11.727 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:28:12.004 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:28:12.137 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 134.3137ms
2025-11-16 22:28:12.141 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:28:12.141 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:28:12.153 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.5267ms
2025-11-16 22:28:12.171 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.4971ms
2025-11-16 22:28:12.334 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:28:12.614 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 280.3679ms
2025-11-16 22:28:18.742 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - application/json 476
2025-11-16 22:28:18.764 +02:00 [INF] Request started
2025-11-16 22:28:18.768 +02:00 [INF] === Incoming Request ===
2025-11-16 22:28:18.770 +02:00 [INF] Path: /api/GoodsReceipts/%7B5aead617-f576-411f-526a-08de2544a21d%7D
2025-11-16 22:28:18.771 +02:00 [INF] Method: PUT
2025-11-16 22:28:18.772 +02:00 [INF] === Headers ===
2025-11-16 22:28:18.775 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:28:18.779 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:28:18.787 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:28:18.789 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:28:18.791 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:28:18.793 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:28:18.797 +02:00 [INF] Content-Length: ["476"]
2025-11-16 22:28:18.800 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:28:18.802 +02:00 [INF] Postman-Token: ["7f93e8fc-4de8-4f62-af30-0109e4593e3e"]
2025-11-16 22:28:18.807 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:28:18.808 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:28:18.810 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 22:28:18.832 +02:00 [INF] Route matched with {action = "UpdateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.UpdateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 22:28:18.840 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:28:18.881 +02:00 [INF] API: Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:28:18.943 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:28:19.589 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:28:19.598 +02:00 [INF] Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:28:19.659 +02:00 [INF] Existing GRN found: GRN-2025-00003 | PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 22:28:19.690 +02:00 [INF] Line item updated | GRNLineItemId: "f77b57ed-3f57-41d6-06b0-08de2544a223" | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Old: 1.000 | New: 1 | Delta: 0.000
2025-11-16 22:28:19.784 +02:00 [INF] PO Reception Status unchanged | PO: PO-202510-0005 | Status: Fully Received
2025-11-16 22:28:19.917 +02:00 [INF] ‚úÖ GRN updated successfully: GRN-2025-00003
2025-11-16 22:28:20.004 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 22:28:20.026 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP) in 1186.9991ms
2025-11-16 22:28:20.030 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 22:28:20.033 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:28:20.041 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - 200 null application/json; charset=utf-8 1298.8504ms
2025-11-16 22:28:46.381 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - application/json 476
2025-11-16 22:28:46.394 +02:00 [INF] Request started
2025-11-16 22:28:46.396 +02:00 [INF] === Incoming Request ===
2025-11-16 22:28:46.398 +02:00 [INF] Path: /api/GoodsReceipts/%7B5aead617-f576-411f-526a-08de2544a21d%7D
2025-11-16 22:28:46.399 +02:00 [INF] Method: PUT
2025-11-16 22:28:46.401 +02:00 [INF] === Headers ===
2025-11-16 22:28:46.402 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:28:46.403 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:28:46.405 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:28:46.407 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:28:46.410 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:28:46.412 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:28:46.413 +02:00 [INF] Content-Length: ["476"]
2025-11-16 22:28:46.415 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:28:46.416 +02:00 [INF] Postman-Token: ["b1b4aba2-783d-4438-9970-38b50fc8c743"]
2025-11-16 22:28:46.419 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:28:46.420 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:28:46.422 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 22:28:46.425 +02:00 [INF] Route matched with {action = "UpdateGRN", controller = "GoodsReceipts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.UpdateGRNDto, System.Threading.CancellationToken) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController (ModularERP).
2025-11-16 22:28:46.431 +02:00 [INF] API: Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:28:46.436 +02:00 [INF] Updating GRN with ID: "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:28:46.444 +02:00 [INF] Existing GRN found: GRN-2025-00003 | PO: "23d49ad7-c8f3-4545-9bb3-6957cdf43515"
2025-11-16 22:28:46.451 +02:00 [INF] Line item updated | GRNLineItemId: "f77b57ed-3f57-41d6-06b0-08de2544a223" | POLineItemId: "172d5908-2ebf-4fa0-5816-08de25364791" | Old: 1.000 | New: 0 | Delta: -1.000
2025-11-16 22:28:46.492 +02:00 [INF] POLineItem updated | Id: "172d5908-2ebf-4fa0-5816-08de25364791" | Old Received: 5.000 | Change: -1.000 | New Received: 4.000
2025-11-16 22:28:46.603 +02:00 [INF] ‚úÖ PO Reception Status updated | PO: PO-202510-0005 | Previous: Fully Received | New: Partially Received
2025-11-16 22:28:46.611 +02:00 [INF] ‚úÖ GRN updated successfully: GRN-2025-00003
2025-11-16 22:28:46.627 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-16 22:28:46.630 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP) in 200.3677ms
2025-11-16 22:28:46.633 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GoodsReceiptsController.UpdateGRN (ModularERP)'
2025-11-16 22:28:46.635 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:28:46.637 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/GoodsReceipts/{5aead617-f576-411f-526a-08de2544a21d} - 200 null application/json; charset=utf-8 255.6473ms
2025-11-16 22:33:29.702 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post - null 0
2025-11-16 22:33:29.708 +02:00 [INF] Request started
2025-11-16 22:33:29.709 +02:00 [INF] === Incoming Request ===
2025-11-16 22:33:29.710 +02:00 [INF] Path: /api/GRNPosting/post
2025-11-16 22:33:29.713 +02:00 [INF] Method: POST
2025-11-16 22:33:29.714 +02:00 [INF] === Headers ===
2025-11-16 22:33:29.716 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:33:29.717 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:33:29.719 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:33:29.720 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:33:29.723 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:33:29.726 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:33:29.727 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:33:29.729 +02:00 [INF] Postman-Token: ["56084fc1-f0cf-431b-a4e2-62dc3e9ded5e"]
2025-11-16 22:33:29.731 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:33:29.734 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:33:29.735 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:33:29.740 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:33:29.745 +02:00 [INF] Posting GRN "00000000-0000-0000-0000-000000000000" to inventory
2025-11-16 22:33:29.747 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 3.8005ms
2025-11-16 22:33:29.750 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:33:29.753 +02:00 [ERR] Unexpected error occurred
System.ArgumentNullException: Value cannot be null. (Parameter 'input')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Guid.Parse(String input)
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN(Guid id) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:33:29.801 +02:00 [INF] Error response sent with status code 500
2025-11-16 22:33:29.804 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post - 500 null application/json; charset=utf-8 101.6148ms
2025-11-16 22:36:12.494 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post?Id=5aead617-f576-411f-526a-08de2544a21d - null 0
2025-11-16 22:36:12.499 +02:00 [INF] Request started
2025-11-16 22:36:12.500 +02:00 [INF] === Incoming Request ===
2025-11-16 22:36:12.501 +02:00 [INF] Path: /api/GRNPosting/post
2025-11-16 22:36:12.502 +02:00 [INF] Method: POST
2025-11-16 22:36:12.503 +02:00 [INF] === Headers ===
2025-11-16 22:36:12.503 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:36:12.505 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:36:12.507 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:36:12.510 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:36:12.512 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:36:12.514 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:36:12.516 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:36:12.517 +02:00 [INF] Postman-Token: ["91851c6a-71af-46e6-9bf6-c07b87c0150a"]
2025-11-16 22:36:12.520 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:36:12.521 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:36:12.523 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:36:12.525 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:36:12.531 +02:00 [INF] Posting GRN "00000000-0000-0000-0000-000000000000" to inventory
2025-11-16 22:36:12.533 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 5.7792ms
2025-11-16 22:36:12.535 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:36:12.537 +02:00 [ERR] Unexpected error occurred
System.ArgumentNullException: Value cannot be null. (Parameter 'input')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Guid.Parse(String input)
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN(Guid id) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:36:12.550 +02:00 [INF] Error response sent with status code 500
2025-11-16 22:36:12.552 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post?Id=5aead617-f576-411f-526a-08de2544a21d - 500 null application/json; charset=utf-8 57.2327ms
2025-11-16 22:36:46.643 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post?GRNId=5aead617-f576-411f-526a-08de2544a21d - null 0
2025-11-16 22:36:46.647 +02:00 [INF] Request started
2025-11-16 22:36:46.648 +02:00 [INF] === Incoming Request ===
2025-11-16 22:36:46.649 +02:00 [INF] Path: /api/GRNPosting/post
2025-11-16 22:36:46.651 +02:00 [INF] Method: POST
2025-11-16 22:36:46.652 +02:00 [INF] === Headers ===
2025-11-16 22:36:46.653 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:36:46.655 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:36:46.656 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:36:46.657 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:36:46.659 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:36:46.660 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:36:46.662 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:36:46.664 +02:00 [INF] Postman-Token: ["adaf6fae-b791-4e08-9426-5bfea9283cfc"]
2025-11-16 22:36:46.666 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:36:46.668 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:36:46.669 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:36:46.670 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:36:46.672 +02:00 [INF] Posting GRN "00000000-0000-0000-0000-000000000000" to inventory
2025-11-16 22:36:46.673 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 1.5421ms
2025-11-16 22:36:46.675 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:36:46.676 +02:00 [ERR] Unexpected error occurred
System.ArgumentNullException: Value cannot be null. (Parameter 'input')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Guid.Parse(String input)
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN(Guid id) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:36:46.686 +02:00 [INF] Error response sent with status code 500
2025-11-16 22:36:46.687 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post?GRNId=5aead617-f576-411f-526a-08de2544a21d - 500 null application/json; charset=utf-8 44.0901ms
2025-11-16 22:40:26.669 +02:00 [INF] Starting web host...
2025-11-16 22:40:28.359 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:40:28.403 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:40:28.475 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:40:28.480 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:40:28.486 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:40:28.543 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:40:28.559 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:40:28.564 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:40:28.571 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:40:28.581 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:40:28.585 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:40:28.769 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:40:28.775 +02:00 [INF] Master database initialized successfully
2025-11-16 22:40:31.102 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:40:31.214 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:40:31.215 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:40:31.313 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:40:31.314 +02:00 [INF] Hosting environment: Development
2025-11-16 22:40:31.316 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:40:31.612 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:40:31.748 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 136.9694ms
2025-11-16 22:40:31.756 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:40:31.756 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:40:31.765 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.0044ms
2025-11-16 22:40:31.793 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.4665ms
2025-11-16 22:40:31.971 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:40:32.255 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 283.9883ms
2025-11-16 22:40:34.726 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - null 0
2025-11-16 22:40:34.752 +02:00 [INF] Request started
2025-11-16 22:40:34.755 +02:00 [INF] === Incoming Request ===
2025-11-16 22:40:34.758 +02:00 [INF] Path: /api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:40:34.759 +02:00 [INF] Method: POST
2025-11-16 22:40:34.761 +02:00 [INF] === Headers ===
2025-11-16 22:40:34.765 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:40:34.768 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:40:34.769 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:40:34.773 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:40:34.775 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:40:34.777 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:40:34.779 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:40:34.780 +02:00 [INF] Postman-Token: ["d5f632ad-8f1f-4c34-a7c5-06fa5bb6af4c"]
2025-11-16 22:40:34.790 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:40:34.791 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:40:34.794 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:40:34.815 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:40:34.823 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:40:34.840 +02:00 [INF] Posting GRN "5aead617-f576-411f-526a-08de2544a21d" to inventory
2025-11-16 22:40:34.845 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 23.575ms
2025-11-16 22:40:34.848 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:40:34.850 +02:00 [ERR] Unexpected error occurred
System.ArgumentNullException: Value cannot be null. (Parameter 'input')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Guid.Parse(String input)
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN(Guid id) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:40:34.931 +02:00 [INF] Error response sent with status code 500
2025-11-16 22:40:34.934 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - 500 null application/json; charset=utf-8 207.6981ms
2025-11-16 22:42:40.157 +02:00 [INF] Starting web host...
2025-11-16 22:42:41.533 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:42:41.582 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:42:41.665 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:42:41.670 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:42:41.675 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:42:41.731 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:42:41.746 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:42:41.750 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:42:41.761 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:42:41.776 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:42:41.781 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:42:41.985 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:42:41.992 +02:00 [INF] Master database initialized successfully
2025-11-16 22:42:44.066 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:42:44.174 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:42:44.176 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:42:44.275 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:42:44.277 +02:00 [INF] Hosting environment: Development
2025-11-16 22:42:44.278 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:42:44.552 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:42:44.678 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 127.4236ms
2025-11-16 22:42:44.682 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:42:44.682 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:42:44.694 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.1019ms
2025-11-16 22:42:44.716 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.1023ms
2025-11-16 22:42:44.760 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:42:45.013 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 252.7415ms
2025-11-16 22:42:47.630 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - null 0
2025-11-16 22:42:47.660 +02:00 [INF] Request started
2025-11-16 22:42:47.663 +02:00 [INF] === Incoming Request ===
2025-11-16 22:42:47.666 +02:00 [INF] Path: /api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:42:47.667 +02:00 [INF] Method: POST
2025-11-16 22:42:47.668 +02:00 [INF] === Headers ===
2025-11-16 22:42:47.671 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:42:47.674 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:42:47.675 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:42:47.677 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:42:47.679 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:42:47.682 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:42:47.684 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:42:47.686 +02:00 [INF] Postman-Token: ["e6a6a2a2-c247-4f4f-ab27-a47dcfd6063d"]
2025-11-16 22:42:47.690 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:42:47.693 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:42:47.695 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:42:47.719 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:42:47.725 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:42:47.741 +02:00 [INF] Posting GRN "5aead617-f576-411f-526a-08de2544a21d" to inventory
2025-11-16 22:42:47.809 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:42:48.587 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:42:48.598 +02:00 [INF] Posting GRN "5aead617-f576-411f-526a-08de2544a21d" to inventory
2025-11-16 22:42:48.702 +02:00 [INF] GRN "5aead617-f576-411f-526a-08de2544a21d" posted successfully
2025-11-16 22:42:48.888 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 22:42:48.916 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 1191.6529ms
2025-11-16 22:42:48.919 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:42:48.921 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:42:48.927 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1297.8795ms
2025-11-16 22:45:25.781 +02:00 [INF] Starting web host...
2025-11-16 22:45:27.243 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:45:27.283 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:45:27.369 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:45:27.375 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:45:27.380 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:45:27.442 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:45:27.457 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:45:27.462 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:45:27.468 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:45:27.482 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:45:27.487 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:45:27.653 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:45:27.663 +02:00 [INF] Master database initialized successfully
2025-11-16 22:45:30.092 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:45:30.209 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:45:30.212 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:45:30.301 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:45:30.303 +02:00 [INF] Hosting environment: Development
2025-11-16 22:45:30.304 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:45:30.717 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:45:30.851 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 135.0849ms
2025-11-16 22:45:30.890 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:45:30.890 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:45:30.896 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.8346ms
2025-11-16 22:45:30.918 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.0424ms
2025-11-16 22:45:30.945 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:45:31.259 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 314.4279ms
2025-11-16 22:45:36.149 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - null 0
2025-11-16 22:45:36.173 +02:00 [INF] Request started
2025-11-16 22:45:36.176 +02:00 [INF] === Incoming Request ===
2025-11-16 22:45:36.178 +02:00 [INF] Path: /api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:45:36.179 +02:00 [INF] Method: POST
2025-11-16 22:45:36.180 +02:00 [INF] === Headers ===
2025-11-16 22:45:36.183 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:45:36.186 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:45:36.188 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:45:36.190 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:45:36.193 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:45:36.194 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:45:36.196 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:45:36.197 +02:00 [INF] Postman-Token: ["b7067e3f-10eb-4336-a2cc-75069c9f1cf8"]
2025-11-16 22:45:36.203 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:45:36.206 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:45:36.208 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:45:36.235 +02:00 [INF] Route matched with {action = "PostGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PostGRN(System.Guid) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:45:36.242 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:45:36.257 +02:00 [INF] Posting GRN "5aead617-f576-411f-526a-08de2544a21d" to inventory
2025-11-16 22:45:36.325 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:45:37.083 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:45:37.093 +02:00 [INF] Posting GRN "5aead617-f576-411f-526a-08de2544a21d" to inventory
2025-11-16 22:45:37.181 +02:00 [INF] ‚úÖ GRN "5aead617-f576-411f-526a-08de2544a21d" posted successfully
2025-11-16 22:45:37.342 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 22:45:37.376 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP) in 1134.3259ms
2025-11-16 22:45:37.379 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.PostGRN (ModularERP)'
2025-11-16 22:45:37.381 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:45:37.386 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/post/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1237.6149ms
2025-11-16 22:48:05.833 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - null 0
2025-11-16 22:48:05.846 +02:00 [INF] Request started
2025-11-16 22:48:05.848 +02:00 [INF] === Incoming Request ===
2025-11-16 22:48:05.850 +02:00 [INF] Path: /api/GRNPosting/reverse
2025-11-16 22:48:05.851 +02:00 [INF] Method: POST
2025-11-16 22:48:05.853 +02:00 [INF] === Headers ===
2025-11-16 22:48:05.855 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:48:05.857 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:48:05.858 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:48:05.860 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:48:05.861 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:48:05.863 +02:00 [INF] Content-Length: ["0"]
2025-11-16 22:48:05.865 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:48:05.866 +02:00 [INF] Postman-Token: ["d9dd837d-6187-4ef3-ab15-7e27ac749e19"]
2025-11-16 22:48:05.870 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:48:05.873 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:48:05.874 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:48:05.878 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:48:05.888 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-16 22:48:05.900 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 17.6591ms
2025-11-16 22:48:05.905 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:48:05.906 +02:00 [INF] Request completed successfully with status code 415
2025-11-16 22:48:05.908 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - 415 null application/problem+json; charset=utf-8 74.312ms
2025-11-16 22:48:54.004 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - application/json 141
2025-11-16 22:48:54.009 +02:00 [INF] Request started
2025-11-16 22:48:54.011 +02:00 [INF] === Incoming Request ===
2025-11-16 22:48:54.011 +02:00 [INF] Path: /api/GRNPosting/reverse
2025-11-16 22:48:54.013 +02:00 [INF] Method: POST
2025-11-16 22:48:54.014 +02:00 [INF] === Headers ===
2025-11-16 22:48:54.015 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:48:54.017 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:48:54.019 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:48:54.020 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:48:54.024 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:48:54.026 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:48:54.028 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:48:54.029 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:48:54.030 +02:00 [INF] Postman-Token: ["ff042503-9e8f-441d-9e08-a9cec1dd5151"]
2025-11-16 22:48:54.032 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:48:54.034 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:48:54.036 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:48:54.038 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:48:54.051 +02:00 [INF] Reversing GRN "00000000-0000-0000-0000-000000000000"
2025-11-16 22:48:54.054 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 10.456ms
2025-11-16 22:48:54.057 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:48:54.060 +02:00 [ERR] Unexpected error occurred
System.ArgumentNullException: Value cannot be null. (Parameter 'input')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Guid.Parse(String input)
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN(Guid id, ReverseGRNCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 58
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:48:54.119 +02:00 [INF] Error response sent with status code 500
2025-11-16 22:48:54.121 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - 500 null application/json; charset=utf-8 116.934ms
2025-11-16 22:49:37.414 +02:00 [INF] Starting web host...
2025-11-16 22:49:38.928 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:49:38.969 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:49:39.046 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:49:39.051 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:49:39.057 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:49:39.118 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:49:39.135 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:49:39.141 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:49:39.148 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:49:39.161 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:49:39.166 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:49:39.331 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:49:39.340 +02:00 [INF] Master database initialized successfully
2025-11-16 22:49:41.328 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:49:41.436 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:49:41.438 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:49:41.528 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:49:41.530 +02:00 [INF] Hosting environment: Development
2025-11-16 22:49:41.531 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:49:41.830 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:49:41.958 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 128.8212ms
2025-11-16 22:49:42.017 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:49:42.017 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:49:42.026 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.8856ms
2025-11-16 22:49:42.050 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.061ms
2025-11-16 22:49:42.079 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:49:42.332 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 253.3477ms
2025-11-16 22:50:10.961 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - application/json 141
2025-11-16 22:50:10.977 +02:00 [INF] Request started
2025-11-16 22:50:10.979 +02:00 [INF] === Incoming Request ===
2025-11-16 22:50:10.982 +02:00 [INF] Path: /api/GRNPosting/reverse
2025-11-16 22:50:10.983 +02:00 [INF] Method: POST
2025-11-16 22:50:10.984 +02:00 [INF] === Headers ===
2025-11-16 22:50:10.986 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:50:10.989 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:50:10.990 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:50:10.993 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:50:10.994 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:50:10.996 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:50:10.999 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:50:11.001 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:50:11.002 +02:00 [INF] Postman-Token: ["c3670fa7-1e85-43c7-a768-77284635663c"]
2025-11-16 22:50:11.006 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:50:11.009 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:50:11.011 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:50:11.030 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:50:11.036 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:50:11.055 +02:00 [INF] Reversing GRN "00000000-0000-0000-0000-000000000000"
2025-11-16 22:50:11.109 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:50:11.611 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:50:11.616 +02:00 [INF] Reversing GRN "00000000-0000-0000-0000-000000000000"
2025-11-16 22:50:11.640 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 604.293ms
2025-11-16 22:50:11.643 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:50:11.647 +02:00 [ERR] Application exception occurred: GRN with ID 00000000-0000-0000-0000-000000000000 not found
ModularERP.Common.Exceptions.NotFoundException: GRN with ID 00000000-0000-0000-0000-000000000000 not found
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.ReverseGRNHandler.Handle(ReverseGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\ReverseGRNHandler.cs:line 42
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN(Guid id, ReverseGRNCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 63
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:50:11.698 +02:00 [INF] Error response sent with status code 404
2025-11-16 22:50:11.704 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse - 404 null application/json; charset=utf-8 743.2022ms
2025-11-16 22:50:38.932 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:50:38.961 +02:00 [INF] Request started
2025-11-16 22:50:38.963 +02:00 [INF] === Incoming Request ===
2025-11-16 22:50:38.965 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:50:38.967 +02:00 [INF] Method: POST
2025-11-16 22:50:38.969 +02:00 [INF] === Headers ===
2025-11-16 22:50:38.974 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:50:38.976 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:50:38.978 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:50:38.980 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:50:38.982 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:50:38.984 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:50:38.988 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:50:38.989 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:50:38.991 +02:00 [INF] Postman-Token: ["5b5bf2ee-d756-4ee4-811f-670af4d390b5"]
2025-11-16 22:50:38.999 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:50:39.000 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:50:39.002 +02:00 [INF] Request completed successfully with status code 404
2025-11-16 22:50:39.006 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 404 0 null 74.4002ms
2025-11-16 22:50:39.012 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d, Response status code: 404
2025-11-16 22:51:03.166 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/a6f6f582-651a-45e1-842e-08de25373214 - application/json 141
2025-11-16 22:51:03.171 +02:00 [INF] Request started
2025-11-16 22:51:03.172 +02:00 [INF] === Incoming Request ===
2025-11-16 22:51:03.172 +02:00 [INF] Path: /api/GRNPosting/reverse/a6f6f582-651a-45e1-842e-08de25373214
2025-11-16 22:51:03.173 +02:00 [INF] Method: POST
2025-11-16 22:51:03.174 +02:00 [INF] === Headers ===
2025-11-16 22:51:03.175 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:51:03.178 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:51:03.180 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:51:03.182 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:51:03.183 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:51:03.186 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:51:03.187 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:51:03.189 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:51:03.190 +02:00 [INF] Postman-Token: ["e6f61466-7225-4002-b082-542d52c28b4f"]
2025-11-16 22:51:03.192 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:51:03.193 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:51:03.197 +02:00 [INF] Request completed successfully with status code 404
2025-11-16 22:51:03.198 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/a6f6f582-651a-45e1-842e-08de25373214 - 404 0 null 32.2608ms
2025-11-16 22:51:03.202 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7168/api/GRNPosting/reverse/a6f6f582-651a-45e1-842e-08de25373214, Response status code: 404
2025-11-16 22:53:17.678 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:53:17.682 +02:00 [INF] Request started
2025-11-16 22:53:17.682 +02:00 [INF] === Incoming Request ===
2025-11-16 22:53:17.684 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:53:17.686 +02:00 [INF] Method: POST
2025-11-16 22:53:17.687 +02:00 [INF] === Headers ===
2025-11-16 22:53:17.690 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:53:17.692 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:53:17.693 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:53:17.694 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:53:17.696 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:53:17.698 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:53:17.701 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:53:17.703 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:53:17.705 +02:00 [INF] Postman-Token: ["da2ec79c-5091-465e-90e1-7dbcee5ab4f5"]
2025-11-16 22:53:17.706 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:53:17.707 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:53:17.709 +02:00 [INF] Request completed successfully with status code 404
2025-11-16 22:53:17.710 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 404 0 null 32.4862ms
2025-11-16 22:53:17.715 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d, Response status code: 404
2025-11-16 22:54:19.906 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:54:19.910 +02:00 [INF] Request started
2025-11-16 22:54:19.911 +02:00 [INF] === Incoming Request ===
2025-11-16 22:54:19.912 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:54:19.914 +02:00 [INF] Method: POST
2025-11-16 22:54:19.917 +02:00 [INF] === Headers ===
2025-11-16 22:54:19.919 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:54:19.920 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:54:19.922 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:54:19.923 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:54:19.924 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:54:19.927 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:54:19.929 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:54:19.931 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:54:19.933 +02:00 [INF] Postman-Token: ["7b7b0ef9-1484-43b3-8196-118bde0b9674"]
2025-11-16 22:54:19.936 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:54:19.937 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:54:19.938 +02:00 [INF] Request completed successfully with status code 404
2025-11-16 22:54:19.939 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 404 0 null 33.4893ms
2025-11-16 22:54:19.943 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d, Response status code: 404
2025-11-16 22:54:21.178 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:54:21.181 +02:00 [INF] Request started
2025-11-16 22:54:21.182 +02:00 [INF] === Incoming Request ===
2025-11-16 22:54:21.184 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:54:21.185 +02:00 [INF] Method: POST
2025-11-16 22:54:21.186 +02:00 [INF] === Headers ===
2025-11-16 22:54:21.189 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:54:21.191 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:54:21.193 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:54:21.194 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:54:21.196 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:54:21.198 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:54:21.200 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:54:21.201 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:54:21.203 +02:00 [INF] Postman-Token: ["b3e44bd9-728a-4506-9bad-33baa825fd10"]
2025-11-16 22:54:21.204 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:54:21.205 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:54:21.206 +02:00 [INF] Request completed successfully with status code 404
2025-11-16 22:54:21.209 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 404 0 null 31.0288ms
2025-11-16 22:54:21.213 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d, Response status code: 404
2025-11-16 22:54:35.012 +02:00 [INF] Starting web host...
2025-11-16 22:54:36.349 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:54:36.389 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:54:36.457 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:54:36.463 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:54:36.467 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:54:36.522 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:54:36.538 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:54:36.544 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:54:36.550 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:54:36.563 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:54:36.567 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:54:36.728 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:54:36.736 +02:00 [INF] Master database initialized successfully
2025-11-16 22:54:38.748 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:54:38.850 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:54:38.853 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:54:38.910 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:54:38.945 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:54:38.947 +02:00 [INF] Hosting environment: Development
2025-11-16 22:54:38.949 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:54:39.041 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 132.2482ms
2025-11-16 22:54:39.081 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:54:39.081 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:54:39.089 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.1287ms
2025-11-16 22:54:39.137 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 56.3738ms
2025-11-16 22:54:39.177 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:54:39.413 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 235.7498ms
2025-11-16 22:54:44.817 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:54:44.835 +02:00 [INF] Request started
2025-11-16 22:54:44.838 +02:00 [INF] === Incoming Request ===
2025-11-16 22:54:44.841 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:54:44.842 +02:00 [INF] Method: POST
2025-11-16 22:54:44.844 +02:00 [INF] === Headers ===
2025-11-16 22:54:44.846 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:54:44.849 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:54:44.851 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:54:44.852 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:54:44.854 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:54:44.857 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:54:44.860 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:54:44.862 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:54:44.863 +02:00 [INF] Postman-Token: ["c1e42eec-e49c-4fbe-9e69-a11a08a67beb"]
2025-11-16 22:54:44.872 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:54:44.873 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:54:44.875 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:54:44.898 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:54:44.906 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:54:44.935 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:54:45.055 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:54:45.716 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:54:45.721 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:54:45.947 +02:00 [INF] GRN "5aead617-f576-411f-526a-08de2544a21d" reversed successfully
2025-11-16 22:54:46.117 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 22:54:46.151 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 1246.3357ms
2025-11-16 22:54:46.154 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:54:46.158 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:54:46.165 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1347.9973ms
2025-11-16 22:58:22.810 +02:00 [INF] Starting web host...
2025-11-16 22:58:24.098 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:24.140 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:58:24.212 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:24.218 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:58:24.223 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:58:24.282 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:58:24.298 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:24.304 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:58:24.310 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:58:24.324 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:58:24.329 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:58:24.491 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:58:24.499 +02:00 [INF] Master database initialized successfully
2025-11-16 22:58:26.417 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:58:26.530 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:58:26.532 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:58:26.619 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:58:26.621 +02:00 [INF] Hosting environment: Development
2025-11-16 22:58:26.623 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:58:26.734 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:58:26.901 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 167.5766ms
2025-11-16 22:58:27.036 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:58:27.036 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:58:27.042 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.9615ms
2025-11-16 22:58:27.060 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.508ms
2025-11-16 22:58:27.113 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:58:27.349 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 236.1015ms
2025-11-16 22:58:39.096 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:58:39.158 +02:00 [INF] Request started
2025-11-16 22:58:39.161 +02:00 [INF] === Incoming Request ===
2025-11-16 22:58:39.164 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:58:39.165 +02:00 [INF] Method: POST
2025-11-16 22:58:39.166 +02:00 [INF] === Headers ===
2025-11-16 22:58:39.169 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:58:39.173 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:58:39.174 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:58:39.177 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:58:39.179 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:58:39.181 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:58:39.183 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:58:39.184 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:58:39.186 +02:00 [INF] Postman-Token: ["82c34c14-436c-44df-a99a-1d94f246d637"]
2025-11-16 22:58:39.191 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:58:39.193 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:58:39.195 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:58:39.218 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:58:39.225 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:58:39.253 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:58:39.315 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:58:40.014 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:58:40.029 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:58:40.398 +02:00 [INF] ‚úÖ GRN "5aead617-f576-411f-526a-08de2544a21d" reversed successfully
2025-11-16 22:58:40.528 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 22:58:40.552 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 1327.8573ms
2025-11-16 22:58:40.556 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:58:40.559 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 22:58:40.564 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1467.7731ms
2025-11-16 22:58:54.849 +02:00 [INF] Starting web host...
2025-11-16 22:58:56.155 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:56.200 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 22:58:56.289 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:56.294 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 22:58:56.298 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 22:58:56.357 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 22:58:56.374 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 22:58:56.380 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 22:58:56.389 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 22:58:56.402 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 22:58:56.408 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 22:58:56.578 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 22:58:56.585 +02:00 [INF] Master database initialized successfully
2025-11-16 22:58:58.475 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 22:58:58.581 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 22:58:58.583 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 22:58:58.676 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 22:58:58.678 +02:00 [INF] Hosting environment: Development
2025-11-16 22:58:58.679 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 22:58:58.922 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 22:58:59.045 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 123.0226ms
2025-11-16 22:58:59.051 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 22:58:59.051 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 22:58:59.060 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.1855ms
2025-11-16 22:58:59.083 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.384ms
2025-11-16 22:58:59.144 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 22:58:59.450 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 306.2893ms
2025-11-16 22:59:02.474 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 22:59:02.492 +02:00 [INF] Request started
2025-11-16 22:59:02.495 +02:00 [INF] === Incoming Request ===
2025-11-16 22:59:02.497 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 22:59:02.498 +02:00 [INF] Method: POST
2025-11-16 22:59:02.499 +02:00 [INF] === Headers ===
2025-11-16 22:59:02.502 +02:00 [INF] Accept: ["*/*"]
2025-11-16 22:59:02.506 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 22:59:02.508 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 22:59:02.509 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 22:59:02.511 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 22:59:02.514 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 22:59:02.515 +02:00 [INF] Content-Length: ["141"]
2025-11-16 22:59:02.517 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 22:59:02.519 +02:00 [INF] Postman-Token: ["53287ab9-8940-4e1d-81a7-7e1baf90bf18"]
2025-11-16 22:59:02.524 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 22:59:02.526 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 22:59:02.527 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:59:02.545 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 22:59:02.551 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:59:02.572 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:59:02.629 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 22:59:03.154 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 22:59:03.159 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 22:59:03.225 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 673.9536ms
2025-11-16 22:59:03.227 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 22:59:03.230 +02:00 [WRN] Business logic exception occurred: Cannot reverse GRN without line items
ModularERP.Common.Exceptions.BusinessLogicException: Cannot reverse GRN without line items
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.ReverseGRNHandler.Handle(ReverseGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\ReverseGRNHandler.cs:line 62
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN(Guid id, ReverseGRNCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 63
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 22:59:03.300 +02:00 [INF] Error response sent with status code 400
2025-11-16 22:59:03.306 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 400 null application/json; charset=utf-8 831.7096ms
2025-11-16 23:01:34.482 +02:00 [INF] Starting web host...
2025-11-16 23:01:35.791 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:01:35.839 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 23:01:35.908 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:01:35.914 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 23:01:35.918 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 23:01:35.971 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 23:01:35.986 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:01:35.991 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 23:01:35.997 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 23:01:36.010 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 23:01:36.014 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 23:01:36.168 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 23:01:36.175 +02:00 [INF] Master database initialized successfully
2025-11-16 23:01:38.353 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 23:01:38.472 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 23:01:38.474 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 23:01:38.569 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 23:01:38.572 +02:00 [INF] Hosting environment: Development
2025-11-16 23:01:38.573 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 23:01:38.933 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 23:01:39.066 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 23:01:39.066 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 23:01:39.066 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 134.5776ms
2025-11-16 23:01:39.085 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 14.0342ms
2025-11-16 23:01:39.098 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.5631ms
2025-11-16 23:01:39.190 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 23:01:39.501 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 310.5453ms
2025-11-16 23:01:42.410 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 23:01:42.452 +02:00 [INF] Request started
2025-11-16 23:01:42.455 +02:00 [INF] === Incoming Request ===
2025-11-16 23:01:42.458 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 23:01:42.459 +02:00 [INF] Method: POST
2025-11-16 23:01:42.460 +02:00 [INF] === Headers ===
2025-11-16 23:01:42.471 +02:00 [INF] Accept: ["*/*"]
2025-11-16 23:01:42.475 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 23:01:42.476 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 23:01:42.478 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 23:01:42.480 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 23:01:42.483 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 23:01:42.486 +02:00 [INF] Content-Length: ["141"]
2025-11-16 23:01:42.489 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 23:01:42.492 +02:00 [INF] Postman-Token: ["af5e88cc-1a33-41f9-b08b-4d6d03e34ce1"]
2025-11-16 23:01:42.499 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 23:01:42.501 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 23:01:42.504 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:01:42.532 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 23:01:42.538 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:01:42.566 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:01:42.650 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 23:01:43.607 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:01:43.622 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:01:43.711 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 1172.4257ms
2025-11-16 23:01:43.717 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:01:43.722 +02:00 [WRN] Business logic exception occurred: Cannot reverse GRN without line items
ModularERP.Common.Exceptions.BusinessLogicException: Cannot reverse GRN without line items
   at ModularERP.Modules.Purchases.Goods_Receipt.Handlers.Handlers_GRN.ReverseGRNHandler.Handle(ReverseGRNCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Handlers\Handlers_GRN\ReverseGRNHandler.cs:line 62
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN(Guid id, ReverseGRNCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Goods_Receipt\Controllers\GRNPostingController.cs:line 63
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-16 23:01:43.800 +02:00 [INF] Error response sent with status code 400
2025-11-16 23:01:43.806 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 400 null application/json; charset=utf-8 1395.8753ms
2025-11-16 23:09:43.264 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 23:09:43.278 +02:00 [INF] Request started
2025-11-16 23:09:43.279 +02:00 [INF] === Incoming Request ===
2025-11-16 23:09:43.280 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 23:09:43.282 +02:00 [INF] Method: POST
2025-11-16 23:09:43.284 +02:00 [INF] === Headers ===
2025-11-16 23:09:43.285 +02:00 [INF] Accept: ["*/*"]
2025-11-16 23:09:43.286 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 23:09:43.288 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 23:09:43.290 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 23:09:43.293 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 23:09:43.295 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 23:09:43.297 +02:00 [INF] Content-Length: ["141"]
2025-11-16 23:09:43.298 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 23:09:43.299 +02:00 [INF] Postman-Token: ["2c474ca9-71c1-4c3a-bad0-2f94496c978a"]
2025-11-16 23:09:43.303 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 23:09:43.304 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 23:09:43.306 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:09:43.308 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 23:09:43.312 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:09:43.317 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:09:43.585 +02:00 [INF] ‚úÖ GRN "5aead617-f576-411f-526a-08de2544a21d" reversed successfully
2025-11-16 23:09:43.707 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 23:09:43.724 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 412.8288ms
2025-11-16 23:09:43.728 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:09:43.729 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 23:09:43.730 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 466.0601ms
2025-11-16 23:14:23.559 +02:00 [INF] Starting web host...
2025-11-16 23:14:24.929 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:14:24.976 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 23:14:25.062 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:14:25.069 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 23:14:25.074 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 23:14:25.137 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 23:14:25.152 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:14:25.156 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 23:14:25.163 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 23:14:25.176 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 23:14:25.181 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 23:14:25.346 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 23:14:25.354 +02:00 [INF] Master database initialized successfully
2025-11-16 23:14:27.305 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 23:14:27.416 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 23:14:27.418 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 23:14:27.482 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 23:14:27.521 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 23:14:27.522 +02:00 [INF] Hosting environment: Development
2025-11-16 23:14:27.524 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 23:14:27.628 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 145.7805ms
2025-11-16 23:14:27.767 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 23:14:27.767 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 23:14:27.774 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.5585ms
2025-11-16 23:14:27.791 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.3117ms
2025-11-16 23:14:27.847 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 23:14:28.160 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 312.9943ms
2025-11-16 23:15:54.967 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 23:15:54.984 +02:00 [INF] Request started
2025-11-16 23:15:54.987 +02:00 [INF] === Incoming Request ===
2025-11-16 23:15:54.989 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 23:15:54.990 +02:00 [INF] Method: POST
2025-11-16 23:15:54.991 +02:00 [INF] === Headers ===
2025-11-16 23:15:54.994 +02:00 [INF] Accept: ["*/*"]
2025-11-16 23:15:54.997 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 23:15:54.999 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 23:15:55.001 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 23:15:55.003 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 23:15:55.005 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 23:15:55.007 +02:00 [INF] Content-Length: ["141"]
2025-11-16 23:15:55.008 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 23:15:55.010 +02:00 [INF] Postman-Token: ["290ee311-e572-46ae-9821-e492e4958cb0"]
2025-11-16 23:15:55.015 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 23:15:55.017 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 23:15:55.020 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:15:55.037 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 23:15:55.043 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:15:55.069 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:15:55.139 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 23:15:55.728 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:15:55.735 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:15:56.102 +02:00 [INF] ‚úÖ GRN "5aead617-f576-411f-526a-08de2544a21d" reversed successfully
2025-11-16 23:15:56.224 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 23:15:56.252 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 1208.2954ms
2025-11-16 23:15:56.255 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:15:56.257 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 23:15:56.263 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1296.1542ms
2025-11-16 23:22:06.637 +02:00 [INF] Starting web host...
2025-11-16 23:22:07.965 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:22:08.005 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-16 23:22:08.075 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:22:08.080 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-16 23:22:08.085 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-16 23:22:08.142 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-16 23:22:08.159 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-16 23:22:08.163 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-16 23:22:08.170 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-16 23:22:08.180 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-16 23:22:08.185 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-16 23:22:08.345 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-16 23:22:08.352 +02:00 [INF] Master database initialized successfully
2025-11-16 23:22:10.383 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-16 23:22:10.513 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-16 23:22:10.515 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-16 23:22:10.611 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-16 23:22:10.613 +02:00 [INF] Hosting environment: Development
2025-11-16 23:22:10.614 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-16 23:22:11.072 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-16 23:22:11.220 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 148.1702ms
2025-11-16 23:22:11.222 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-16 23:22:11.222 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-16 23:22:11.238 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 15.0273ms
2025-11-16 23:22:11.264 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.8184ms
2025-11-16 23:22:11.445 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-16 23:22:11.799 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 354.261ms
2025-11-16 23:22:14.852 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - application/json 141
2025-11-16 23:22:14.873 +02:00 [INF] Request started
2025-11-16 23:22:14.877 +02:00 [INF] === Incoming Request ===
2025-11-16 23:22:14.879 +02:00 [INF] Path: /api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d
2025-11-16 23:22:14.880 +02:00 [INF] Method: POST
2025-11-16 23:22:14.881 +02:00 [INF] === Headers ===
2025-11-16 23:22:14.885 +02:00 [INF] Accept: ["*/*"]
2025-11-16 23:22:14.888 +02:00 [INF] Connection: ["keep-alive"]
2025-11-16 23:22:14.892 +02:00 [INF] Host: ["localhost:7168"]
2025-11-16 23:22:14.895 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.1"]
2025-11-16 23:22:14.897 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-16 23:22:14.899 +02:00 [INF] Content-Type: ["application/json"]
2025-11-16 23:22:14.901 +02:00 [INF] Content-Length: ["141"]
2025-11-16 23:22:14.903 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-16 23:22:14.912 +02:00 [INF] Postman-Token: ["0016261a-d6b4-4f9a-9d50-6e85d5f40371"]
2025-11-16 23:22:14.921 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-16 23:22:14.922 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-16 23:22:14.926 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:22:14.945 +02:00 [INF] Route matched with {action = "ReverseGRN", controller = "GRNPosting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReverseGRN(System.Guid, ModularERP.Modules.Purchases.Goods_Receipt.Commends.Commends_GRN.ReverseGRNCommand) on controller ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController (ModularERP).
2025-11-16 23:22:14.954 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:22:14.981 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:22:15.047 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-16 23:22:15.889 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-16 23:22:15.895 +02:00 [INF] Reversing GRN "5aead617-f576-411f-526a-08de2544a21d"
2025-11-16 23:22:16.167 +02:00 [WRN] Reversal note already exists in GRN "5aead617-f576-411f-526a-08de2544a21d", skipping duplicate
2025-11-16 23:22:16.383 +02:00 [INF] ‚úÖ GRN "5aead617-f576-411f-526a-08de2544a21d" reversed successfully
2025-11-16 23:22:16.552 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType145`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[ModularERP.Modules.Purchases.Goods_Receipt.DTO.DTO_GRN.GRNResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-16 23:22:16.593 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP) in 1638.4742ms
2025-11-16 23:22:16.596 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Goods_Receipt.Controllers.GRNPostingController.ReverseGRN (ModularERP)'
2025-11-16 23:22:16.599 +02:00 [INF] Request completed successfully with status code 200
2025-11-16 23:22:16.608 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/GRNPosting/reverse/5aead617-f576-411f-526a-08de2544a21d - 200 null application/json; charset=utf-8 1755.6149ms
