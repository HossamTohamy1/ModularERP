2025-11-01 16:25:47.241 +02:00 [INF] Starting web host...
2025-11-01 16:25:52.007 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:25:52.066 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 16:25:52.182 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:25:52.187 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 16:25:52.193 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 16:25:52.278 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 16:25:52.293 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:25:52.297 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 16:25:52.311 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 16:25:52.322 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 16:25:52.326 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 16:25:52.591 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 16:25:52.603 +02:00 [INF] Master database initialized successfully
2025-11-01 16:25:54.807 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 16:25:55.050 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 16:25:55.052 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 16:25:55.183 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 16:25:55.185 +02:00 [INF] Hosting environment: Development
2025-11-01 16:25:55.186 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 16:25:55.732 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 16:25:55.965 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 236.6087ms
2025-11-01 16:25:55.969 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 16:25:55.971 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 16:25:55.980 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.4999ms
2025-11-01 16:25:56.031 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 59.9095ms
2025-11-01 16:25:56.154 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 16:25:56.450 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 296.926ms
2025-11-01 16:32:57.815 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 337
2025-11-01 16:32:57.859 +02:00 [INF] Request started
2025-11-01 16:32:57.861 +02:00 [INF] === Incoming Request ===
2025-11-01 16:32:57.863 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:32:57.865 +02:00 [INF] Method: POST
2025-11-01 16:32:57.866 +02:00 [INF] === Headers ===
2025-11-01 16:32:57.869 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:32:57.872 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:32:57.873 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:32:57.875 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:32:57.876 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:32:57.878 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 16:32:57.879 +02:00 [INF] Content-Length: ["337"]
2025-11-01 16:32:57.881 +02:00 [INF] Postman-Token: ["fd74a3df-f0e2-4037-9743-0b3b3825fc5e"]
2025-11-01 16:32:57.885 +02:00 [INF] üîç TenantService returned: 'NULL'
2025-11-01 16:32:57.909 +02:00 [INF] Request completed successfully with status code 400
2025-11-01 16:32:57.912 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 400 null application/json 96.7849ms
2025-11-01 16:34:29.918 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 337
2025-11-01 16:34:29.930 +02:00 [INF] Request started
2025-11-01 16:34:29.932 +02:00 [INF] === Incoming Request ===
2025-11-01 16:34:29.934 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:34:29.935 +02:00 [INF] Method: POST
2025-11-01 16:34:29.937 +02:00 [INF] === Headers ===
2025-11-01 16:34:29.938 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:34:29.940 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:34:29.942 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:34:29.943 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:34:29.945 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:34:29.946 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 16:34:29.948 +02:00 [INF] Content-Length: ["337"]
2025-11-01 16:34:29.949 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 16:34:29.952 +02:00 [INF] Postman-Token: ["64c2bdaf-a388-41fe-b726-56fce22fb6ad"]
2025-11-01 16:34:29.956 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 16:34:29.958 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 16:34:29.960 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:34:29.987 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-01 16:34:29.993 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 16:34:30.032 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:34:30.145 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 16:34:30.842 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 16:34:30.852 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:34:31.178 +02:00 [INF] Line item "cddd1590-728a-48c0-563d-08de1953c4ec" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:34:31.285 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 16:34:31.321 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 1327.9307ms
2025-11-01 16:34:31.324 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:34:31.325 +02:00 [INF] Request completed successfully with status code 201
2025-11-01 16:34:31.329 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 201 null application/json; charset=utf-8 1410.5059ms
2025-11-01 16:49:32.836 +02:00 [INF] Starting web host...
2025-11-01 16:49:34.122 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:49:34.186 +02:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 16:49:34.256 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:49:34.261 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 16:49:34.279 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 16:49:34.335 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 16:49:34.351 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 16:49:34.355 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 16:49:34.363 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 16:49:34.376 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 16:49:34.384 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 16:49:34.548 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 16:49:34.556 +02:00 [INF] Master database initialized successfully
2025-11-01 16:49:36.616 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 16:49:36.723 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 16:49:36.725 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 16:49:36.811 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 16:49:36.813 +02:00 [INF] Hosting environment: Development
2025-11-01 16:49:36.815 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 16:49:37.266 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 16:49:37.380 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 115.504ms
2025-11-01 16:49:37.391 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 16:49:37.391 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 16:49:37.398 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.4542ms
2025-11-01 16:49:37.421 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.6229ms
2025-11-01 16:49:37.605 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 16:49:37.877 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 272.0842ms
2025-11-01 16:50:48.879 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 306
2025-11-01 16:50:48.895 +02:00 [INF] Request started
2025-11-01 16:50:48.897 +02:00 [INF] === Incoming Request ===
2025-11-01 16:50:48.899 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:50:48.900 +02:00 [INF] Method: POST
2025-11-01 16:50:48.900 +02:00 [INF] === Headers ===
2025-11-01 16:50:48.903 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:50:48.905 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:50:48.906 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:50:48.908 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:50:48.910 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:50:48.912 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 16:50:48.913 +02:00 [INF] Content-Length: ["306"]
2025-11-01 16:50:48.914 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 16:50:48.916 +02:00 [INF] Postman-Token: ["ce7d22f7-e588-416d-9729-1713502dce13"]
2025-11-01 16:50:48.920 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 16:50:48.921 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 16:50:48.923 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:50:48.937 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-01 16:50:48.943 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 16:50:48.969 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:50:49.034 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 16:50:49.568 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 16:50:49.571 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:50:50.060 +02:00 [INF] Line item "4f3b9adf-c0c8-4be1-b6b6-08de19560c5f" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5". Subtotal: 75000, Discount: 7500.0, Tax: 15.0000, Total: 67515.0000
2025-11-01 16:50:50.111 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 16:50:50.143 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 1199.2281ms
2025-11-01 16:50:50.145 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:50:50.147 +02:00 [INF] Request completed successfully with status code 201
2025-11-01 16:50:50.152 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 201 null application/json; charset=utf-8 1272.3618ms
2025-11-01 16:57:51.024 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 306
2025-11-01 16:57:51.035 +02:00 [INF] Request started
2025-11-01 16:57:51.037 +02:00 [INF] === Incoming Request ===
2025-11-01 16:57:51.038 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:57:51.039 +02:00 [INF] Method: POST
2025-11-01 16:57:51.040 +02:00 [INF] === Headers ===
2025-11-01 16:57:51.040 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:57:51.042 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:57:51.043 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:57:51.044 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:57:51.046 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:57:51.047 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 16:57:51.048 +02:00 [INF] Content-Length: ["306"]
2025-11-01 16:57:51.049 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 16:57:51.052 +02:00 [INF] Postman-Token: ["207b0104-c269-4632-98f3-9fcf8915f198"]
2025-11-01 16:57:51.055 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 16:57:51.057 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 16:57:51.058 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:57:51.059 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-01 16:57:51.063 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:57:51.066 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:57:51.109 +02:00 [INF] Line item "4e620d67-67bf-401d-b6b7-08de19560c5f" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5". Subtotal: 75000, Discount: 7500.0, Tax: 10125.0000, Total: 77625.0000
2025-11-01 16:57:51.119 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 16:57:51.123 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 61.6922ms
2025-11-01 16:57:51.125 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:57:51.126 +02:00 [INF] Request completed successfully with status code 201
2025-11-01 16:57:51.127 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 201 null application/json; charset=utf-8 103.4221ms
2025-11-01 16:59:46.081 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - application/json 306
2025-11-01 16:59:46.087 +02:00 [INF] Request started
2025-11-01 16:59:46.087 +02:00 [INF] === Incoming Request ===
2025-11-01 16:59:46.088 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:59:46.089 +02:00 [INF] Method: POST
2025-11-01 16:59:46.090 +02:00 [INF] === Headers ===
2025-11-01 16:59:46.091 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:59:46.092 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:59:46.094 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:59:46.095 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:59:46.097 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:59:46.099 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 16:59:46.100 +02:00 [INF] Content-Length: ["306"]
2025-11-01 16:59:46.102 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 16:59:46.103 +02:00 [INF] Postman-Token: ["e6287271-ed94-4148-9035-5ad914319cf6"]
2025-11-01 16:59:46.105 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 16:59:46.106 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 16:59:46.107 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:59:46.108 +02:00 [INF] Route matched with {action = "CreateLineItem", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLineItem(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.CreatePOLineItemDto) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-01 16:59:46.110 +02:00 [INF] POST request received to create line item for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:59:46.114 +02:00 [INF] Creating line item for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:59:46.142 +02:00 [INF] Line item "e61bce09-3b17-4067-b6b8-08de19560c5f" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5". Subtotal: 75000, Discount: 7500.0, Tax: 10125.0000, Total: 77625.0000
2025-11-01 16:59:46.150 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 16:59:46.153 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP) in 42.7038ms
2025-11-01 16:59:46.154 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.CreateLineItem (ModularERP)'
2025-11-01 16:59:46.155 +02:00 [INF] Request completed successfully with status code 201
2025-11-01 16:59:46.157 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 201 null application/json; charset=utf-8 76.1059ms
2025-11-01 16:59:58.697 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - null null
2025-11-01 16:59:58.700 +02:00 [INF] Request started
2025-11-01 16:59:58.701 +02:00 [INF] === Incoming Request ===
2025-11-01 16:59:58.702 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/items
2025-11-01 16:59:58.703 +02:00 [INF] Method: GET
2025-11-01 16:59:58.703 +02:00 [INF] === Headers ===
2025-11-01 16:59:58.704 +02:00 [INF] Accept: ["*/*"]
2025-11-01 16:59:58.705 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 16:59:58.707 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 16:59:58.709 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 16:59:58.711 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 16:59:58.712 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 16:59:58.713 +02:00 [INF] Postman-Token: ["7ab4d637-8fe2-423b-b5ac-eaa09463d453"]
2025-11-01 16:59:58.715 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 16:59:58.716 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 16:59:58.717 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.GetLineItems (ModularERP)'
2025-11-01 16:59:58.721 +02:00 [INF] Route matched with {action = "GetLineItems", controller = "POLineItem"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLineItems(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController (ModularERP).
2025-11-01 16:59:58.725 +02:00 [INF] GET request received for line items of PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:59:58.736 +02:00 [INF] Retrieving all line items for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 16:59:58.757 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POItme.POLineItemListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-01 16:59:58.764 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.GetLineItems (ModularERP) in 39.9536ms
2025-11-01 16:59:58.766 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POLineItemController.GetLineItems (ModularERP)'
2025-11-01 16:59:58.768 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 16:59:58.769 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/items - 200 null application/json; charset=utf-8 71.918ms
2025-11-01 17:06:53.716 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - application/json 325
2025-11-01 17:06:53.719 +02:00 [INF] Request started
2025-11-01 17:06:53.720 +02:00 [INF] === Incoming Request ===
2025-11-01 17:06:53.721 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits
2025-11-01 17:06:53.722 +02:00 [INF] Method: POST
2025-11-01 17:06:53.724 +02:00 [INF] === Headers ===
2025-11-01 17:06:53.726 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:06:53.727 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:06:53.729 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:06:53.731 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:06:53.732 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:06:53.734 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:06:53.736 +02:00 [INF] Content-Length: ["325"]
2025-11-01 17:06:53.738 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:06:53.740 +02:00 [INF] Postman-Token: ["9d796bb6-e98f-4453-8403-c0ca8703b336"]
2025-11-01 17:06:53.742 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:06:53.744 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:06:53.745 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:06:53.750 +02:00 [INF] Route matched with {action = "CreateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateDeposit(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.CreatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:06:53.834 +02:00 [INF] Creating deposit for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:06:53.889 +02:00 [INF] Deposit "a073a82f-3920-420f-8bb2-7293b2e6e49a" created successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:06:53.894 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_PODeposite.PODepositResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:06:53.898 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP) in 145.2178ms
2025-11-01 17:06:53.901 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:06:53.902 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:06:53.904 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - 200 null application/json; charset=utf-8 188.5755ms
2025-11-01 17:13:44.251 +02:00 [INF] Starting web host...
2025-11-01 17:13:45.693 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:13:45.759 +02:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:13:45.827 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:13:45.832 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:13:45.851 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:13:45.905 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:13:45.920 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:13:45.925 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:13:45.932 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:13:45.943 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:13:45.952 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:13:46.115 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:13:46.123 +02:00 [INF] Master database initialized successfully
2025-11-01 17:13:48.148 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:13:48.265 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:13:48.267 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:13:48.352 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:13:48.354 +02:00 [INF] Hosting environment: Development
2025-11-01 17:13:48.355 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:13:48.671 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:13:48.799 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 128.9227ms
2025-11-01 17:13:48.945 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:13:48.945 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:13:48.951 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.5508ms
2025-11-01 17:13:48.975 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.0912ms
2025-11-01 17:13:49.033 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:13:49.282 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 249.1844ms
2025-11-01 17:13:56.065 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - application/json 325
2025-11-01 17:13:56.087 +02:00 [INF] Request started
2025-11-01 17:13:56.090 +02:00 [INF] === Incoming Request ===
2025-11-01 17:13:56.092 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits
2025-11-01 17:13:56.093 +02:00 [INF] Method: POST
2025-11-01 17:13:56.095 +02:00 [INF] === Headers ===
2025-11-01 17:13:56.098 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:13:56.102 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:13:56.104 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:13:56.106 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:13:56.108 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:13:56.110 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:13:56.112 +02:00 [INF] Content-Length: ["325"]
2025-11-01 17:13:56.114 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:13:56.116 +02:00 [INF] Postman-Token: ["389396fd-647c-4785-a310-86cab538083c"]
2025-11-01 17:13:56.122 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:13:56.124 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:13:56.126 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:13:56.148 +02:00 [INF] Route matched with {action = "CreateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateDeposit(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.CreatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:13:56.154 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:13:56.302 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:13:56.976 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:13:57.341 +02:00 [INF] Deposit "fea99c1e-33aa-4876-8053-4b8fcc430a16" created: Amount=30000, Percentage=38.647342995169082125603864730%, PO Total=77625.0000, New Payment Status=Partially Paid
2025-11-01 17:13:57.354 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_PODeposite.PODepositResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:13:57.374 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP) in 1219.4879ms
2025-11-01 17:13:57.377 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:13:57.380 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:13:57.386 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - 200 null application/json; charset=utf-8 1321.2396ms
2025-11-01 17:33:20.978 +02:00 [INF] Starting web host...
2025-11-01 17:33:22.236 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:33:22.304 +02:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:33:22.404 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:33:22.410 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:33:22.425 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:33:22.485 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:33:22.501 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:33:22.506 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:33:22.515 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:33:22.527 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:33:22.535 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:33:22.696 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:33:22.704 +02:00 [INF] Master database initialized successfully
2025-11-01 17:33:24.926 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:33:25.052 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:33:25.053 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:33:25.142 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:33:25.143 +02:00 [INF] Hosting environment: Development
2025-11-01 17:33:25.144 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:33:25.432 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:33:25.566 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 135.2625ms
2025-11-01 17:33:25.712 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:33:25.712 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:33:25.719 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.2353ms
2025-11-01 17:33:25.749 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.6786ms
2025-11-01 17:33:25.800 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:33:26.057 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 257.1046ms
2025-11-01 17:33:29.322 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - application/json 325
2025-11-01 17:33:29.342 +02:00 [INF] Request started
2025-11-01 17:33:29.344 +02:00 [INF] === Incoming Request ===
2025-11-01 17:33:29.347 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits
2025-11-01 17:33:29.348 +02:00 [INF] Method: POST
2025-11-01 17:33:29.349 +02:00 [INF] === Headers ===
2025-11-01 17:33:29.353 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:33:29.356 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:33:29.358 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:33:29.361 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:33:29.363 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:33:29.365 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:33:29.367 +02:00 [INF] Content-Length: ["325"]
2025-11-01 17:33:29.369 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:33:29.373 +02:00 [INF] Postman-Token: ["782f1856-baa3-4616-9fe9-297dd2934cf7"]
2025-11-01 17:33:29.381 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:33:29.383 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:33:29.385 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:33:29.404 +02:00 [INF] Route matched with {action = "CreateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateDeposit(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.CreatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:33:29.410 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:33:29.574 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:33:30.179 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:33:30.299 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP) in 889.1734ms
2025-11-01 17:33:30.303 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:33:30.306 +02:00 [WRN] Business logic exception occurred: Total deposits (90,100.00) cannot exceed PO total (77,625.00). Existing deposits: 60,100.00
ModularERP.Common.Exceptions.BusinessLogicException: Total deposits (90,100.00) cannot exceed PO total (77,625.00). Existing deposits: 60,100.00
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_PODeposite.CreatePODepositCommandHandler.Handle(CreatePODepositCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_PODeposite\CreatePODepositCommandHandler.cs:line 113
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit(Guid purchaseOrderId, CreatePODepositCommand command) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\PODepositsController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-01 17:33:30.389 +02:00 [INF] Error response sent with status code 400
2025-11-01 17:33:30.398 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - 400 null application/json; charset=utf-8 1076.2892ms
2025-11-01 17:34:45.653 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - application/json 325
2025-11-01 17:34:45.669 +02:00 [INF] Request started
2025-11-01 17:34:45.670 +02:00 [INF] === Incoming Request ===
2025-11-01 17:34:45.672 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits
2025-11-01 17:34:45.673 +02:00 [INF] Method: POST
2025-11-01 17:34:45.674 +02:00 [INF] === Headers ===
2025-11-01 17:34:45.677 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:34:45.679 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:34:45.682 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:34:45.684 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:34:45.687 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:34:45.689 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:34:45.691 +02:00 [INF] Content-Length: ["325"]
2025-11-01 17:34:45.692 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:34:45.695 +02:00 [INF] Postman-Token: ["10ec3ec3-fe79-4d8f-bb05-00e5227602fc"]
2025-11-01 17:34:45.699 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:34:45.700 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:34:45.702 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:34:45.706 +02:00 [INF] Route matched with {action = "CreateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateDeposit(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.CreatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:34:45.951 +02:00 [INF] Deposit "13976f0c-04b4-470c-9295-9ea784abfa65" created: Amount=30000, Percentage=38.647342995169082125603864730%, PO Total=77625.0000, New Payment Status=Partially Paid
2025-11-01 17:34:45.962 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_PODeposite.PODepositResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:34:45.974 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP) in 265.0133ms
2025-11-01 17:34:45.977 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:34:45.980 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:34:45.982 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - 200 null application/json; charset=utf-8 328.9891ms
2025-11-01 17:35:58.249 +02:00 [INF] Starting web host...
2025-11-01 17:35:59.531 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:35:59.583 +02:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:35:59.666 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:35:59.672 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:35:59.687 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:35:59.747 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:35:59.764 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:35:59.768 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:35:59.777 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:35:59.789 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:35:59.796 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:35:59.980 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:35:59.987 +02:00 [INF] Master database initialized successfully
2025-11-01 17:36:02.079 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:36:02.185 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:36:02.187 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:36:02.273 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:36:02.275 +02:00 [INF] Hosting environment: Development
2025-11-01 17:36:02.276 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:36:02.682 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:36:02.800 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 118.7501ms
2025-11-01 17:36:02.808 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:36:02.808 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:36:02.816 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.5537ms
2025-11-01 17:36:02.837 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.7788ms
2025-11-01 17:36:02.997 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:36:03.234 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 237.1026ms
2025-11-01 17:36:05.547 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - application/json 325
2025-11-01 17:36:05.563 +02:00 [INF] Request started
2025-11-01 17:36:05.566 +02:00 [INF] === Incoming Request ===
2025-11-01 17:36:05.567 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits
2025-11-01 17:36:05.568 +02:00 [INF] Method: POST
2025-11-01 17:36:05.569 +02:00 [INF] === Headers ===
2025-11-01 17:36:05.572 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:36:05.575 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:36:05.577 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:36:05.579 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:36:05.580 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:36:05.581 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:36:05.583 +02:00 [INF] Content-Length: ["325"]
2025-11-01 17:36:05.584 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:36:05.586 +02:00 [INF] Postman-Token: ["82968145-96f5-44b3-8279-fdc549004e78"]
2025-11-01 17:36:05.590 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:36:05.592 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:36:05.594 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:36:05.610 +02:00 [INF] Route matched with {action = "CreateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateDeposit(System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.CreatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:36:05.616 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:36:05.755 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:36:06.419 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:36:06.772 +02:00 [INF] Deposit "8af1bd02-9114-46f4-9441-6cf38424d7f1" created: Amount=30000, Percentage=38.65%, PO Total=77625.0000, New Payment Status=Partially Paid
2025-11-01 17:36:06.784 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_PODeposite.PODepositResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:36:06.805 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP) in 1188.5683ms
2025-11-01 17:36:06.809 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.CreateDeposit (ModularERP)'
2025-11-01 17:36:06.811 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:36:06.817 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits - 200 null application/json; charset=utf-8 1270.0518ms
2025-11-01 17:38:26.003 +02:00 [INF] Starting web host...
2025-11-01 17:38:27.908 +02:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:38:28.015 +02:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:38:28.105 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:38:28.113 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:38:28.129 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:38:28.188 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:38:28.206 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:38:28.211 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:38:28.220 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:38:28.236 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:38:28.244 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:38:28.438 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:38:28.446 +02:00 [INF] Master database initialized successfully
2025-11-01 17:38:30.601 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:38:30.721 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:38:30.724 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:38:30.817 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:38:30.819 +02:00 [INF] Hosting environment: Development
2025-11-01 17:38:30.820 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:38:31.046 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:38:31.181 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 136.1984ms
2025-11-01 17:38:31.324 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:38:31.324 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:38:31.330 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 6.2699ms
2025-11-01 17:38:31.350 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.8989ms
2025-11-01 17:38:31.379 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:38:31.627 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 247.4987ms
2025-11-01 17:40:45.562 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits/{8af1bd02-9114-46f4-9441-6cf38424d7f1} - application/json 374
2025-11-01 17:40:45.583 +02:00 [INF] Request started
2025-11-01 17:40:45.586 +02:00 [INF] === Incoming Request ===
2025-11-01 17:40:45.587 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/deposits/%7B8af1bd02-9114-46f4-9441-6cf38424d7f1%7D
2025-11-01 17:40:45.588 +02:00 [INF] Method: PUT
2025-11-01 17:40:45.589 +02:00 [INF] === Headers ===
2025-11-01 17:40:45.591 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:40:45.594 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:40:45.597 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:40:45.598 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:40:45.600 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:40:45.602 +02:00 [INF] Content-Type: ["application/json"]
2025-11-01 17:40:45.603 +02:00 [INF] Content-Length: ["374"]
2025-11-01 17:40:45.605 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:40:45.606 +02:00 [INF] Postman-Token: ["f9db60b4-304b-4fb2-a47c-75a98b66cbdb"]
2025-11-01 17:40:45.611 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:40:45.612 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:40:45.614 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.UpdateDeposit (ModularERP)'
2025-11-01 17:40:45.637 +02:00 [INF] Route matched with {action = "UpdateDeposit", controller = "PODeposits"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateDeposit(System.Guid, System.Guid, ModularERP.Modules.Purchases.Purchase_Order_Management.Commends.Commends_PODeposite.UpdatePODepositCommand) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController (ModularERP).
2025-11-01 17:40:45.644 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:40:45.778 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:40:46.475 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:40:46.489 +02:00 [INF] Updating deposit "8af1bd02-9114-46f4-9441-6cf38424d7f1" for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:40:46.788 +02:00 [INF] Deposit "8af1bd02-9114-46f4-9441-6cf38424d7f1" updated: Old Amount=30000.0000, New Amount=25000, Old AlreadyPaid=true, New AlreadyPaid=true, PO Total=77625.0000, New Payment Status=Partially Paid
2025-11-01 17:40:46.801 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_PODeposite.PODepositResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:40:46.818 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.UpdateDeposit (ModularERP) in 1174.514ms
2025-11-01 17:40:46.822 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.PODepositsController.UpdateDeposit (ModularERP)'
2025-11-01 17:40:46.824 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:40:46.828 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/deposits/{8af1bd02-9114-46f4-9441-6cf38424d7f1} - 200 null application/json; charset=utf-8 1266.6126ms
2025-11-01 17:42:47.444 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/attachments - multipart/form-data; boundary=--------------------------365598227042058788548295 2715167
2025-11-01 17:42:47.459 +02:00 [INF] Request started
2025-11-01 17:42:47.460 +02:00 [INF] === Incoming Request ===
2025-11-01 17:42:47.461 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/attachments
2025-11-01 17:42:47.463 +02:00 [INF] Method: POST
2025-11-01 17:42:47.466 +02:00 [INF] === Headers ===
2025-11-01 17:42:47.468 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:42:47.469 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:42:47.471 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:42:47.473 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:42:47.475 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:42:47.476 +02:00 [INF] Content-Type: ["multipart/form-data; boundary=--------------------------365598227042058788548295"]
2025-11-01 17:42:47.478 +02:00 [INF] Content-Length: ["2715167"]
2025-11-01 17:42:47.480 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:42:47.482 +02:00 [INF] Postman-Token: ["938209f5-1baa-4099-b237-d9d337ddff78"]
2025-11-01 17:42:47.485 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:42:47.486 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:42:47.487 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP)'
2025-11-01 17:42:47.494 +02:00 [INF] Route matched with {action = "UploadAttachment", controller = "POAttachments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UploadAttachment(System.Guid, Microsoft.AspNetCore.Http.IFormFile) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController (ModularERP).
2025-11-01 17:42:47.556 +02:00 [INF] Uploading attachment for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:42:47.662 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP) in 163.6835ms
2025-11-01 17:42:47.665 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP)'
2025-11-01 17:42:47.666 +02:00 [ERR] Unexpected error occurred
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_POAttachments_AspNetUsers_UploadedBy". The conflict occurred in database "ModularERP_Tenant_ac68e928aa8044b69ff2ed99d02196e4", table "dbo.AspNetUsers", column 'Id'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:6d97d30d-e64a-42f7-9301-e44ec21c1504
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at ModularERP.Modules.Finance.Finance.Infrastructure.Data.FinanceDbContext.SaveChangesAsync(CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Finance\Finance.Infrastructure\Data\FinanceDbContext.cs:line 2516
   at ModularERP.SharedKernel.Repository.GeneralRepository`1.SaveChanges() in E:\ModelerERP\ModularERP\ModularERP\Shared\Repository\GeneralRepository.cs:line 157
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POAttachment.UploadPOAttachmentCommandHandler.Handle(UploadPOAttachmentCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POAttachment\UploadPOAttachmentCommandHandler.cs:line 129
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment(Guid purchaseOrderId, IFormFile file) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\POAttachmentsController.cs:line 32
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-01 17:42:47.745 +02:00 [INF] Error response sent with status code 500
2025-11-01 17:42:47.748 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/attachments - 500 null application/json; charset=utf-8 303.4428ms
2025-11-01 17:45:47.587 +02:00 [INF] Starting web host...
2025-11-01 17:45:48.890 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:45:48.944 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:45:49.012 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:45:49.018 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:45:49.033 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:45:49.088 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:45:49.105 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:45:49.110 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:45:49.117 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:45:49.130 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:45:49.136 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:45:49.297 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:45:49.305 +02:00 [INF] Master database initialized successfully
2025-11-01 17:45:51.115 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:45:51.219 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:45:51.220 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:45:51.303 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:45:51.304 +02:00 [INF] Hosting environment: Development
2025-11-01 17:45:51.306 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:45:51.556 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:45:51.682 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 127.2344ms
2025-11-01 17:45:51.812 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:45:51.812 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:45:51.821 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.6941ms
2025-11-01 17:45:51.834 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.7549ms
2025-11-01 17:45:51.878 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:45:52.144 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 265.8007ms
2025-11-01 17:45:56.831 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/attachments - multipart/form-data; boundary=--------------------------791330429890758145093923 2715167
2025-11-01 17:45:56.856 +02:00 [INF] Request started
2025-11-01 17:45:56.859 +02:00 [INF] === Incoming Request ===
2025-11-01 17:45:56.863 +02:00 [INF] Path: /api/purchase-orders/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/attachments
2025-11-01 17:45:56.864 +02:00 [INF] Method: POST
2025-11-01 17:45:56.868 +02:00 [INF] === Headers ===
2025-11-01 17:45:56.872 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:45:56.877 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:45:56.879 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:45:56.881 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:45:56.883 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:45:56.884 +02:00 [INF] Content-Type: ["multipart/form-data; boundary=--------------------------791330429890758145093923"]
2025-11-01 17:45:56.888 +02:00 [INF] Content-Length: ["2715167"]
2025-11-01 17:45:56.891 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:45:56.892 +02:00 [INF] Postman-Token: ["e7f6a6f1-4733-4002-a6b1-a1d68825e5cb"]
2025-11-01 17:45:56.897 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:45:56.899 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:45:56.901 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP)'
2025-11-01 17:45:56.918 +02:00 [INF] Route matched with {action = "UploadAttachment", controller = "POAttachments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UploadAttachment(System.Guid, Microsoft.AspNetCore.Http.IFormFile) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController (ModularERP).
2025-11-01 17:45:56.924 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:45:57.060 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:45:57.700 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:45:57.704 +02:00 [INF] Uploading attachment for Purchase Order "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:45:57.889 +02:00 [INF] Attachment "6d4cc1ec-e8cc-428d-8ae4-e9218c7005fa" uploaded successfully for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:45:57.905 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POAttachment.POAttachmentResponseDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:45:57.932 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP) in 1007.6236ms
2025-11-01 17:45:57.935 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POAttachmentsController.UploadAttachment (ModularERP)'
2025-11-01 17:45:57.937 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:45:57.945 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/purchase-orders/{c9419c66-ab1f-4857-a967-37221b235ea5}/attachments - 200 null application/json; charset=utf-8 1114.8545ms
2025-11-01 17:47:55.063 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - null null
2025-11-01 17:47:55.075 +02:00 [INF] Request started
2025-11-01 17:47:55.077 +02:00 [INF] === Incoming Request ===
2025-11-01 17:47:55.079 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/status
2025-11-01 17:47:55.080 +02:00 [INF] Method: GET
2025-11-01 17:47:55.081 +02:00 [INF] === Headers ===
2025-11-01 17:47:55.082 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:47:55.084 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:47:55.086 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:47:55.089 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:47:55.091 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:47:55.093 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:47:55.095 +02:00 [INF] Postman-Token: ["d5e52fff-ec05-4ef9-9b32-4eb4c8f04cea"]
2025-11-01 17:47:55.098 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:47:55.099 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:47:55.100 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:47:55.108 +02:00 [INF] Route matched with {action = "GetStatus", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStatus(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 17:47:55.114 +02:00 [INF] API: Getting status for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:47:55.150 +02:00 [INF] Fetching PO status for ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:47:55.291 +02:00 [INF] Successfully retrieved PO status for PO-202510-0001
2025-11-01 17:47:55.293 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POStatusDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:47:55.303 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP) in 190.2622ms
2025-11-01 17:47:55.306 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:47:55.309 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:47:55.312 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - 200 null application/json; charset=utf-8 248.413ms
2025-11-01 17:53:14.060 +02:00 [INF] Starting web host...
2025-11-01 17:53:15.361 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:53:15.421 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:53:15.494 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:53:15.500 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:53:15.514 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:53:15.571 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:53:15.588 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:53:15.594 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:53:15.602 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:53:15.614 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:53:15.621 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:53:15.788 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:53:15.796 +02:00 [INF] Master database initialized successfully
2025-11-01 17:53:17.756 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:53:17.864 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:53:17.867 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:53:17.954 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:53:17.956 +02:00 [INF] Hosting environment: Development
2025-11-01 17:53:17.959 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:53:18.006 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:53:18.211 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 206.9625ms
2025-11-01 17:53:18.354 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:53:18.354 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:53:18.365 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.7677ms
2025-11-01 17:53:18.378 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.075ms
2025-11-01 17:53:18.413 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:53:18.730 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 316.6883ms
2025-11-01 17:53:27.034 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - null null
2025-11-01 17:53:27.057 +02:00 [INF] Request started
2025-11-01 17:53:27.061 +02:00 [INF] === Incoming Request ===
2025-11-01 17:53:27.063 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/status
2025-11-01 17:53:27.064 +02:00 [INF] Method: GET
2025-11-01 17:53:27.066 +02:00 [INF] === Headers ===
2025-11-01 17:53:27.070 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:53:27.073 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:53:27.074 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:53:27.078 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:53:27.080 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:53:27.082 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:53:27.084 +02:00 [INF] Postman-Token: ["e516a9d5-a31e-44ab-b8c1-3ee9ff553677"]
2025-11-01 17:53:27.089 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:53:27.090 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:53:27.092 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:53:27.115 +02:00 [INF] Route matched with {action = "GetStatus", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStatus(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 17:53:27.121 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:53:27.134 +02:00 [INF] API: Getting status for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:53:27.202 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:53:27.834 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:53:27.845 +02:00 [INF] Fetching PO status for ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:53:28.001 +02:00 [INF] Successfully retrieved PO status for PO-202510-0001: Payment=Unpaid (0%), Reception=Not Received (0%)
2025-11-01 17:53:28.010 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POStatusDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:53:28.034 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP) in 912.9096ms
2025-11-01 17:53:28.037 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:53:28.040 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:53:28.046 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - 200 null application/json; charset=utf-8 1012.1037ms
2025-11-01 17:54:32.615 +02:00 [INF] Starting web host...
2025-11-01 17:54:34.312 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:54:34.354 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 17:54:34.438 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:54:34.443 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 17:54:34.447 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 17:54:34.507 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 17:54:34.523 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 17:54:34.527 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 17:54:34.533 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 17:54:34.546 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 17:54:34.550 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 17:54:34.705 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 17:54:34.713 +02:00 [INF] Master database initialized successfully
2025-11-01 17:54:36.878 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 17:54:36.989 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 17:54:36.991 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 17:54:37.055 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 17:54:37.090 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 17:54:37.092 +02:00 [INF] Hosting environment: Development
2025-11-01 17:54:37.094 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 17:54:37.194 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 139.951ms
2025-11-01 17:54:37.285 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 17:54:37.285 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 17:54:37.295 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 8.7935ms
2025-11-01 17:54:37.310 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.7508ms
2025-11-01 17:54:37.349 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 17:54:37.583 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 234.6772ms
2025-11-01 17:54:40.700 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - null null
2025-11-01 17:54:40.726 +02:00 [INF] Request started
2025-11-01 17:54:40.728 +02:00 [INF] === Incoming Request ===
2025-11-01 17:54:40.731 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/status
2025-11-01 17:54:40.733 +02:00 [INF] Method: GET
2025-11-01 17:54:40.734 +02:00 [INF] === Headers ===
2025-11-01 17:54:40.740 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:54:40.744 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:54:40.747 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:54:40.749 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:54:40.751 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:54:40.753 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:54:40.755 +02:00 [INF] Postman-Token: ["7129b4ce-cd91-4d5b-ad0b-0275eaa7d989"]
2025-11-01 17:54:40.763 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:54:40.766 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:54:40.769 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:54:40.794 +02:00 [INF] Route matched with {action = "GetStatus", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStatus(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 17:54:40.803 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:54:40.825 +02:00 [INF] API: Getting status for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:54:40.917 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 17:54:41.734 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 17:54:41.749 +02:00 [INF] Fetching PO status for ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:54:41.893 +02:00 [INF] Successfully retrieved PO status for PO-202510-0001: Total=77625.0000, Paid=25000.0000 (32.210000%), Due=52625.0000, Payment=Partially Paid, Reception=Not Received
2025-11-01 17:54:41.903 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POStatusDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:54:41.929 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP) in 1127.6276ms
2025-11-01 17:54:41.932 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetStatus (ModularERP)'
2025-11-01 17:54:41.936 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:54:41.941 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/status - 200 null application/json; charset=utf-8 1241.1599ms
2025-11-01 17:58:25.139 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/activity-log - null null
2025-11-01 17:58:25.152 +02:00 [INF] Request started
2025-11-01 17:58:25.154 +02:00 [INF] === Incoming Request ===
2025-11-01 17:58:25.155 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/activity-log
2025-11-01 17:58:25.157 +02:00 [INF] Method: GET
2025-11-01 17:58:25.158 +02:00 [INF] === Headers ===
2025-11-01 17:58:25.159 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:58:25.161 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:58:25.163 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:58:25.165 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:58:25.166 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:58:25.168 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:58:25.169 +02:00 [INF] Postman-Token: ["f56f0e3d-5f58-40a1-8105-a8fd404a4aeb"]
2025-11-01 17:58:25.173 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:58:25.174 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:58:25.175 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetActivityLog (ModularERP)'
2025-11-01 17:58:25.180 +02:00 [INF] Route matched with {action = "GetActivityLog", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetActivityLog(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 17:58:25.186 +02:00 [INF] API: Getting activity log for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:58:25.229 +02:00 [INF] Fetching activity log for PO ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:58:25.263 +02:00 [INF] Retrieved 0 activity log entries
2025-11-01 17:58:25.265 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POActivityLogDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-01 17:58:25.269 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetActivityLog (ModularERP) in 84.548ms
2025-11-01 17:58:25.271 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetActivityLog (ModularERP)'
2025-11-01 17:58:25.272 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:58:25.273 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/activity-log - 200 null application/json; charset=utf-8 134.5028ms
2025-11-01 17:58:57.208 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - null null
2025-11-01 17:58:57.213 +02:00 [INF] Request started
2025-11-01 17:58:57.214 +02:00 [INF] === Incoming Request ===
2025-11-01 17:58:57.215 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/timeline
2025-11-01 17:58:57.216 +02:00 [INF] Method: GET
2025-11-01 17:58:57.219 +02:00 [INF] === Headers ===
2025-11-01 17:58:57.220 +02:00 [INF] Accept: ["*/*"]
2025-11-01 17:58:57.222 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 17:58:57.224 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 17:58:57.225 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 17:58:57.226 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 17:58:57.228 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 17:58:57.230 +02:00 [INF] Postman-Token: ["6c00907d-1d20-48e3-981e-4b700147a0fe"]
2025-11-01 17:58:57.231 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 17:58:57.232 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 17:58:57.233 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 17:58:57.244 +02:00 [INF] Route matched with {action = "GetTimeline", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimeline(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 17:58:57.248 +02:00 [INF] API: Getting timeline for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:58:57.254 +02:00 [INF] Building timeline for PO ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 17:58:57.339 +02:00 [INF] Timeline built with 2 events
2025-11-01 17:58:57.341 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POTimelineDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 17:58:57.345 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP) in 97.5869ms
2025-11-01 17:58:57.347 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 17:58:57.348 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 17:58:57.350 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - 200 null application/json; charset=utf-8 142.5699ms
2025-11-01 18:06:18.148 +02:00 [INF] Starting web host...
2025-11-01 18:06:19.490 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:06:19.542 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 18:06:19.615 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:06:19.621 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 18:06:19.626 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 18:06:19.691 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 18:06:19.710 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:06:19.713 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 18:06:19.721 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 18:06:19.737 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 18:06:19.742 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 18:06:19.937 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 18:06:19.945 +02:00 [INF] Master database initialized successfully
2025-11-01 18:06:22.076 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 18:06:22.183 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 18:06:22.185 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 18:06:22.269 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 18:06:22.271 +02:00 [INF] Hosting environment: Development
2025-11-01 18:06:22.271 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 18:06:22.592 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 18:06:22.722 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 130.0787ms
2025-11-01 18:06:22.859 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 18:06:22.859 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 18:06:22.865 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 5.985ms
2025-11-01 18:06:22.885 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.399ms
2025-11-01 18:06:22.946 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 18:06:23.223 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 276.7636ms
2025-11-01 18:06:32.920 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - null null
2025-11-01 18:06:32.942 +02:00 [INF] Request started
2025-11-01 18:06:32.944 +02:00 [INF] === Incoming Request ===
2025-11-01 18:06:32.946 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/timeline
2025-11-01 18:06:32.947 +02:00 [INF] Method: GET
2025-11-01 18:06:32.949 +02:00 [INF] === Headers ===
2025-11-01 18:06:32.953 +02:00 [INF] Accept: ["*/*"]
2025-11-01 18:06:32.956 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 18:06:32.958 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 18:06:32.959 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 18:06:32.960 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 18:06:32.962 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 18:06:32.964 +02:00 [INF] Postman-Token: ["f366b2f4-dce2-47b4-bdc6-2af4976826bb"]
2025-11-01 18:06:32.970 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 18:06:32.972 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 18:06:32.973 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 18:06:32.993 +02:00 [INF] Route matched with {action = "GetTimeline", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimeline(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 18:06:32.999 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 18:06:33.013 +02:00 [INF] API: Getting timeline for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 18:06:33.078 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 18:06:33.146 +02:00 [INF] Building timeline for PO ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 18:06:33.210 +02:00 [ERR] Error building timeline for PO ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
System.InvalidOperationException: Translation of 'EF.Property<string>(StructuralTypeShaperExpression(
    StructuralType: ModularERP.Modules.Purchases.Purchase_Order_Management.Models.PurchaseOrder
    ValueBufferExpression: ProjectionBindingExpression: Outer
    IsNullable: False), "CreatedBy.FirstName")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitConditional(ConditionalExpression conditionalExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateProjection(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitNew(NewExpression newExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.FirstOrDefaultAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POStatus.GetPOTimelineHandler.Handle(GetPOTimelineQuery request, CancellationToken ct) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POStatus\GetPOTimelineHandler.cs:line 35
2025-11-01 18:06:33.266 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP) in 266.7143ms
2025-11-01 18:06:33.268 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 18:06:33.272 +02:00 [WRN] Business logic exception occurred: Error retrieving purchase order timeline
ModularERP.Common.Exceptions.BusinessLogicException: Error retrieving purchase order timeline
 ---> System.InvalidOperationException: Translation of 'EF.Property<string>(StructuralTypeShaperExpression(
    StructuralType: ModularERP.Modules.Purchases.Purchase_Order_Management.Models.PurchaseOrder
    ValueBufferExpression: ProjectionBindingExpression: Outer
    IsNullable: False), "CreatedBy.FirstName")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitConditional(ConditionalExpression conditionalExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateProjection(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.VisitNew(NewExpression newExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.RelationalProjectionBindingExpressionVisitor.Translate(SelectExpression selectExpression, Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateSelect(ShapedQueryExpression source, LambdaExpression selector)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.FirstOrDefaultAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POStatus.GetPOTimelineHandler.Handle(GetPOTimelineQuery request, CancellationToken ct) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POStatus\GetPOTimelineHandler.cs:line 35
   --- End of inner exception stack trace ---
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Handlers.Handlers_POStatus.GetPOTimelineHandler.Handle(GetPOTimelineQuery request, CancellationToken ct) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Handlers\Handlers_POStatus\GetPOTimelineHandler.cs:line 306
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Common.Behaviors.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Common\Behaviors\ValidationBehavior.cs:line 48
   at ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline(Guid id) in E:\ModelerERP\ModularERP\ModularERP\Modules\Purchases\Purchase_Order_Management\Controllers\POStatusController.cs:line 58
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_7>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 354
--- End of stack trace from previous location ---
   at ModularERP.Program.<>c.<<Main>b__0_6>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 307
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-11-01 18:06:33.319 +02:00 [INF] Error response sent with status code 400
2025-11-01 18:06:33.324 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - 400 null application/json; charset=utf-8 404.371ms
2025-11-01 18:08:22.825 +02:00 [INF] Starting web host...
2025-11-01 18:08:24.068 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:08:24.108 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-11-01 18:08:24.176 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:08:24.181 +02:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-01 18:08:24.186 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-01 18:08:24.239 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-01 18:08:24.255 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-01 18:08:24.259 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-01 18:08:24.266 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-01 18:08:24.276 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-11-01 18:08:24.280 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-01 18:08:24.436 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-01 18:08:24.443 +02:00 [INF] Master database initialized successfully
2025-11-01 18:08:26.260 +02:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-01 18:08:26.365 +02:00 [INF] Now listening on: https://localhost:7168
2025-11-01 18:08:26.367 +02:00 [INF] Now listening on: http://localhost:5004
2025-11-01 18:08:26.451 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-01 18:08:26.453 +02:00 [INF] Hosting environment: Development
2025-11-01 18:08:26.454 +02:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-11-01 18:08:26.729 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 18:08:26.853 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 125.972ms
2025-11-01 18:08:27.124 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 18:08:27.124 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 18:08:27.133 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.1439ms
2025-11-01 18:08:27.175 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 51.0481ms
2025-11-01 18:08:27.763 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 18:08:28.161 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 398.0445ms
2025-11-01 18:08:39.225 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - null null
2025-11-01 18:08:39.247 +02:00 [INF] Request started
2025-11-01 18:08:39.250 +02:00 [INF] === Incoming Request ===
2025-11-01 18:08:39.252 +02:00 [INF] Path: /api/POStatus/%7Bc9419c66-ab1f-4857-a967-37221b235ea5%7D/timeline
2025-11-01 18:08:39.253 +02:00 [INF] Method: GET
2025-11-01 18:08:39.254 +02:00 [INF] === Headers ===
2025-11-01 18:08:39.257 +02:00 [INF] Accept: ["*/*"]
2025-11-01 18:08:39.263 +02:00 [INF] Connection: ["keep-alive"]
2025-11-01 18:08:39.264 +02:00 [INF] Host: ["localhost:7168"]
2025-11-01 18:08:39.266 +02:00 [INF] User-Agent: ["PostmanRuntime/7.49.0"]
2025-11-01 18:08:39.268 +02:00 [INF] Accept-Encoding: ["gzip, deflate, br"]
2025-11-01 18:08:39.270 +02:00 [INF] X-Tenant-ID: ["6f81c000-285c-4e6a-8125-bc36d14ac4ad"]
2025-11-01 18:08:39.271 +02:00 [INF] Postman-Token: ["538923e0-8084-44d8-9c41-0a95084d4995"]
2025-11-01 18:08:39.278 +02:00 [INF] üîç TenantService returned: '6f81c000-285c-4e6a-8125-bc36d14ac4ad'
2025-11-01 18:08:39.280 +02:00 [INF] ‚úÖ Processing request for tenant: 6f81c000-285c-4e6a-8125-bc36d14ac4ad
2025-11-01 18:08:39.282 +02:00 [INF] Executing endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 18:08:39.301 +02:00 [INF] Route matched with {action = "GetTimeline", controller = "POStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimeline(System.Guid) on controller ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController (ModularERP).
2025-11-01 18:08:39.308 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-11-01 18:08:39.323 +02:00 [INF] API: Getting timeline for PO "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 18:08:39.379 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-11-01 18:08:39.444 +02:00 [INF] Building timeline for PO ID: "c9419c66-ab1f-4857-a967-37221b235ea5"
2025-11-01 18:08:39.577 +02:00 [INF] Timeline built successfully for PO #PO-202510-0001 with 4 events
2025-11-01 18:08:39.584 +02:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Purchases.Purchase_Order_Management.DTO.DTO_POStatus.POTimelineDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-01 18:08:39.605 +02:00 [INF] Executed action ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP) in 297.5753ms
2025-11-01 18:08:39.608 +02:00 [INF] Executed endpoint 'ModularERP.Modules.Purchases.Purchase_Order_Management.Controllers.POStatusController.GetTimeline (ModularERP)'
2025-11-01 18:08:39.611 +02:00 [INF] Request completed successfully with status code 200
2025-11-01 18:08:39.616 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/POStatus/{c9419c66-ab1f-4857-a967-37221b235ea5}/timeline - 200 null application/json; charset=utf-8 391.5813ms
2025-11-01 18:14:19.418 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-11-01 18:14:19.426 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 8.2703ms
2025-11-01 18:14:19.438 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-11-01 18:14:19.438 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-11-01 18:14:19.445 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 7.8707ms
2025-11-01 18:14:19.451 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 13.0934ms
2025-11-01 18:14:19.656 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-11-01 18:14:19.945 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 288.3298ms
