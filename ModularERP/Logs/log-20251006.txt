2025-10-06 21:42:33.908 +03:00 [INF] Starting web host...
2025-10-06 21:42:37.593 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 21:42:37.639 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-06 21:42:37.730 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 21:42:37.735 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-06 21:42:37.740 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-06 21:42:37.815 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-06 21:42:37.830 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 21:42:37.836 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-06 21:42:37.844 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-06 21:42:37.855 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-06 21:42:37.859 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-06 21:42:38.052 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-06 21:42:38.059 +03:00 [INF] Master database initialized successfully
2025-10-06 21:42:39.687 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-06 21:42:39.917 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-06 21:42:39.919 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-06 21:42:39.992 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-06 21:42:39.994 +03:00 [INF] Hosting environment: Development
2025-10-06 21:42:39.996 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-06 21:42:40.685 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-06 21:42:41.018 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 338.1159ms
2025-10-06 21:42:41.058 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-06 21:42:41.058 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-06 21:42:41.068 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 10.0397ms
2025-10-06 21:42:41.145 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 87.131ms
2025-10-06 21:42:41.211 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-06 21:42:41.348 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 137.9578ms
2025-10-06 21:46:42.964 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - null null
2025-10-06 21:46:42.991 +03:00 [INF] Request started
2025-10-06 21:46:42.997 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:46:43.001 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:46:43.038 +03:00 [INF] Route matched with {action = "GetAll", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto]]]] GetAll(ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.GetAllUnitTemplatesHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:46:43.148 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-06 21:46:43.538 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-06 21:46:43.582 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-06 21:46:43.609 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP) in 563.9289ms
2025-10-06 21:46:43.613 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:46:43.616 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 21:46:43.621 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - 200 null application/json; charset=utf-8 656.8537ms
2025-10-06 21:47:44.547 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - application/json 231
2025-10-06 21:47:44.552 +03:00 [INF] Request started
2025-10-06 21:47:44.555 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:47:44.556 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:47:44.567 +03:00 [INF] Route matched with {action = "Create", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Create(ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.CreateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.CreateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:47:44.795 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 21:47:44.819 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP) in 248.7227ms
2025-10-06 21:47:44.822 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:47:44.823 +03:00 [INF] Request completed successfully with status code 201
2025-10-06 21:47:44.825 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - 201 null application/json; charset=utf-8 278.5399ms
2025-10-06 21:48:20.644 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - application/json 1035
2025-10-06 21:48:20.649 +03:00 [INF] Request started
2025-10-06 21:48:20.650 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:48:20.652 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:20.654 +03:00 [INF] Route matched with {action = "Create", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Create(ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.CreateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.CreateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:48:20.665 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-06 21:48:20.681 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP) in 23.1495ms
2025-10-06 21:48:20.684 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:20.686 +03:00 [INF] Request completed successfully with status code 400
2025-10-06 21:48:20.687 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - 400 null application/problem+json; charset=utf-8 42.4141ms
2025-10-06 21:48:37.996 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - application/json 231
2025-10-06 21:48:37.999 +03:00 [INF] Request started
2025-10-06 21:48:38.000 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:48:38.001 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:38.003 +03:00 [INF] Route matched with {action = "Create", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Create(ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.CreateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.CreateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:48:38.033 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP) in 26.2681ms
2025-10-06 21:48:38.034 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:38.037 +03:00 [WRN] Business logic exception occurred: Unit template with name 'Premium Arabica Coffee Beans' already exists
ModularERP.Common.Exceptions.BusinessLogicException: Unit template with name 'Premium Arabica Coffee Beans' already exists
   at ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.CreateUnitTemplateHandler.Handle(CreateUnitTemplateCommand request, CancellationToken cancellationToken) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\ProductSettings\Handlers\Handelrs_UnitTemplates\CreateUnitTemplateHandler.cs:line 32
   at ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create(CreateUnitTemplateDto dto, CreateUnitTemplateHandler handler) in E:\ModelerERP\ModularERP\ModularERP\Modules\Inventory\Features\ProductSettings\Controllers\UnitTemplatesController.cs:line 71
   at lambda_method175(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at ModularERP.Program.<>c.<<Main>b__0_4>d.MoveNext() in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 227
--- End of stack trace from previous location ---
   at ModularERP.Common.Middleware.GlobalErrorHandlerMiddleware.InvokeAsync(HttpContext context, RequestDelegate next) in E:\ModelerERP\ModularERP\ModularERP\Common\Middleware\GlobalErrorHandlerMiddleware.cs:line 40
2025-10-06 21:48:38.109 +03:00 [INF] Error response sent with status code 400
2025-10-06 21:48:38.111 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - 400 null application/json; charset=utf-8 115.568ms
2025-10-06 21:48:47.696 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - application/json 232
2025-10-06 21:48:47.700 +03:00 [INF] Request started
2025-10-06 21:48:47.701 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:48:47.702 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:47.703 +03:00 [INF] Route matched with {action = "Create", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Create(ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.CreateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.CreateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:48:47.720 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 21:48:47.724 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP) in 16.34ms
2025-10-06 21:48:47.725 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Create (ModularERP)'
2025-10-06 21:48:47.727 +03:00 [INF] Request completed successfully with status code 201
2025-10-06 21:48:47.729 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates - 201 null application/json; charset=utf-8 32.9324ms
2025-10-06 21:53:21.839 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089}/units - application/json 90
2025-10-06 21:53:21.844 +03:00 [INF] Request started
2025-10-06 21:53:21.853 +03:00 [INF] Request completed successfully with status code 400
2025-10-06 21:53:21.855 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089}/units - 400 null application/json 15.2002ms
2025-10-06 21:53:32.805 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089}/units - application/json 90
2025-10-06 21:53:32.810 +03:00 [INF] Request started
2025-10-06 21:53:32.811 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:53:32.812 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.AddUnitConversion (ModularERP)'
2025-10-06 21:53:32.821 +03:00 [INF] Route matched with {action = "AddUnitConversion", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitConversionDto]]] AddUnitConversion(System.Guid, ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.CreateUnitConversionDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.AddUnitConversionHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:53:32.904 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitConversionDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 21:53:32.910 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.AddUnitConversion (ModularERP) in 84.593ms
2025-10-06 21:53:32.913 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.AddUnitConversion (ModularERP)'
2025-10-06 21:53:32.915 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 21:53:32.916 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089}/units - 200 null application/json; charset=utf-8 110.7332ms
2025-10-06 21:53:42.452 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - null null
2025-10-06 21:53:42.456 +03:00 [INF] Request started
2025-10-06 21:53:42.457 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:53:42.458 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:53:42.460 +03:00 [INF] Route matched with {action = "GetAll", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto]]]] GetAll(ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.GetAllUnitTemplatesHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:53:42.467 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-06 21:53:42.470 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP) in 7.3451ms
2025-10-06 21:53:42.472 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:53:42.474 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 21:53:42.476 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - 200 null application/json; charset=utf-8 23.6302ms
2025-10-06 21:56:24.108 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - null null
2025-10-06 21:56:24.111 +03:00 [INF] Request started
2025-10-06 21:56:24.112 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:56:24.113 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetById (ModularERP)'
2025-10-06 21:56:24.117 +03:00 [INF] Route matched with {action = "GetById", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] GetById(System.Guid, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.GetUnitTemplateByIdHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:56:24.160 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 21:56:24.162 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetById (ModularERP) in 42.9563ms
2025-10-06 21:56:24.164 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetById (ModularERP)'
2025-10-06 21:56:24.166 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 21:56:24.167 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - 200 null application/json; charset=utf-8 58.4181ms
2025-10-06 21:56:36.411 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - null null
2025-10-06 21:56:36.414 +03:00 [INF] Request started
2025-10-06 21:56:36.416 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 21:56:36.417 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:56:36.418 +03:00 [INF] Route matched with {action = "GetAll", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto]]]] GetAll(ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.GetAllUnitTemplatesHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 21:56:36.425 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-06 21:56:36.428 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP) in 6.2872ms
2025-10-06 21:56:36.430 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 21:56:36.432 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 21:56:36.434 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - 200 null application/json; charset=utf-8 23.0979ms
2025-10-06 22:02:49.070 +03:00 [INF] Starting web host...
2025-10-06 22:02:50.054 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:02:50.141 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-06 22:02:50.236 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:02:50.242 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-06 22:02:50.259 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-06 22:02:50.316 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-06 22:02:50.331 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:02:50.336 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-06 22:02:50.344 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-06 22:02:50.354 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-06 22:02:50.363 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-06 22:02:50.541 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-06 22:02:50.549 +03:00 [INF] Master database initialized successfully
2025-10-06 22:02:52.260 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-06 22:02:52.362 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-06 22:02:52.364 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-06 22:02:52.429 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-06 22:02:52.432 +03:00 [INF] Hosting environment: Development
2025-10-06 22:02:52.433 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-06 22:02:52.561 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-06 22:02:52.696 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 135.8264ms
2025-10-06 22:02:52.708 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-06 22:02:52.708 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-06 22:02:52.720 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.5985ms
2025-10-06 22:02:52.739 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.2545ms
2025-10-06 22:02:52.897 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-06 22:02:53.004 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 106.2725ms
2025-10-06 22:02:59.313 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - null null
2025-10-06 22:02:59.365 +03:00 [INF] Request started
2025-10-06 22:02:59.371 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 22:02:59.375 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 22:02:59.424 +03:00 [INF] Route matched with {action = "GetAll", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[System.Collections.Generic.List`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto]]]] GetAll(ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.GetAllUnitTemplatesHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 22:02:59.607 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-06 22:03:00.123 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-06 22:03:00.207 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[System.Collections.Generic.List`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateListDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-06 22:03:00.232 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP) in 801.994ms
2025-10-06 22:03:00.235 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.GetAll (ModularERP)'
2025-10-06 22:03:00.237 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 22:03:00.243 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7168/api/UnitTemplates - 200 null application/json; charset=utf-8 930.6039ms
2025-10-06 22:08:45.160 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - application/json 138
2025-10-06 22:08:45.168 +03:00 [INF] Request started
2025-10-06 22:08:45.171 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 22:08:45.172 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP)'
2025-10-06 22:08:45.180 +03:00 [INF] Route matched with {action = "Update", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Update(System.Guid, ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UpdateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 22:08:45.443 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 22:08:45.455 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP) in 271.3245ms
2025-10-06 22:08:45.457 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP)'
2025-10-06 22:08:45.459 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 22:08:45.460 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - 200 null application/json; charset=utf-8 300.1945ms
2025-10-06 22:15:50.299 +03:00 [INF] Starting web host...
2025-10-06 22:15:50.593 +03:00 [FTL] Host terminated unexpectedly
System.AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.ProductSettings.Commends.Commands_UnitTemplates.UpdateUnitTemplateCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler': Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.) (Error while validating the service descriptor 'ServiceType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler Lifetime: Scoped ImplementationType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler': Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.)
 ---> System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: MediatR.IRequestHandler`2[ModularERP.Modules.Inventory.Features.ProductSettings.Commends.Commands_UnitTemplates.UpdateUnitTemplateCommand,ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]] Lifetime: Transient ImplementationType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler': Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services, ServiceProviderOptions options)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at ModularERP.Program.Main(String[] args) in E:\ModelerERP\ModularERP\ModularERP\Program.cs:line 154
 ---> (Inner Exception #1) System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler Lifetime: Scoped ImplementationType: ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler': Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContext' while attempting to activate 'ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(ICollection`1 serviceDescriptors, ServiceProviderOptions options)<---

2025-10-06 22:16:59.805 +03:00 [INF] Starting web host...
2025-10-06 22:17:00.700 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:17:00.793 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-06 22:17:00.866 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:17:00.872 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-06 22:17:00.887 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-06 22:17:00.950 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-06 22:17:00.965 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:17:00.970 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-06 22:17:00.978 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-06 22:17:00.989 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-06 22:17:00.996 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-06 22:17:01.166 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-06 22:17:01.174 +03:00 [INF] Master database initialized successfully
2025-10-06 22:17:02.541 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-06 22:17:02.655 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-06 22:17:02.657 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-06 22:17:02.740 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-06 22:17:02.742 +03:00 [INF] Hosting environment: Development
2025-10-06 22:17:02.744 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-06 22:17:02.772 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-06 22:17:02.922 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 151.3629ms
2025-10-06 22:17:02.927 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-06 22:17:02.927 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-06 22:17:02.937 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 9.9767ms
2025-10-06 22:17:02.963 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.7168ms
2025-10-06 22:17:03.104 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-06 22:17:03.184 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 80.7419ms
2025-10-06 22:17:13.925 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - application/json 133
2025-10-06 22:17:13.942 +03:00 [INF] Request started
2025-10-06 22:17:13.947 +03:00 [INF] Processing request for tenant: 8bed874f-cf2a-4ffa-a188-4cfef779774a
2025-10-06 22:17:13.949 +03:00 [INF] Executing endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP)'
2025-10-06 22:17:13.973 +03:00 [INF] Route matched with {action = "Update", controller = "UnitTemplates"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[ModularERP.Common.ViewModel.ResponseViewModel`1[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto]]] Update(System.Guid, ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UpdateUnitTemplateDto, ModularERP.Modules.Inventory.Features.ProductSettings.Handlers.Handelrs_UnitTemplates.UpdateUnitTemplateHandler) on controller ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController (ModularERP).
2025-10-06 22:17:14.085 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__companyId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[CreatedAt], [m].[CurrencyCode], [m].[DatabaseName], [m].[Name], [m].[Status]
FROM [MasterCompanies] AS [m]
WHERE [m].[Id] = @__companyId_0 AND [m].[Status] = N'Active'
2025-10-06 22:17:14.327 +03:00 [WRN] You do not have a valid license key for the Lucky Penny software AutoMapper. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-06 22:17:14.645 +03:00 [INF] Executing OkObjectResult, writing value of type 'ModularERP.Common.ViewModel.ResponseViewModel`1[[ModularERP.Modules.Inventory.Features.ProductSettings.DTO.DTO_UnitTemplates.UnitTemplateDto, ModularERP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-06 22:17:14.670 +03:00 [INF] Executed action ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP) in 689.6446ms
2025-10-06 22:17:14.674 +03:00 [INF] Executed endpoint 'ModularERP.Modules.Inventory.Features.ProductSettings.Controllers.UnitTemplatesController.Update (ModularERP)'
2025-10-06 22:17:14.676 +03:00 [INF] Request completed successfully with status code 200
2025-10-06 22:17:14.682 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7168/api/UnitTemplates/{37dd4f44-f5d3-4975-a8d3-ff8bdac7b089} - 200 null application/json; charset=utf-8 756.9177ms
2025-10-06 22:29:39.570 +03:00 [INF] Starting web host...
2025-10-06 22:29:40.559 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:29:40.635 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-06 22:29:40.719 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:29:40.728 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-06 22:29:40.740 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-06 22:29:40.813 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-06 22:29:40.830 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 22:29:40.837 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-06 22:29:40.845 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-06 22:29:40.858 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-06 22:29:40.866 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-06 22:29:41.053 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-06 22:29:41.064 +03:00 [INF] Master database initialized successfully
2025-10-06 22:29:42.467 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-06 22:29:42.573 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-06 22:29:42.576 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-06 22:29:42.651 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-06 22:29:42.654 +03:00 [INF] Hosting environment: Development
2025-10-06 22:29:42.656 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-06 22:29:43.158 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-06 22:29:43.308 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 150.4665ms
2025-10-06 22:29:43.313 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-06 22:29:43.314 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-06 22:29:43.335 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 21.0411ms
2025-10-06 22:29:43.363 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.7587ms
2025-10-06 22:29:43.520 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-06 22:29:43.617 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 96.8042ms
2025-10-06 23:13:20.779 +03:00 [INF] Starting web host...
2025-10-06 23:13:22.502 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 23:13:22.647 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

IF EXISTS
    (SELECT *
     FROM [sys].[objects] o
     WHERE [o].[type] = 'U'
     AND [o].[is_ms_shipped] = 0
     AND NOT EXISTS (SELECT *
         FROM [sys].[extended_properties] AS [ep]
         WHERE [ep].[major_id] = [o].[object_id]
             AND [ep].[minor_id] = 0
             AND [ep].[class] = 1
             AND [ep].[name] = N'microsoft_database_tools_support'
    )
)
SELECT 1 ELSE SELECT 0
2025-10-06 23:13:22.786 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 23:13:22.795 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-06 23:13:22.818 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-06 23:13:23.021 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-06 23:13:23.052 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-06 23:13:23.060 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-06 23:13:23.071 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-06 23:13:23.087 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-06 23:13:23.096 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-06 23:13:23.350 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [MasterCompanies] AS [m]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-06 23:13:23.372 +03:00 [INF] Master database initialized successfully
2025-10-06 23:13:25.928 +03:00 [INF] User profile is available. Using 'C:\Users\hossny D. monkey\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-06 23:13:26.123 +03:00 [INF] Now listening on: https://localhost:7168
2025-10-06 23:13:26.125 +03:00 [INF] Now listening on: http://localhost:5004
2025-10-06 23:13:26.217 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-06 23:13:26.219 +03:00 [INF] Hosting environment: Development
2025-10-06 23:13:26.221 +03:00 [INF] Content root path: E:\ModelerERP\ModularERP\ModularERP
2025-10-06 23:13:26.614 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/index.html - null null
2025-10-06 23:13:26.797 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/index.html - 200 null text/html;charset=utf-8 185.1847ms
2025-10-06 23:13:27.191 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - null null
2025-10-06 23:13:27.191 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/_vs/browserLink - null null
2025-10-06 23:13:27.204 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_framework/aspnetcore-browser-refresh.js - 200 16505 application/javascript; charset=utf-8 12.6752ms
2025-10-06 23:13:27.230 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.1838ms
2025-10-06 23:13:27.354 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - null null
2025-10-06 23:13:27.522 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7168/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 168.2918ms
